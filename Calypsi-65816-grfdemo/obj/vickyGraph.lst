###############################################################################
#                                                                             #
# Calypsi ISO C compiler for 65816                              version 3.6.2 #
#                                                       25/Jul/2022  22:32:26 #
# Command line: --core=65816 --code-model=large --data-model=small            #
#               --target=Foenix -I ./include --speed -O2 --debug              #
#               --list-file=obj/vickyGraph.lst -o obj/vickyGraph.o            #
#               src/vickyGraph.c                                              #
#                                                                             #
###############################################################################

    \ 000000                      .rtmodel version,"1"
    \ 000000                      .rtmodel codeModel,"large"
    \ 000000                      .rtmodel dataModel,"small"
    \ 000000                      .rtmodel core,"65816"
    \ 000000                      .rtmodel huge,"0"
    \ 000000                      .rtmodel doubleSize,"32"
    \ 000000                      .rtmodel target,"foenix"
    \ 000000                      .extern DMA_wait_delay
    \ 000000                      .extern _Dp
    \ 000000                      .extern _FillDP2
    \ 000000                      .extern _FillDP4
    \ 000000                      .extern _Float32Add
    \ 000000                      .extern _Float32Div
    \ 000000                      .extern _Float32EQ
    \ 000000                      .extern _Float32GE
    \ 000000                      .extern _Float32LT
    \ 000000                      .extern _Float32Mul
    \ 000000                      .extern _Float32Sub
    \ 000000                      .extern _Float32ToSInt32
    \ 000000                      .extern _MoveLongNear
    \ 000000                      .extern _Mul32
    \ 000000                      .extern _SInt32ToFloat32
    \ 000000                      .extern _Vfp
    \ 000000                      .extern abs
    \ 000000                      .extern cos
    \ 000000                      .extern printf
    \ 000000                      .extern sin
    \ 000000                      .extern wait_for_DMA_to_finish
0001                  // -------------------------------------------------------------
0002                  // Foenix C256 - Graphics Library VickyGraph.c
0003                  // Compiled by Ernesto Contreras
0004                  // May 2022
0005                  // -------------------------------------------------------------
0006                  
0007                  #include <stdio.h>
0008                  #include <stdlib.h>
0009                  #include <math.h>
0010                  #include <string.h>
0011                  // Foenix Includes
0012                  #include <vicky.h>
0013                  #include <dma.h>
0014                  #include "support.h"
0015                  #include "vickyGraph.h"
0016                  
0017                  
0018                  // Global Variables for Stack
0019                  #define STACK_MAXSIZE 128
0020                  int stack[128][2];
    \ 000000                      .section zdata,bss
    \ 000000                      .public stack
    \ 000000          stack:      .space  512
0021                  int stackTop;
    \ 000000                      .section zdata,bss
    \ 000000                      .public stackTop
    \ 000000          stackTop:   .space  2
0022                  
0023                  // PI value used for arc function
0024                  #define PI 3.141592
0025                  
0026                  // Global Variables that hold screen resolution / current bitmap page / maxVickyMemory 
0027                  long vickyResX;
    \ 000000                      .section zdata,bss
    \ 000000                      .public vickyResX
    \ 000000          vickyResX:  .space  4
0028                  long vickyResY;
    \ 000000                      .section zdata,bss
    \ 000000                      .public vickyResY
    \ 000000          vickyResY:  .space  4
0029                  int  vickyBitmapPage;
    \ 000000                      .section zdata,bss
    \ 000000                      .public vickyBitmapPage
    \ 000000          vickyBitmapPage:
    \ 000000                      .space  2
0030                  long maxVickyMemory;
    \ 000000                      .section zdata,bss
    \ 000000                      .public maxVickyMemory
    \ 000000          maxVickyMemory:
    \ 000000                      .space  4
0031                  bool vBitPlane[2];
    \ 000000                      .section zdata,bss
    \ 000000                      .public vBitPlane
    \ 000000          vBitPlane:  .space  4
0032                  
0033                  // Define default palette
0034                  // Not used right now, need to implement a function to manually load the palette 
0035                  
0036                  
0037                  // A FEW ANSI FUNCTIONS - JUST BASIC SUPPORT!
0038                  
0039                  // --------------------------------------------------
0040                  // ANSI Code Wrapper Functions to make code readable
0041                  // By Ernesto Contreras 
0042                  // --------------------------------------------------
0043                  void ANSILocate (int row, int col)
0044                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public ANSILocate
    \ 000000          ANSILocate:
0045                  	printf("\033[%d;%dH",row,col);
    \ 000000 a6..                 ldx     dp:.tiny _Dp
    \ 000002 da                   phx
    \ 000003 48                   pha
    \ 000004 a9....               lda     ##`_StringLiteral_[27,91,37,100,59,37,100,72]`
    \ 000007 22......             jsl     long:printf
    \ 00000b 68                   pla
    \ 00000c 68                   pla
0046                  }
    \ 00000d 6b                   rtl
0047                  	
0048                  void ANSIClrScr ()
0049                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public ANSIClrScr
    \ 000000          ANSIClrScr:
0050                  	printf ("\033[2J"); // ANSI clear screen
    \ 000000 a9....               lda     ##`_StringLiteral_[27,91,50,74]`
    \ 000003 22......             jsl     long:printf
0051                  }
    \ 000007 6b                   rtl
0052                  
0053                  // I'm not sure this has any effect...
0054                  void ANSIScrSize (int x, int y)
0055                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public ANSIScrSize
    \ 000000          ANSIScrSize:
0056                  	printf("\033e[8;%d,%d;1H",x,y); // SET ANSI screen size to x,y
    \ 000000 a6..                 ldx     dp:.tiny _Dp
    \ 000002 da                   phx
    \ 000003 48                   pha
    \ 000004 a9....               lda     ##`_StringLiteral_[27,101,91,56,59,37,100,44,37,100,59,49,72]`
    \ 000007 22......             jsl     long:printf
    \ 00000b 68                   pla
    \ 00000c 68                   pla
0057                  }
    \ 00000d 6b                   rtl
0058                  
0059                  // ---------------------------------------------------
0060                  // Vicky II wrapper function to help inititate Graphics mode
0061                  // and do some really basic validations
0062                  // By Ernesto Contreras 
0063                  // --------------------------------------------------
0064                  int vickyVideomode (bool text,bool txtOverlay,bool bitmap,bool tiles,bool sprites,bool gammaFix,bool blank,int resolution)
0065                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public vickyVideomode
    \ 000000          vickyVideomode:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 5a                   phy
    \ 000003 5a                   phy
    \ 000004 5a                   phy
    \ 000005 5a                   phy
    \ 000006 8303                 sta     3,s
    \ 000008 a5..                 lda     dp:.tiny _Dp
    \ 00000a 85..                 sta     dp:.tiny (_Dp+8)
    \ 00000c a5..                 lda     dp:.tiny (_Dp+2)
    \ 00000e 8305                 sta     5,s
0066                  	int length;
0067                  	// init graphic mode variables and stack
0068                  	// Valid resolution values 
0069                  	// --------------------------
0070                  	// 0 - 640 x 480
0071                  	// 1 - 800 x 600
0072                  	// 2 - 320 x 240
0073                  	// 3 - 400 x 300
0074                  
0075                  	int intValue;
0076                  	int intResolution;
0077                  
0078                  // Setup initial values 
0079                  	intValue=0;
    \ 000010 a90000               lda     ##0
    \ 000013 8307                 sta     7,s
0080                  	// global variables
0081                    	vickyResX=0;
0082                  	vickyResY=0;
0083                  	vickyBitmapPage=0;
0084                  
0085                  	if (FOENIX_MODEL == Model_U256) 
    \ 000015 22......             jsl     long:`?L1308`
    \ 000019 aa                   tax
    \ 00001a 8e....               stx     vickyBitmapPage
    \ 00001d e220                 sep     #32
    \ 00001f af87e8af             lda     long:11528327
    \ 000023 c901                 cmp     #1
    \ 000025 c220                 rep     #32
    \ 000027 d00b                 bne     `?L17`
0086                  	{
0087                  		maxVickyMemory = 0x1fffff;
    \ 000029 a9ffff               lda     ##65535
    \ 00002c 8d....               sta     maxVickyMemory
    \ 00002f a91f00               lda     ##31
    \ 000032 8009                 bra     `?L1230`
    \ 000034          `?L17`:
0088                  	}
0089                  	else 
0090                  	{
0091                  		maxVickyMemory = 0x3fffff;
    \ 000034 a9ffff               lda     ##65535
    \ 000037 8d....               sta     maxVickyMemory
    \ 00003a a93f00               lda     ##63
    \ 00003d          `?L1230`:
    \ 00003d 8d....               sta     maxVickyMemory+2
0092                  	}
0093                      printf ("Memory detected: %lx \n\r",maxVickyMemory); 
    \ 000040 ad....               lda     maxVickyMemory+2
    \ 000043 48                   pha
    \ 000044 ad....               lda     maxVickyMemory
    \ 000047 48                   pha
    \ 000048 a9....               lda     ##`_StringLiteral_[77,101,109,111,114,121,32,100,101,116,101,99,116,101,100,58,32,37,108,120,32,10,13]`
    \ 00004b 22......             jsl     long:printf
    \ 00004f 8305                 sta     5,s
0094                  
0095                  	if (text) {intValue+=1;}  // enable text mode 
    \ 000051 68                   pla
    \ 000052 68                   pla
    \ 000053 a303                 lda     3,s
    \ 000055 f009                 beq     `?L20`
    \ 000057 a307                 lda     7,s
    \ 000059 1a                   inc     a
    \ 00005a 8301                 sta     1,s
    \ 00005c a301                 lda     1,s
    \ 00005e 8004                 bra     `?L21`
    \ 000060 a307     `?L20`:     lda     7,s
    \ 000062 8301                 sta     1,s
    \ 000064          `?L21`:
0096                  	if (txtOverlay) {intValue+=2;} // enable text overlay 
    \ 000064 a5..                 lda     dp:.tiny (_Dp+8)
    \ 000066 f00a                 beq     `?L23`
    \ 000068 a301                 lda     1,s
    \ 00006a 1a                   inc     a
    \ 00006b 1a                   inc     a
    \ 00006c 8301                 sta     1,s
    \ 00006e a301                 lda     1,s
    \ 000070 8002                 bra     `?L24`
    \ 000072 a301     `?L23`:     lda     1,s
    \ 000074          `?L24`:
0097                  	if (bitmap || tiles || sprites) {intValue+=4;} // enable graphic module
    \ 000074 a305                 lda     5,s
    \ 000076 d008                 bne     `?L28`
    \ 000078 a30e                 lda     14,s
    \ 00007a d004                 bne     `?L28`
    \ 00007c a310                 lda     16,s
    \ 00007e f00c                 beq     `?L26`
    \ 000080 a90400   `?L28`:     lda     ##4
    \ 000083 18                   clc
    \ 000084 6301                 adc     1,s
    \ 000086 8301                 sta     1,s
    \ 000088 8301                 sta     1,s
    \ 00008a 8002                 bra     `?L27`
    \ 00008c a301     `?L26`:     lda     1,s
    \ 00008e          `?L27`:
0098                  	if (bitmap) {intValue+=8;} // enable bitmap engine
    \ 00008e a305                 lda     5,s
    \ 000090 f008                 beq     `?L29`
    \ 000092 a90800               lda     ##8
    \ 000095 18                   clc
    \ 000096 6301                 adc     1,s
    \ 000098 8002                 bra     `?L1229`
    \ 00009a a301     `?L29`:     lda     1,s
    \ 00009c aa       `?L1229`:   tax
0099                  	if (tiles) {intValue+=16;} // enable tiles engine
    \ 00009d a30e                 lda     14,s
    \ 00009f f006                 beq     `?L33`
    \ 0000a1 8a                   txa
    \ 0000a2 18                   clc
    \ 0000a3 691000               adc     ##16
    \ 0000a6 aa                   tax
    \ 0000a7          `?L33`:
0100                  	if (sprites) {intValue+=32;} // enable sprites engine 
    \ 0000a7 a310                 lda     16,s
    \ 0000a9 f006                 beq     `?L36`
    \ 0000ab 8a                   txa
    \ 0000ac 18                   clc
    \ 0000ad 692000               adc     ##32
    \ 0000b0 aa                   tax
    \ 0000b1          `?L36`:
0101                  	if (gammaFix) {intValue+=64;} // use gammaFix 
    \ 0000b1 a312                 lda     18,s
    \ 0000b3 f006                 beq     `?L39`
    \ 0000b5 8a                   txa
    \ 0000b6 18                   clc
    \ 0000b7 694000               adc     ##64
    \ 0000ba aa                   tax
    \ 0000bb          `?L39`:
0102                  	if (blank) {intValue+=128;} // turn off screen 
    \ 0000bb a314                 lda     20,s
    \ 0000bd f009                 beq     `?L41`
    \ 0000bf 8a                   txa
    \ 0000c0 18                   clc
    \ 0000c1 698000               adc     ##128
    \ 0000c4 8301                 sta     1,s
    \ 0000c6 8001                 bra     `?L1228`
    \ 0000c8 8a       `?L41`:     txa
    \ 0000c9 8301     `?L1228`:   sta     1,s
0103                  	if (resolution>=0 && resolution<4) // resolution selected (0-3)
    \ 0000cb a316                 lda     22,s
    \ 0000cd 1003                 bpl     `?L1500`
    \ 0000cf 4c....               jmp     .kbank `?L44`
    \ 0000d2 1a       `?L1500`:   inc     a
    \ 0000d3 3a                   dec     a
    \ 0000d4 38                   sec
    \ 0000d5 e90400               sbc     ##4
    \ 0000d8 5003                 bvc     `?L520`
    \ 0000da 490080               eor     ##-32768
    \ 0000dd 3003     `?L520`:    bmi     `?L1501`
    \ 0000df 4c....               jmp     .kbank `?L44`
    \ 0000e2          `?L1501`:
0104                  	{
0105                  		intResolution=resolution*256;
    \ 0000e2 a316                 lda     22,s
    \ 0000e4 eb                   xba
    \ 0000e5 2900ff               and     ##-256
    \ 0000e8 8303                 sta     3,s
0106                  		MASTER_CTRL_REG =  intResolution+intValue;
    \ 0000ea a301                 lda     1,s
    \ 0000ec 18                   clc
    \ 0000ed 6303                 adc     3,s
    \ 0000ef 8f0000af             sta     long:11468800
0107                  
0108                  		vickyResX=0;
    \ 0000f3 a90000               lda     ##0
0109                  		vickyResY=0;
0110                  
0111                  		switch (resolution)
    \ 0000f6 22......             jsl     long:`?L1308`
    \ 0000fa a316                 lda     22,s
    \ 0000fc 8305                 sta     5,s
    \ 0000fe a90300               lda     ##3
    \ 000101 c305                 cmp     5,s
    \ 000103 b003                 bcs     `?L1502`
    \ 000105 4c....               jmp     .kbank `?L49`
    \ 000108 a305     `?L1502`:   lda     5,s
    \ 00010a 0a                   asl     a
    \ 00010b aa                   tax
    \ 00010c bf......             lda     long:`?L470`,x
    \ 000110 48                   pha
    \ 000111 60                   rts
    \ 000112          `?L50`:
0112                  		{
0113                  		case 0:
0114                  			vickyResX=640;
0115                  			vickyResY=480;
0116                  			ANSIScrSize (80, 60);
0117                  			TEXT_COLS_VISIBLE = 80;
0118                  			TEXT_ROWS_VISIBLE = 60;
0119                  			break;
0120                  		case 1:
0121                  			vickyResX=800;
0122                  			vickyResY=600;
0123                  			ANSIScrSize (100, 75);
0124                  			TEXT_COLS_VISIBLE = 100;
0125                  			TEXT_ROWS_VISIBLE = 75;
0126                  			break;
0127                  		case 2:
0128                  			vickyResX=320;
0129                  			vickyResY=240;
0130                  			ANSIScrSize (40, 30);
0131                  			TEXT_COLS_VISIBLE = 40;
0132                  			TEXT_ROWS_VISIBLE = 30;
0133                  			break;
0134                  		case 3:
0135                  			vickyResX=400;
    \ 000112 a99001               lda     ##400
    \ 000115 8d....               sta     vickyResX
0136                  			vickyResY=300;
0137                  			ANSIScrSize (50, 37);
    \ 000118 22......             jsl     long:`?L1345`
    \ 00011c a92c01               lda     ##300
    \ 00011f 22......             jsl     long:`?L1316`
    \ 000123 a22500               ldx     ##37
    \ 000126 86..                 stx     dp:.tiny _Dp
    \ 000128 a93200               lda     ##50
    \ 00012b 22......             jsl     long:ANSIScrSize
0138                  			TEXT_COLS_VISIBLE = 50;
    \ 00012f a93200               lda     ##50
    \ 000132 8f110000             sta     long:17
0139                  			TEXT_ROWS_VISIBLE = 38;
    \ 000136 a92600               lda     ##38
0140                  			break;
    \ 000139 8079                 bra     `?L1227`
    \ 00013b a94001   `?L51`:     lda     ##320
    \ 00013e 8d....               sta     vickyResX
    \ 000141 22......             jsl     long:`?L1345`
    \ 000145 a9f000               lda     ##240
    \ 000148 22......             jsl     long:`?L1316`
    \ 00014c a21e00               ldx     ##30
    \ 00014f 86..                 stx     dp:.tiny _Dp
    \ 000151 a92800               lda     ##40
    \ 000154 22......             jsl     long:ANSIScrSize
    \ 000158 a92800               lda     ##40
    \ 00015b 8f110000             sta     long:17
    \ 00015f a91e00               lda     ##30
    \ 000162 8050                 bra     `?L1227`
    \ 000164 a92003   `?L52`:     lda     ##800
    \ 000167 8d....               sta     vickyResX
    \ 00016a 22......             jsl     long:`?L1345`
    \ 00016e a95802               lda     ##600
    \ 000171 22......             jsl     long:`?L1316`
    \ 000175 a24b00               ldx     ##75
    \ 000178 86..                 stx     dp:.tiny _Dp
    \ 00017a a96400               lda     ##100
    \ 00017d 22......             jsl     long:ANSIScrSize
    \ 000181 a96400               lda     ##100
    \ 000184 8f110000             sta     long:17
    \ 000188 a94b00               lda     ##75
    \ 00018b 8027                 bra     `?L1227`
    \ 00018d a98002   `?L53`:     lda     ##640
    \ 000190 8d....               sta     vickyResX
    \ 000193 22......             jsl     long:`?L1345`
    \ 000197 a9e001               lda     ##480
    \ 00019a 22......             jsl     long:`?L1316`
    \ 00019e a23c00               ldx     ##60
    \ 0001a1 86..                 stx     dp:.tiny _Dp
    \ 0001a3 a95000               lda     ##80
    \ 0001a6 22......             jsl     long:ANSIScrSize
    \ 0001aa a95000               lda     ##80
    \ 0001ad 8f110000             sta     long:17
    \ 0001b1 a93c00               lda     ##60
    \ 0001b4 8f150000 `?L1227`:   sta     long:21
    \ 0001b8 8007                 bra     `?L47`
    \ 0001ba          `?L49`:
0141                  		default:
0142                  			vickyResX=0;
    \ 0001ba a90000               lda     ##0
0143                  			vickyResY=0;
    \ 0001bd 22......             jsl     long:`?L1308`
    \ 0001c1          `?L47`:
0144                  		}
0145                  		printf ("graphics mode %d x:%ld y:%ld\n\r",resolution,vickyResX,vickyResY);
    \ 0001c1 ad....               lda     vickyResY+2
    \ 0001c4 48                   pha
    \ 0001c5 ad....               lda     vickyResY
    \ 0001c8 48                   pha
    \ 0001c9 ad....               lda     vickyResX+2
    \ 0001cc 48                   pha
    \ 0001cd ad....               lda     vickyResX
    \ 0001d0 48                   pha
    \ 0001d1 a31e                 lda     30,s
    \ 0001d3 48                   pha
    \ 0001d4 a9....               lda     ##`_StringLiteral_[103,114,97,112,104,105,99,115,32,109,111,100,101,32,37,100,32,120,58,37,108,100,32,121,58,37,108,100,10,13]`
    \ 0001d7 22......             jsl     long:printf
0146                  		return intResolution+intValue;	
    \ 0001db 3b                   tsc
    \ 0001dc 18                   clc
    \ 0001dd 690a00               adc     ##10
    \ 0001e0 1b                   tcs
    \ 0001e1 a301                 lda     1,s
    \ 0001e3 18                   clc
    \ 0001e4 6303                 adc     3,s
    \ 0001e6 8003                 bra     `?L16`
    \ 0001e8          `?L44`:
0147                  	}
0148                  	else {return -1;}
    \ 0001e8 a9ffff               lda     ##-1
    \ 0001eb          `?L16`:
0149                  }
    \ 0001eb 7a                   ply
    \ 0001ec 7a                   ply
    \ 0001ed 7a                   ply
    \ 0001ee 7a                   ply
    \ 0001ef 7a                   ply
    \ 0001f0 84..                 sty     dp:.tiny (_Dp+8)
    \ 0001f2 6b                   rtl
0150                  
0151                  // ---------------------------------------------------
0152                  // Vicky II wrapper functions to help setup bitmap
0153                  // and do some really basic validations
0154                  // By Ernesto Contreras 
0155                  // --------------------------------------------------
0156                  int vickyBitmap(int page, bool enable, long address, int lut, bool collision)
0157                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public vickyBitmap
    \ 000000          vickyBitmap:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 a8                   tay
    \ 000005 3b                   tsc
    \ 000006 38                   sec
    \ 000007 e90a00               sbc     ##10
    \ 00000a 1b                   tcs
    \ 00000b 98                   tya
    \ 00000c 8309                 sta     9,s
    \ 00000e a5..                 lda     dp:.tiny (_Dp+4)
    \ 000010 85..                 sta     dp:.tiny (_Dp+8)
    \ 000012 a5..                 lda     dp:.tiny (_Dp+6)
    \ 000014 85..                 sta     dp:.tiny (_Dp+10)
    \ 000016 a5..                 lda     dp:.tiny _Dp
    \ 000018 8307                 sta     7,s
    \ 00001a a6..                 ldx     dp:.tiny (_Dp+2)
0158                  // page - Value between 0-1 to select one of the two bitmaps supported by Vicky II
0159                  // enable - true or false to show/hide bitmap 
0160                  // address - {0-0x1fffff} (2 Mb)| {0-0x3fffff} (4 Mb)
0161                  // lut - {0-7} select one of the 8 palettes
0162                  // 	collision - true | false  (Enable collision with the bitmap)
0163                  
0164                  	int intEnable;
0165                  	int intCollision;
0166                  	int intLut;
0167                  	
0168                  	// Translate Control Bits value
0169                  	//Bit 0 = disable/enable
0170                  	//Bit 1-3 = Target LUT address located at AF:2000 and up.
0171                  	//Bit 6 = Bitmap Collision On
0172                  	
0173                  	if (enable) {intEnable=1;} else {intEnable=0;}
    \ 00001c a307                 lda     7,s
    \ 00001e f007                 beq     `?L63`
    \ 000020 a90100               lda     ##1
    \ 000023 8301                 sta     1,s
    \ 000025 8005                 bra     `?L1232`
    \ 000027 a90000   `?L63`:     lda     ##0
    \ 00002a 8301                 sta     1,s
    \ 00002c 8301     `?L1232`:   sta     1,s
0174                  	if (collision) {intCollision=32;} else {intCollision=0;}
    \ 00002e a312                 lda     18,s
    \ 000030 f007                 beq     `?L66`
    \ 000032 a92000               lda     ##32
    \ 000035 8303                 sta     3,s
    \ 000037 8005                 bra     `?L1231`
    \ 000039 a90000   `?L66`:     lda     ##0
    \ 00003c 8303                 sta     3,s
    \ 00003e 8303     `?L1231`:   sta     3,s
0175                  	if (lut>=0 && lut <8)   {intLut=lut*2;}
    \ 000040 86..                 stx     dp:.tiny _Dp
    \ 000042 a5..                 lda     dp:.tiny _Dp
    \ 000044 3014                 bmi     `?L69`
    \ 000046 8a                   txa
    \ 000047 38                   sec
    \ 000048 e90800               sbc     ##8
    \ 00004b 5003                 bvc     `?L527`
    \ 00004d 490080               eor     ##-32768
    \ 000050 1008     `?L527`:    bpl     `?L69`
    \ 000052 8a                   txa
    \ 000053 0a                   asl     a
    \ 000054 8305                 sta     5,s
    \ 000056 8305                 sta     5,s
    \ 000058 8002                 bra     `?L70`
    \ 00005a a305     `?L69`:     lda     5,s
    \ 00005c          `?L70`:
0176                  	
0177                  	if (address >= 0 && address < (maxVickyMemory-(vickyResX*vickyResY)))
    \ 00005c a5..                 lda     dp:.tiny (_Dp+10)
    \ 00005e 1003                 bpl     `?L1503`
    \ 000060 4c....               jmp     .kbank `?L72`
    \ 000063          `?L1503`:
    \ 000063 ac....               ldy     vickyResX
    \ 000066 84..                 sty     dp:.tiny _Dp
    \ 000068 ac....               ldy     vickyResX+2
    \ 00006b 84..                 sty     dp:.tiny (_Dp+2)
    \ 00006d ac....               ldy     vickyResY
    \ 000070 84..                 sty     dp:.tiny (_Dp+4)
    \ 000072 ac....               ldy     vickyResY+2
    \ 000075 84..                 sty     dp:.tiny (_Dp+6)
    \ 000077 22......             jsl     long:_Mul32
    \ 00007b 86..                 stx     dp:.tiny (_Dp+2)
    \ 00007d 85..                 sta     dp:.tiny _Dp
    \ 00007f ad....               lda     maxVickyMemory
    \ 000082 ae....               ldx     maxVickyMemory+2
    \ 000085 38                   sec
    \ 000086 e5..                 sbc     dp:.tiny _Dp
    \ 000088 48                   pha
    \ 000089 8a                   txa
    \ 00008a e5..                 sbc     dp:.tiny (_Dp+2)
    \ 00008c aa                   tax
    \ 00008d 68                   pla
    \ 00008e 86..                 stx     dp:.tiny (_Dp+2)
    \ 000090 85..                 sta     dp:.tiny _Dp
    \ 000092 a5..                 lda     dp:.tiny (_Dp+8)
    \ 000094 c5..                 cmp     dp:.tiny _Dp
    \ 000096 a5..                 lda     dp:.tiny (_Dp+10)
    \ 000098 e5..                 sbc     dp:.tiny (_Dp+2)
    \ 00009a 5003                 bvc     `?L530`
    \ 00009c 490080               eor     ##-32768
    \ 00009f 3003     `?L530`:    bmi     `?L1504`
    \ 0000a1 4c....               jmp     .kbank `?L72`
    \ 0000a4          `?L1504`:
0178                  	{
0179                  		if (page==0 || page ==1)
    \ 0000a4 a309                 lda     9,s
    \ 0000a6 f008                 beq     `?L77`
    \ 0000a8 c90100               cmp     ##1
    \ 0000ab f003                 beq     `?L1505`
    \ 0000ad 4c....               jmp     .kbank `?L75`
    \ 0000b0          `?L1505`:
    \ 0000b0          `?L77`:
0180                  		{
0181                  			vickyBitmapPage=page; // set defined page as current Page
    \ 0000b0 8d....               sta     vickyBitmapPage
0182                  			bitplane[page].control = intEnable+intLut+intCollision;
    \ 0000b3 a305                 lda     5,s
    \ 0000b5 18                   clc
    \ 0000b6 6301                 adc     1,s
    \ 0000b8 18                   clc
    \ 0000b9 6303                 adc     3,s
    \ 0000bb 48                   pha
    \ 0000bc a30b                 lda     11,s
    \ 0000be 0a                   asl     a
    \ 0000bf 0a                   asl     a
    \ 0000c0 0a                   asl     a
    \ 0000c1 aa                   tax
    \ 0000c2 68                   pla
    \ 0000c3 e220                 sep     #32
    \ 0000c5 9f0001af             sta     long:11469056,x
    \ 0000c9 c220                 rep     #32
0183                  			bitplane[page].start = (__far vram_ptr) address;
    \ 0000cb a6..                 ldx     dp:.tiny (_Dp+10)
    \ 0000cd a5..                 lda     dp:.tiny (_Dp+8)
    \ 0000cf da                   phx
    \ 0000d0 48                   pha
    \ 0000d1 a00001               ldy     ##256
    \ 0000d4 84..                 sty     dp:.tiny _Dp
    \ 0000d6 a0af00               ldy     ##175
    \ 0000d9 84..                 sty     dp:.tiny (_Dp+2)
    \ 0000db a30d                 lda     13,s
0184                  			bitplane[page].x_offset = 0;
0185                  			bitplane[page].y_offset = 0;
0186                  			bitplane[page].reserved = 0;
0187                  			vBitPlane[page]=enable;
0188                  			return 0;
    \ 0000dd 22......             jsl     long:`?L1287`
    \ 0000e1 68                   pla
    \ 0000e2 fa                   plx
    \ 0000e3 a00100               ldy     ##1
    \ 0000e6 97..                 sta     [.tiny _Dp],y
    \ 0000e8 8a                   txa
    \ 0000e9 e220                 sep     #32
    \ 0000eb 22......             jsl     long:`?L1351`
    \ 0000ef 22......             jsl     long:`?L1319`
    \ 0000f3 a309                 lda     9,s
    \ 0000f5 22......             jsl     long:`?L1287`
    \ 0000f9 e220                 sep     #32
    \ 0000fb a900                 lda     #0
    \ 0000fd c8                   iny
    \ 0000fe 97..                 sta     [.tiny _Dp],y
    \ 000100 c220                 rep     #32
    \ 000102 22......             jsl     long:`?L1319`
    \ 000106 a309                 lda     9,s
    \ 000108 22......             jsl     long:`?L1287`
    \ 00010c e220                 sep     #32
    \ 00010e a900                 lda     #0
    \ 000110 c8                   iny
    \ 000111 97..                 sta     [.tiny _Dp],y
    \ 000113 c220                 rep     #32
    \ 000115 a20001               ldx     ##256
    \ 000118 86..                 stx     dp:.tiny _Dp
    \ 00011a a2af00               ldx     ##175
    \ 00011d 86..                 stx     dp:.tiny (_Dp+2)
    \ 00011f a309                 lda     9,s
    \ 000121 22......             jsl     long:`?L1287`
    \ 000125 a90000               lda     ##0
    \ 000128 c8                   iny
    \ 000129 97..                 sta     [.tiny _Dp],y
    \ 00012b a309                 lda     9,s
    \ 00012d 0a                   asl     a
    \ 00012e aa                   tax
    \ 00012f a307                 lda     7,s
    \ 000131 9d....               sta     vBitPlane,x
    \ 000134 a90000               lda     ##0
    \ 000137 8047                 bra     `?L62`
    \ 000139          `?L75`:
0189                  		}
0190                  			else 
0191                  			{
0192                  				printf ("Bitmap page must be 0 or 1!");
    \ 000139 a9....               lda     ##`_StringLiteral_Bitmap page must be 0 or 1!`
    \ 00013c 22......             jsl     long:printf
0193                  				return -1;
    \ 000140 a9ffff               lda     ##-1
    \ 000143 803b                 bra     `?L62`
    \ 000145          `?L72`:
0194                  			} // Page number must be between 1-2 Error
0195                  	}
0196                  		else  
0197                  		{
0198                  			printf ("Not enough memory at address %lx for a d% by d% screen!, %xl bytes required.\n\r",address,vickyResX,vickyResY,(long)vickyResX*vickyResY);
    \ 000145 22......             jsl     long:`?L1291`
    \ 000149 da                   phx
    \ 00014a 48                   pha
    \ 00014b ad....               lda     vickyResY+2
    \ 00014e 48                   pha
    \ 00014f ad....               lda     vickyResY
    \ 000152 48                   pha
    \ 000153 ad....               lda     vickyResX+2
    \ 000156 48                   pha
    \ 000157 ad....               lda     vickyResX
    \ 00015a 48                   pha
    \ 00015b a5..                 lda     dp:.tiny (_Dp+10)
    \ 00015d 48                   pha
    \ 00015e a5..                 lda     dp:.tiny (_Dp+8)
    \ 000160 48                   pha
    \ 000161 a9....               lda     ##`_StringLiteral_[78,111,116,32,101,110,111,117,103,104,32,109,101,109,111,114,121,32,97,116,32,97,100,100,114,101,115,115,32,37,108,120,32,102,111,114,32,97,32,100,37,32,98,121,32,100,37,32,115,99,114,101,101,110,33,44,32,37,120,108,32,98,121,116,101,115,32,114,101,113,117,105,114,101,100,46,10,13]`
    \ 000164 22......             jsl     long:printf
0199                  			printf ("VRAM detected: 0xb00000 - %lx\n\r",maxVickyMemory);
    \ 000168 ad....               lda     maxVickyMemory+2
    \ 00016b 48                   pha
    \ 00016c ad....               lda     maxVickyMemory
    \ 00016f 48                   pha
    \ 000170 a9....               lda     ##`_StringLiteral_[86,82,65,77,32,100,101,116,101,99,116,101,100,58,32,48,120,98,48,48,48,48,48,32,45,32,37,108,120,10,13]`
    \ 000173 22......             jsl     long:printf
0200                  			return -2;
    \ 000177 3b                   tsc
    \ 000178 18                   clc
    \ 000179 691400               adc     ##20
    \ 00017c 1b                   tcs
    \ 00017d a9feff               lda     ##-2
    \ 000180          `?L62`:
0201                  		} // out of memory range Error
0202                  }
    \ 000180 a8                   tay
    \ 000181 3b                   tsc
    \ 000182 18                   clc
    \ 000183 690a00               adc     ##10
    \ 000186 1b                   tcs
    \ 000187 98                   tya
    \ 000188 7a                   ply
    \ 000189 84..                 sty     dp:.tiny (_Dp+10)
    \ 00018b 7a                   ply
    \ 00018c 84..                 sty     dp:.tiny (_Dp+8)
    \ 00018e 6b                   rtl
0203                  
0204                  void vickyDefPalette ()
0205                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public vickyDefPalette
    \ 000000          vickyDefPalette:
    \ 000000 3b                   tsc
    \ 000001 38                   sec
    \ 000002 e90604               sbc     ##1030
    \ 000005 1b                   tcs
0206                  	uint8_t __far *ptr;
0207                      uint8_t palette[] ={
    \ 000006 3b                   tsc
    \ 000007 18                   clc
    \ 000008 690700               adc     ##7
    \ 00000b 85..                 sta     dp:.tiny _Dp
    \ 00000d a2....               ldx     ##`??_Initializer0`
    \ 000010 86..                 stx     dp:.tiny (_Dp+2)
    \ 000012 a0fe03               ldy     ##1022
    \ 000015 22......             jsl     long:_MoveLongNear
0208                  	0,0,0,255,0,0,0,255,35,35,34,104,73,69,67,139,
0209                  	113,104,98,255,152,139,130,255,186,174,166,93,200,200,200,117,
0210                  	84,93,98,255,101,117,133,255,121,140,158,175,137,161,174,195,
0211                  	164,175,187,255,177,195,204,255,201,219,234,49,214,243,255,61,
0212                  	38,49,88,255,59,61,115,255,65,80,136,110,76,98,154,141,
0213                  	81,110,173,255,107,141,213,255,132,170,251,39,127,206,255,56,
0214                  	53,39,0,255,80,56,0,255,94,77,0,111,127,102,11,140,
0215                  	137,111,0,255,167,140,50,255,214,174,36,43,255,214,136,54,
0216                  	41,43,102,255,58,54,148,255,70,77,182,120,70,94,205,155,
0217                  	64,120,227,255,78,155,249,255,78,188,255,43,73,233,255,69,
0218                  	74,43,40,255,104,69,58,255,132,95,97,144,153,119,122,178,
0219                  	178,144,134,255,217,178,150,255,255,214,199,34,255,236,198,50,
0220                  	25,34,0,255,33,50,0,255,27,74,23,105,24,89,34,136,
0221                  	12,105,47,255,34,136,81,255,45,164,125,31,52,204,166,50,
0222                  	47,31,24,255,77,50,35,255,107,70,37,142,138,107,54,178,
0223                  	184,142,49,255,227,178,65,255,255,210,82,51,253,245,116,63,
0224                  	44,51,26,255,56,63,47,255,64,81,56,116,64,92,50,137,
0225                  	85,116,65,255,96,137,73,255,125,182,85,7,161,218,145,33,
0226                  	17,7,94,255,29,33,130,255,53,60,182,118,95,92,228,155,
0227                  	118,118,255,255,168,155,255,255,199,187,255,49,255,219,255,71,
0228                  	54,49,45,255,77,71,72,255,105,92,91,135,127,115,115,174,
0229                  	149,135,132,255,190,174,171,255,219,199,186,48,246,240,235,60,
0230                  	60,48,59,255,69,60,90,255,88,82,138,130,96,107,174,159,
0231                  	108,130,199,255,117,159,216,255,129,197,236,34,171,250,255,53,
0232                  	42,34,49,255,60,53,74,255,70,70,94,108,81,90,114,138,
0233                  	84,108,126,255,110,138,158,255,136,165,192,16,154,191,221,40,
0234                  	38,16,46,255,61,40,73,255,89,54,102,109,117,84,151,120,
0235                  	145,109,185,255,170,120,193,255,191,153,219,46,218,198,248,64,
0236                  	73,46,0,255,81,64,0,255,98,81,0,130,109,107,0,160,
0237                  	121,130,0,255,135,160,0,255,163,191,0,255,218,222,0,74,
0238                  	37,49,69,255,60,74,97,255,68,97,126,144,81,121,153,169,
0239                  	98,144,178,255,110,169,204,255,130,203,232,9,163,234,251,36,
0240                  	38,9,95,255,52,36,110,110,71,70,144,100,87,96,167,112,
0241                  	100,125,189,189,112,151,206,206,124,182,237,237,147,212,237,128,
0242                  	88,53,50,50,128,82,74,74,157,101,100,100,193,119,120,239,
0243                  	226,140,142,142,239,155,156,156,255,174,184,184,255,212,220,59,
0244                  	41,23,67,67,59,43,113,113,82,59,159,159,105,74,217,175,
0245                  	128,93,248,248,175,125,255,255,197,166,255,255,255,205,255,50,
0246                  	28,37,73,73,50,52,99,99,71,75,124,124,90,89,152,122,
0247                  	110,111,172,172,122,126,193,193,122,141,210,210,124,154,229,8,
0248                  	0,41,32,32,8,79,47,47,0,93,73,73,8,115,97,38,
0249                  	30,131,124,124,38,154,150,150,51,170,180,180,50,204,208,9,
0250                  	0,42,98,98,9,59,117,117,18,79,133,133,32,101,158,57,
0251                  	46,136,186,186,57,170,209,209,75,210,232,232,79,246,255,85,
0252                  	61,35,38,38,85,56,59,59,111,80,86,86,110,104,117,131,
0253                  	123,122,145,145,131,151,179,179,142,175,207,207,177,223,254,71,
0254                  	67,44,29,29,71,61,46,255,60,77,57,57,51,95,76,45,
0255                  	44,113,88,88,45,132,107,197,36,158,120,120,57,189,127,58,
0256                  	35,36,55,55,58,57,83,83,73,76,120,120,79,93,148,99,
0257                  	88,109,169,169,99,126,191,191,116,147,215,215,128,163,244,90,
0258                  	71,75,45,45,90,101,71,71,105,123,91,91,125,149,113,150,
0259                  	142,174,135,135,150,193,138,138,193,209,169,169,235,250,224,95,
0260                  	64,27,0,0,95,49,3,3,124,72,7,7,162,93,16,234,
0261                  	192,118,20,20,234,151,64,64,241,177,85,85,255,204,109,115,
0262                  	105,71,85,85,115,93,118,118,136,116,151,151,147,140,185,157,
0263                  	154,163,213,213,157,189,235,235,155,213,255,255,134,247,253,81,
0264                  	33,29,29,29,81,49,60,60,127,74,88,88,186,100,121,236,
0265                  	241,133,149,149,236,150,169,169,247,171,186,186,254,189,209,93,
0266                  	80,36,38,38,93,51,40,40,114,61,45,45,131,80,61,197,
0267                  	174,101,81,81,197,116,82,82,196,130,108,108,195,147,131,74,
0268                  	41,33,73,73,74,65,94,94,91,83,119,119,106,96,145,148,
0269                  	132,121,173,173,148,139,181,181,170,174,212,212,207,226,255,39,
0270                  	3,28,114,114,39,51,156,156,62,90,191,191,39,134,233,5,
0271                  	8,177,255,255,5,207,255,255,43,240,255,255,255,255,255,65};
0272                  
0273                  	int vi, index;
0274                  	vi=0;
    \ 000019 a90000               lda     ##0
    \ 00001c 8301                 sta     1,s
0275                  	for (index=0;index<256;index++)
    \ 00001e aa                   tax
    \ 00001f a301                 lda     1,s
    \ 000021 8303                 sta     3,s
    \ 000023 8a                   txa
    \ 000024 8305     `?L1233`:   sta     5,s
    \ 000026 a305                 lda     5,s
    \ 000028 38                   sec
    \ 000029 e90001               sbc     ##256
    \ 00002c 5003                 bvc     `?L537`
    \ 00002e 490080               eor     ##-32768
    \ 000031 3007     `?L537`:    bmi     `?L84`
0276                  	{
0277                  		ptr= (long)GRPH_LUT0_LONG +(index*4);
0278                  		//printf ("ptr:%lx r:%d g:%d b:%d a:%d \r",ptr, palette[vi], palette[vi+1], palette[vi+2], palette[vi+3]);
0279                  		// set rgb components at palette address
0280                  		*(ptr+2)= palette[vi++]; // red
0281                  		*(ptr+1)= palette[vi++]; // green
0282                  		*(ptr)=   palette[vi++]; // blue 
0283                  		*(ptr+3)= palette[vi++]; // alpha
0284                  	}
0285                  }
    \ 000033 3b                   tsc
    \ 000034 18                   clc
    \ 000035 690604               adc     ##1030
    \ 000038 1b                   tcs
    \ 000039 6b                   rtl
    \ 00003a a305     `?L84`:     lda     5,s
    \ 00003c 0a                   asl     a
    \ 00003d 0a                   asl     a
    \ 00003e a20000               ldx     ##0
    \ 000041 a8                   tay
    \ 000042 1001                 bpl     `?L539`
    \ 000044 ca                   dex
    \ 000045 18       `?L539`:    clc
    \ 000046 690020               adc     ##8192
    \ 000049 48                   pha
    \ 00004a 8a                   txa
    \ 00004b 69af00               adc     ##175
    \ 00004e aa                   tax
    \ 00004f 68                   pla
    \ 000050 86..                 stx     dp:.tiny (_Dp+2)
    \ 000052 85..                 sta     dp:.tiny _Dp
    \ 000054 a303                 lda     3,s
    \ 000056 8301                 sta     1,s
    \ 000058 a303                 lda     3,s
    \ 00005a 1a                   inc     a
    \ 00005b 8303                 sta     3,s
    \ 00005d 3b                   tsc
    \ 00005e 18                   clc
    \ 00005f 690700               adc     ##7
    \ 000062 a8                   tay
    \ 000063 b301                 lda     (1,s),y
    \ 000065 e220                 sep     #32
    \ 000067 a00200               ldy     ##2
    \ 00006a 97..                 sta     [.tiny _Dp],y
    \ 00006c c220                 rep     #32
    \ 00006e a303                 lda     3,s
    \ 000070 8301                 sta     1,s
    \ 000072 a303                 lda     3,s
    \ 000074 1a                   inc     a
    \ 000075 8303                 sta     3,s
    \ 000077 3b                   tsc
    \ 000078 18                   clc
    \ 000079 690700               adc     ##7
    \ 00007c a8                   tay
    \ 00007d b301                 lda     (1,s),y
    \ 00007f e220                 sep     #32
    \ 000081 a00100               ldy     ##1
    \ 000084 97..                 sta     [.tiny _Dp],y
    \ 000086 c220                 rep     #32
    \ 000088 a303                 lda     3,s
    \ 00008a 8301                 sta     1,s
    \ 00008c a303                 lda     3,s
    \ 00008e 1a                   inc     a
    \ 00008f 8303                 sta     3,s
    \ 000091 3b                   tsc
    \ 000092 18                   clc
    \ 000093 690700               adc     ##7
    \ 000096 a8                   tay
    \ 000097 b301                 lda     (1,s),y
    \ 000099 e220                 sep     #32
    \ 00009b 87..                 sta     [.tiny _Dp]
    \ 00009d c220                 rep     #32
    \ 00009f a303                 lda     3,s
    \ 0000a1 8301                 sta     1,s
    \ 0000a3 a303                 lda     3,s
    \ 0000a5 1a                   inc     a
    \ 0000a6 8303                 sta     3,s
    \ 0000a8 3b                   tsc
    \ 0000a9 18                   clc
    \ 0000aa 690700               adc     ##7
    \ 0000ad a8                   tay
    \ 0000ae b301                 lda     (1,s),y
    \ 0000b0 e220                 sep     #32
    \ 0000b2 22......             jsl     long:`?L1351`
    \ 0000b6 a305                 lda     5,s
    \ 0000b8 1a                   inc     a
    \ 0000b9 8301                 sta     1,s
    \ 0000bb a301                 lda     1,s
    \ 0000bd 4c....               jmp     .kbank `?L1233`
    \ 000000                      .section cdata,rodata
    \ 000000          `??_Initializer0`:
    \ 000000 000000ff             .byte   0,0,0,-1,0,0,0,-1
    \ 000004 000000ff
    \ 000008 23232268             .byte   35,35,34,104,73,69,67,-117
    \ 00000c 4945438b
    \ 000010 716862ff             .byte   113,104,98,-1,-104,-117,-126,-1
    \ 000014 988b82ff
    \ 000018 baaea65d             .byte   -70,-82,-90,93,-56,-56,-56,117
    \ 00001c c8c8c875
    \ 000020 545d62ff             .byte   84,93,98,-1,101,117,-123,-1
    \ 000024 657585ff
    \ 000028 798c9eaf             .byte   121,-116,-98,-81,-119,-95,-82,-61
    \ 00002c 89a1aec3
    \ 000030 a4afbbff             .byte   -92,-81,-69,-1,-79,-61,-52,-1
    \ 000034 b1c3ccff
    \ 000038 c9dbea31             .byte   -55,-37,-22,49,-42,-13,-1,61
    \ 00003c d6f3ff3d
    \ 000040 263158ff             .byte   38,49,88,-1,59,61,115,-1
    \ 000044 3b3d73ff
    \ 000048 4150886e             .byte   65,80,-120,110,76,98,-102,-115
    \ 00004c 4c629a8d
    \ 000050 516eadff             .byte   81,110,-83,-1,107,-115,-43,-1
    \ 000054 6b8dd5ff
    \ 000058 84aafb27             .byte   -124,-86,-5,39,127,-50,-1,56
    \ 00005c 7fceff38
    \ 000060 352700ff             .byte   53,39,0,-1,80,56,0,-1
    \ 000064 503800ff
    \ 000068 5e4d006f             .byte   94,77,0,111,127,102,11,-116
    \ 00006c 7f660b8c
    \ 000070 896f00ff             .byte   -119,111,0,-1,-89,-116,50,-1
    \ 000074 a78c32ff
    \ 000078 d6ae242b             .byte   -42,-82,36,43,-1,-42,-120,54
    \ 00007c ffd68836
    \ 000080 292b66ff             .byte   41,43,102,-1,58,54,-108,-1
    \ 000084 3a3694ff
    \ 000088 464db678             .byte   70,77,-74,120,70,94,-51,-101
    \ 00008c 465ecd9b
    \ 000090 4078e3ff             .byte   64,120,-29,-1,78,-101,-7,-1
    \ 000094 4e9bf9ff
    \ 000098 4ebcff2b             .byte   78,-68,-1,43,73,-23,-1,69
    \ 00009c 49e9ff45
    \ 0000a0 4a2b28ff             .byte   74,43,40,-1,104,69,58,-1
    \ 0000a4 68453aff
    \ 0000a8 845f6190             .byte   -124,95,97,-112,-103,119,122,-78
    \ 0000ac 99777ab2
    \ 0000b0 b29086ff             .byte   -78,-112,-122,-1,-39,-78,-106,-1
    \ 0000b4 d9b296ff
    \ 0000b8 ffd6c722             .byte   -1,-42,-57,34,-1,-20,-58,50
    \ 0000bc ffecc632
    \ 0000c0 192200ff             .byte   25,34,0,-1,33,50,0,-1
    \ 0000c4 213200ff
    \ 0000c8 1b4a1769             .byte   27,74,23,105,24,89,34,-120
    \ 0000cc 18592288
    \ 0000d0 0c692fff             .byte   12,105,47,-1,34,-120,81,-1
    \ 0000d4 228851ff
    \ 0000d8 2da47d1f             .byte   45,-92,125,31,52,-52,-90,50
    \ 0000dc 34cca632
    \ 0000e0 2f1f18ff             .byte   47,31,24,-1,77,50,35,-1
    \ 0000e4 4d3223ff
    \ 0000e8 6b46258e             .byte   107,70,37,-114,-118,107,54,-78
    \ 0000ec 8a6b36b2
    \ 0000f0 b88e31ff             .byte   -72,-114,49,-1,-29,-78,65,-1
    \ 0000f4 e3b241ff
    \ 0000f8 ffd25233             .byte   -1,-46,82,51,-3,-11,116,63
    \ 0000fc fdf5743f
    \ 000100 2c331aff             .byte   44,51,26,-1,56,63,47,-1
    \ 000104 383f2fff
    \ 000108 40513874             .byte   64,81,56,116,64,92,50,-119
    \ 00010c 405c3289
    \ 000110 557441ff             .byte   85,116,65,-1,96,-119,73,-1
    \ 000114 608949ff
    \ 000118 7db65507             .byte   125,-74,85,7,-95,-38,-111,33
    \ 00011c a1da9121
    \ 000120 11075eff             .byte   17,7,94,-1,29,33,-126,-1
    \ 000124 1d2182ff
    \ 000128 353cb676             .byte   53,60,-74,118,95,92,-28,-101
    \ 00012c 5f5ce49b
    \ 000130 7676ffff             .byte   118,118,-1,-1,-88,-101,-1,-1
    \ 000134 a89bffff
    \ 000138 c7bbff31             .byte   -57,-69,-1,49,-1,-37,-1,71
    \ 00013c ffdbff47
    \ 000140 36312dff             .byte   54,49,45,-1,77,71,72,-1
    \ 000144 4d4748ff
    \ 000148 695c5b87             .byte   105,92,91,-121,127,115,115,-82
    \ 00014c 7f7373ae
    \ 000150 958784ff             .byte   -107,-121,-124,-1,-66,-82,-85,-1
    \ 000154 beaeabff
    \ 000158 dbc7ba30             .byte   -37,-57,-70,48,-10,-16,-21,60
    \ 00015c f6f0eb3c
    \ 000160 3c303bff             .byte   60,48,59,-1,69,60,90,-1
    \ 000164 453c5aff
    \ 000168 58528a82             .byte   88,82,-118,-126,96,107,-82,-97
    \ 00016c 606bae9f
    \ 000170 6c82c7ff             .byte   108,-126,-57,-1,117,-97,-40,-1
    \ 000174 759fd8ff
    \ 000178 81c5ec22             .byte   -127,-59,-20,34,-85,-6,-1,53
    \ 00017c abfaff35
    \ 000180 2a2231ff             .byte   42,34,49,-1,60,53,74,-1
    \ 000184 3c354aff
    \ 000188 46465e6c             .byte   70,70,94,108,81,90,114,-118
    \ 00018c 515a728a
    \ 000190 546c7eff             .byte   84,108,126,-1,110,-118,-98,-1
    \ 000194 6e8a9eff
    \ 000198 88a5c010             .byte   -120,-91,-64,16,-102,-65,-35,40
    \ 00019c 9abfdd28
    \ 0001a0 26102eff             .byte   38,16,46,-1,61,40,73,-1
    \ 0001a4 3d2849ff
    \ 0001a8 5936666d             .byte   89,54,102,109,117,84,-105,120
    \ 0001ac 75549778
    \ 0001b0 916db9ff             .byte   -111,109,-71,-1,-86,120,-63,-1
    \ 0001b4 aa78c1ff
    \ 0001b8 bf99db2e             .byte   -65,-103,-37,46,-38,-58,-8,64
    \ 0001bc dac6f840
    \ 0001c0 492e00ff             .byte   73,46,0,-1,81,64,0,-1
    \ 0001c4 514000ff
    \ 0001c8 62510082             .byte   98,81,0,-126,109,107,0,-96
    \ 0001cc 6d6b00a0
    \ 0001d0 798200ff             .byte   121,-126,0,-1,-121,-96,0,-1
    \ 0001d4 87a000ff
    \ 0001d8 a3bf00ff             .byte   -93,-65,0,-1,-38,-34,0,74
    \ 0001dc dade004a
    \ 0001e0 253145ff             .byte   37,49,69,-1,60,74,97,-1
    \ 0001e4 3c4a61ff
    \ 0001e8 44617e90             .byte   68,97,126,-112,81,121,-103,-87
    \ 0001ec 517999a9
    \ 0001f0 6290b2ff             .byte   98,-112,-78,-1,110,-87,-52,-1
    \ 0001f4 6ea9ccff
    \ 0001f8 82cbe809             .byte   -126,-53,-24,9,-93,-22,-5,36
    \ 0001fc a3eafb24
    \ 000200 26095fff             .byte   38,9,95,-1,52,36,110,110
    \ 000204 34246e6e
    \ 000208 47469064             .byte   71,70,-112,100,87,96,-89,112
    \ 00020c 5760a770
    \ 000210 647dbdbd             .byte   100,125,-67,-67,112,-105,-50,-50
    \ 000214 7097cece
    \ 000218 7cb6eded             .byte   124,-74,-19,-19,-109,-44,-19,-128
    \ 00021c 93d4ed80
    \ 000220 58353232             .byte   88,53,50,50,-128,82,74,74
    \ 000224 80524a4a
    \ 000228 9d656464             .byte   -99,101,100,100,-63,119,120,-17
    \ 00022c c17778ef
    \ 000230 e28c8e8e             .byte   -30,-116,-114,-114,-17,-101,-100,-100
    \ 000234 ef9b9c9c
    \ 000238 ffaeb8b8             .byte   -1,-82,-72,-72,-1,-44,-36,59
    \ 00023c ffd4dc3b
    \ 000240 29174343             .byte   41,23,67,67,59,43,113,113
    \ 000244 3b2b7171
    \ 000248 523b9f9f             .byte   82,59,-97,-97,105,74,-39,-81
    \ 00024c 694ad9af
    \ 000250 805df8f8             .byte   -128,93,-8,-8,-81,125,-1,-1
    \ 000254 af7dffff
    \ 000258 c5a6ffff             .byte   -59,-90,-1,-1,-1,-51,-1,50
    \ 00025c ffcdff32
    \ 000260 1c254949             .byte   28,37,73,73,50,52,99,99
    \ 000264 32346363
    \ 000268 474b7c7c             .byte   71,75,124,124,90,89,-104,122
    \ 00026c 5a59987a
    \ 000270 6e6facac             .byte   110,111,-84,-84,122,126,-63,-63
    \ 000274 7a7ec1c1
    \ 000278 7a8dd2d2             .byte   122,-115,-46,-46,124,-102,-27,8
    \ 00027c 7c9ae508
    \ 000280 00292020             .byte   0,41,32,32,8,79,47,47
    \ 000284 084f2f2f
    \ 000288 005d4949             .byte   0,93,73,73,8,115,97,38
    \ 00028c 08736126
    \ 000290 1e837c7c             .byte   30,-125,124,124,38,-102,-106,-106
    \ 000294 269a9696
    \ 000298 33aab4b4             .byte   51,-86,-76,-76,50,-52,-48,9
    \ 00029c 32ccd009
    \ 0002a0 002a6262             .byte   0,42,98,98,9,59,117,117
    \ 0002a4 093b7575
    \ 0002a8 124f8585             .byte   18,79,-123,-123,32,101,-98,57
    \ 0002ac 20659e39
    \ 0002b0 2e88baba             .byte   46,-120,-70,-70,57,-86,-47,-47
    \ 0002b4 39aad1d1
    \ 0002b8 4bd2e8e8             .byte   75,-46,-24,-24,79,-10,-1,85
    \ 0002bc 4ff6ff55
    \ 0002c0 3d232626             .byte   61,35,38,38,85,56,59,59
    \ 0002c4 55383b3b
    \ 0002c8 6f505656             .byte   111,80,86,86,110,104,117,-125
    \ 0002cc 6e687583
    \ 0002d0 7b7a9191             .byte   123,122,-111,-111,-125,-105,-77,-77
    \ 0002d4 8397b3b3
    \ 0002d8 8eafcfcf             .byte   -114,-81,-49,-49,-79,-33,-2,71
    \ 0002dc b1dffe47
    \ 0002e0 432c1d1d             .byte   67,44,29,29,71,61,46,-1
    \ 0002e4 473d2eff
    \ 0002e8 3c4d3939             .byte   60,77,57,57,51,95,76,45
    \ 0002ec 335f4c2d
    \ 0002f0 2c715858             .byte   44,113,88,88,45,-124,107,-59
    \ 0002f4 2d846bc5
    \ 0002f8 249e7878             .byte   36,-98,120,120,57,-67,127,58
    \ 0002fc 39bd7f3a
    \ 000300 23243737             .byte   35,36,55,55,58,57,83,83
    \ 000304 3a395353
    \ 000308 494c7878             .byte   73,76,120,120,79,93,-108,99
    \ 00030c 4f5d9463
    \ 000310 586da9a9             .byte   88,109,-87,-87,99,126,-65,-65
    \ 000314 637ebfbf
    \ 000318 7493d7d7             .byte   116,-109,-41,-41,-128,-93,-12,90
    \ 00031c 80a3f45a
    \ 000320 474b2d2d             .byte   71,75,45,45,90,101,71,71
    \ 000324 5a654747
    \ 000328 697b5b5b             .byte   105,123,91,91,125,-107,113,-106
    \ 00032c 7d957196
    \ 000330 8eae8787             .byte   -114,-82,-121,-121,-106,-63,-118,-118
    \ 000334 96c18a8a
    \ 000338 c1d1a9a9             .byte   -63,-47,-87,-87,-21,-6,-32,95
    \ 00033c ebfae05f
    \ 000340 401b0000             .byte   64,27,0,0,95,49,3,3
    \ 000344 5f310303
    \ 000348 7c480707             .byte   124,72,7,7,-94,93,16,-22
    \ 00034c a25d10ea
    \ 000350 c0761414             .byte   -64,118,20,20,-22,-105,64,64
    \ 000354 ea974040
    \ 000358 f1b15555             .byte   -15,-79,85,85,-1,-52,109,115
    \ 00035c ffcc6d73
    \ 000360 69475555             .byte   105,71,85,85,115,93,118,118
    \ 000364 735d7676
    \ 000368 88749797             .byte   -120,116,-105,-105,-109,-116,-71,-99
    \ 00036c 938cb99d
    \ 000370 9aa3d5d5             .byte   -102,-93,-43,-43,-99,-67,-21,-21
    \ 000374 9dbdebeb
    \ 000378 9bd5ffff             .byte   -101,-43,-1,-1,-122,-9,-3,81
    \ 00037c 86f7fd51
    \ 000380 211d1d1d             .byte   33,29,29,29,81,49,60,60
    \ 000384 51313c3c
    \ 000388 7f4a5858             .byte   127,74,88,88,-70,100,121,-20
    \ 00038c ba6479ec
    \ 000390 f1859595             .byte   -15,-123,-107,-107,-20,-106,-87,-87
    \ 000394 ec96a9a9
    \ 000398 f7abbaba             .byte   -9,-85,-70,-70,-2,-67,-47,93
    \ 00039c febdd15d
    \ 0003a0 50242626             .byte   80,36,38,38,93,51,40,40
    \ 0003a4 5d332828
    \ 0003a8 723d2d2d             .byte   114,61,45,45,-125,80,61,-59
    \ 0003ac 83503dc5
    \ 0003b0 ae655151             .byte   -82,101,81,81,-59,116,82,82
    \ 0003b4 c5745252
    \ 0003b8 c4826c6c             .byte   -60,-126,108,108,-61,-109,-125,74
    \ 0003bc c393834a
    \ 0003c0 29214949             .byte   41,33,73,73,74,65,94,94
    \ 0003c4 4a415e5e
    \ 0003c8 5b537777             .byte   91,83,119,119,106,96,-111,-108
    \ 0003cc 6a609194
    \ 0003d0 8479adad             .byte   -124,121,-83,-83,-108,-117,-75,-75
    \ 0003d4 948bb5b5
    \ 0003d8 aaaed4d4             .byte   -86,-82,-44,-44,-49,-30,-1,39
    \ 0003dc cfe2ff27
    \ 0003e0 031c7272             .byte   3,28,114,114,39,51,-100,-100
    \ 0003e4 27339c9c
    \ 0003e8 3e5abfbf             .byte   62,90,-65,-65,39,-122,-23,5
    \ 0003ec 2786e905
    \ 0003f0 08b1ffff             .byte   8,-79,-1,-1,5,-49,-1,-1
    \ 0003f4 05cfffff
    \ 0003f8 2bf0ffff             .byte   43,-16,-1,-1,-1,-1,-1,65
    \ 0003fc ffffff41
0286                  
0287                  int vickyPaletteCol (uint8_t palette, uint8_t index, uint8_t red, uint8_t green, uint8_t blue, uint8_t alpha)
0288                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public vickyPaletteCol
    \ 000000          vickyPaletteCol:
    \ 000000 5a                   phy
    \ 000001 5a                   phy
    \ 000002 e220                 sep     #32
    \ 000004 8301                 sta     1,s
    \ 000006 c220                 rep     #32
0289                  	uint8_t __far *ptr;
0290                  // select palette address
0291                  	switch (palette)
    \ 000008 a301                 lda     1,s
    \ 00000a 29ff00               and     ##255
    \ 00000d 8302                 sta     2,s
    \ 00000f a90700               lda     ##7
    \ 000012 c302                 cmp     2,s
    \ 000014 b003                 bcs     `?L1506`
    \ 000016 4c....               jmp     .kbank `?L93`
    \ 000019 a302     `?L1506`:   lda     2,s
    \ 00001b 0a                   asl     a
    \ 00001c aa                   tax
    \ 00001d bf......             lda     long:`?L475`,x
    \ 000021 48                   pha
    \ 000022 60                   rts
    \ 000023          `?L94`:
0292                  	{
0293                  	case 0:
0294                  		ptr= (long)GRPH_LUT0_LONG +(index*4);
0295                  		// set rgb components at palette address
0296                  		*(ptr+2)= red; // red
0297                  		*(ptr+1)= green; // green
0298                  		*(ptr)=   blue; // blue 
0299                  		*(ptr+3)= alpha; // alpha
0300                  		break;
0301                  	case 1:
0302                  		ptr= (long)GRPH_LUT1_LONG +(index*4);
0303                  		//printf ("ptr:%lx r:%d g:%d b:%d a:%d \r",ptr, palette[vi], palette[vi+1], palette[vi+2], palette[vi+3]);
0304                  		// set rgb components at palette address
0305                  		*(ptr+2)= red; // red
0306                  		*(ptr+1)= green; // green
0307                  		*(ptr)=   blue; // blue 
0308                  		*(ptr+3)= alpha; // alpha
0309                  		break;
0310                  	case 2:
0311                  		ptr= (long)GRPH_LUT2_LONG +(index*4);
0312                  		//printf ("ptr:%lx r:%d g:%d b:%d a:%d \r",ptr, palette[vi], palette[vi+1], palette[vi+2], palette[vi+3]);
0313                  		// set rgb components at palette address
0314                  		*(ptr+2)= red; // red
0315                  		*(ptr+1)= green; // green
0316                  		*(ptr)=   blue; // blue 
0317                  		*(ptr+3)= alpha; // alpha
0318                  		break;
0319                  	case 3:
0320                  		ptr= (long)GRPH_LUT3_LONG +(index*4);
0321                  		//printf ("ptr:%lx r:%d g:%d b:%d a:%d \r",ptr, palette[vi], palette[vi+1], palette[vi+2], palette[vi+3]);
0322                  		// set rgb components at palette address
0323                  		*(ptr+2)= red; // red
0324                  		*(ptr+1)= green; // green
0325                  		*(ptr)=   blue; // blue 
0326                  		*(ptr+3)= alpha; // alpha
0327                  		break;
0328                  	case 4:
0329                  		ptr= (long)GRPH_LUT4_LONG +(index*4);
0330                  		//printf ("ptr:%lx r:%d g:%d b:%d a:%d \r",ptr, palette[vi], palette[vi+1], palette[vi+2], palette[vi+3]);
0331                  		// set rgb components at palette address
0332                  		*(ptr+2)= red; // red
0333                  		*(ptr+1)= green; // green
0334                  		*(ptr)=   blue; // blue 
0335                  		*(ptr+3)= alpha; // alpha
0336                  		break;
0337                  	case 5:
0338                  		ptr= (long)GRPH_LUT5_LONG +(index*4);
0339                  		//printf ("ptr:%lx r:%d g:%d b:%d a:%d \r",ptr, palette[vi], palette[vi+1], palette[vi+2], palette[vi+3]);
0340                  		// set rgb components at palette address
0341                  		*(ptr+2)= red; // red
0342                  		*(ptr+1)= green; // green
0343                  		*(ptr)=   blue; // blue 
0344                  		*(ptr+3)= alpha; // alpha
0345                  		break;
0346                  	case 6:
0347                  		ptr= (long)GRPH_LUT6_LONG +(index*4);
0348                  		//printf ("ptr:%lx r:%d g:%d b:%d a:%d \r",ptr, palette[vi], palette[vi+1], palette[vi+2], palette[vi+3]);
0349                  		// set rgb components at palette address
0350                  		*(ptr+2)= red; // red
0351                  		*(ptr+1)= green; // green
0352                  		*(ptr)=   blue; // blue 
0353                  		*(ptr+3)= alpha; // alpha
0354                  		break;
0355                  	case 7:
0356                  		ptr= (long)GRPH_LUT7_LONG +(index*4);
    \ 000023 22......             jsl     long:`?L1284`
    \ 000027 1001                 bpl     `?L541`
    \ 000029 ca                   dex
    \ 00002a 18       `?L541`:    clc
    \ 00002b 69003c               adc     ##15360
0357                  		//printf ("ptr:%lx r:%d g:%d b:%d a:%d \r",ptr, palette[vi], palette[vi+1], palette[vi+2], palette[vi+3]);
0358                  		// set rgb components at palette address
0359                  		*(ptr+2)= red; // red
0360                  		*(ptr+1)= green; // green
0361                  		*(ptr)=   blue; // blue 
0362                  		*(ptr+3)= alpha; // alpha
0363                  		break;
    \ 00002e 8059                 bra     `?L1234`
    \ 000030          `?L95`:
    \ 000030 22......             jsl     long:`?L1284`
    \ 000034 1001                 bpl     `?L543`
    \ 000036 ca                   dex
    \ 000037 18       `?L543`:    clc
    \ 000038 690038               adc     ##14336
    \ 00003b 804c                 bra     `?L1234`
    \ 00003d          `?L96`:
    \ 00003d 22......             jsl     long:`?L1284`
    \ 000041 1001                 bpl     `?L545`
    \ 000043 ca                   dex
    \ 000044 18       `?L545`:    clc
    \ 000045 690034               adc     ##13312
    \ 000048 803f                 bra     `?L1234`
    \ 00004a          `?L97`:
    \ 00004a 22......             jsl     long:`?L1284`
    \ 00004e 1001                 bpl     `?L547`
    \ 000050 ca                   dex
    \ 000051 18       `?L547`:    clc
    \ 000052 690030               adc     ##12288
    \ 000055 8032                 bra     `?L1234`
    \ 000057          `?L98`:
    \ 000057 22......             jsl     long:`?L1284`
    \ 00005b 1001                 bpl     `?L549`
    \ 00005d ca                   dex
    \ 00005e 18       `?L549`:    clc
    \ 00005f 69002c               adc     ##11264
    \ 000062 8025                 bra     `?L1234`
    \ 000064          `?L99`:
    \ 000064 22......             jsl     long:`?L1284`
    \ 000068 1001                 bpl     `?L551`
    \ 00006a ca                   dex
    \ 00006b 18       `?L551`:    clc
    \ 00006c 690028               adc     ##10240
    \ 00006f 8018                 bra     `?L1234`
    \ 000071          `?L100`:
    \ 000071 22......             jsl     long:`?L1284`
    \ 000075 1001                 bpl     `?L553`
    \ 000077 ca                   dex
    \ 000078 18       `?L553`:    clc
    \ 000079 690024               adc     ##9216
    \ 00007c 800b                 bra     `?L1234`
    \ 00007e          `?L101`:
    \ 00007e 22......             jsl     long:`?L1284`
    \ 000082 1001                 bpl     `?L555`
    \ 000084 ca                   dex
    \ 000085 18       `?L555`:    clc
    \ 000086 690020               adc     ##8192
    \ 000089 48       `?L1234`:   pha
    \ 00008a 8a                   txa
    \ 00008b 69af00               adc     ##175
    \ 00008e aa                   tax
    \ 00008f 68                   pla
    \ 000090 86..                 stx     dp:.tiny (_Dp+2)
    \ 000092 85..                 sta     dp:.tiny _Dp
    \ 000094 e220                 sep     #32
    \ 000096 a30a                 lda     10,s
    \ 000098 a00200               ldy     ##2
    \ 00009b 97..                 sta     [.tiny _Dp],y
    \ 00009d a30c                 lda     12,s
    \ 00009f 88                   dey
    \ 0000a0 97..                 sta     [.tiny _Dp],y
    \ 0000a2 a30e                 lda     14,s
    \ 0000a4 87..                 sta     [.tiny _Dp]
    \ 0000a6 a310                 lda     16,s
    \ 0000a8 22......             jsl     long:`?L1351`
0364                  	default:
0365                  		// LUT table out of bounds (0-7)
0366                  		return -1;
0367                  	}
0368                  	return 0;
    \ 0000ac a90000               lda     ##0
    \ 0000af 8003                 bra     `?L90`
    \ 0000b1 a9ffff   `?L93`:     lda     ##-1
    \ 0000b4          `?L90`:
0369                  }
    \ 0000b4 7a                   ply
    \ 0000b5 7a                   ply
    \ 0000b6 6b                   rtl
0370                  
0371                  // int vickyBackCol (uint8_t palette, uint8_t index, uint8_t red, uint8_t green, uint8_t blue, uint8_t alpha)
0372                  // int vickyBorderCol (uint8_t palette, uint8_t index, uint8_t red, uint8_t green, uint8_t blue, uint8_t alpha)
0373                  
0374                  
0375                  // -------------------------------------------------------------------
0376                  // Simple Read VRAM address by Ernesto Contreras
0377                  // Required for getPixel
0378                  // -------------------------------------------------------------------
0379                  static inline uint8_t __read_vram (uint8_t volatile __far *p) {
0380                    // Force clear of FIFO
0381                    VMEM2CPU_CTRL_REG = VMEM2CPU_Clear_FIFO;
0382                    VMEM2CPU_CTRL_REG = 0;
0383                  	// Wait for Buffer to be clear
0384                  	while (__fifo_count > 0)
0385                  	;
0386                  	*p;  // dummy read
0387                  // Wait for fifo buffer 
0388                  	while (__fifo_count == 0) 
0389                  	;
0390                    return __byte_port;
0391                  }
0392                  
0393                  // -------------------------------------------------------------------
0394                  // Read VRAM Buffer Implementation 
0395                  // thx to hth313 - Calypsi creator for his support!
0396                  // Required for getScanLine
0397                  // -------------------------------------------------------------------
0398                   int read_vram_buffer (uint8_t volatile __far *p, int length, uint8_t __far *buffer) 
0399                   {
    \ 000000                      .section farcode,text
    \ 000000                      .public read_vram_buffer
    \ 000000          read_vram_buffer:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 5a                   phy
    \ 000003 5a                   phy
    \ 000004 8301                 sta     1,s
0400                  	int i; 
0401                  	VMEM2CPU_CTRL_REG = VMEM2CPU_Clear_FIFO; // clear fifo before reading data
0402                  	VMEM2CPU_CTRL_REG = 0;
0403                  	// Wait for fifo clear
0404                  	if (__fifo_count>0)
    \ 000006 22......             jsl     long:`?L1302`
    \ 00000a 1a                   inc     a
    \ 00000b 3a                   dec     a
    \ 00000c 38                   sec
    \ 00000d ef0209af             sbc     long:11471106
    \ 000011 5003                 bvc     `?L557`
    \ 000013 490080               eor     ##-32768
    \ 000016 100b     `?L557`:    bpl     `?L126`
    \ 000018          `?L128`:
0405                  		while (__fifo_count>0)
    \ 000018 22......             jsl     long:`?L1331`
    \ 00001c 5003                 bvc     `?L559`
    \ 00001e 490080               eor     ##-32768
    \ 000021 30f5     `?L559`:    bmi     `?L128`
    \ 000023          `?L126`:
0406                  		;
0407                  // Ask for as may bytes as the value - length
0408                  	i=0;
    \ 000023 a90000               lda     ##0
0409                     while (i<length)
    \ 000026 8303                 sta     3,s
    \ 000028 a303     `?L131`:    lda     3,s
    \ 00002a 38                   sec
    \ 00002b e301                 sbc     1,s
    \ 00002d 5003                 bvc     `?L561`
    \ 00002f 490080               eor     ##-32768
    \ 000032 1011     `?L561`:    bpl     `?L134`
0410                    {
0411                  	*p;  		// dummy read
    \ 000034 e220                 sep     #32
    \ 000036 a7..                 lda     [.tiny _Dp]
    \ 000038 c220                 rep     #32
0412                  	i++;		// increment pixel request counter
    \ 00003a a303                 lda     3,s
    \ 00003c 1a                   inc     a
    \ 00003d 8303                 sta     3,s
0413                  	p++;		// increment VRAM pointer
    \ 00003f e6..                 inc     dp:.tiny _Dp
    \ 000041 a303                 lda     3,s
    \ 000043 80e3                 bra     `?L131`
    \ 000045          `?L134`:
0414                    }
0415                  // Wait for fifo buffer 
0416                  	while (__fifo_count == 00)
    \ 000045 af0209af             lda     long:11471106
    \ 000049 f0fa                 beq     `?L134`
0417                  	;
0418                  	i=0;
    \ 00004b a20000               ldx     ##0
    \ 00004e          `?L137`:
0419                  // Move lenght number of bytes into array
0420                  	while (__fifo_count > 0) 
    \ 00004e 22......             jsl     long:`?L1331`
    \ 000052 5003                 bvc     `?L563`
    \ 000054 490080               eor     ##-32768
    \ 000057 101d     `?L563`:    bpl     `?L138`
0421                  	  *(buffer+(i++)) = __byte_port;
    \ 000059 9b                   txy
    \ 00005a 8a                   txa
    \ 00005b 1a                   inc     a
    \ 00005c aa                   tax
    \ 00005d 22......             jsl     long:`?L1332`
    \ 000061 84..                 sty     dp:.tiny (_Dp+8)
    \ 000063 18                   clc
    \ 000064 a5..                 lda     dp:.tiny _Dp
    \ 000066 65..                 adc     dp:.tiny (_Dp+8)
    \ 000068 85..                 sta     dp:.tiny _Dp
    \ 00006a e220                 sep     #32
    \ 00006c af0109af             lda     long:11471105
    \ 000070 87..                 sta     [.tiny _Dp]
    \ 000072 c220                 rep     #32
    \ 000074 80d8                 bra     `?L137`
    \ 000076          `?L138`:
0422                     
0423                  	VMEM2CPU_CTRL_REG = VMEM2CPU_Clear_FIFO; // clear fifo before reading data
0424                  	VMEM2CPU_CTRL_REG = 0;
0425                  	return i;
    \ 000076 22......             jsl     long:`?L1302`
    \ 00007a 8a                   txa
0426                  }
    \ 00007b 7a                   ply
    \ 00007c 7a                   ply
    \ 00007d 7a                   ply
    \ 00007e 84..                 sty     dp:.tiny (_Dp+8)
    \ 000080 6b                   rtl
0427                  
0428                  
0429                  // -----------------------------------------------------
0430                  // Simple getPixel Implementation by Ernesto Contreras
0431                  // -----------------------------------------------------
0432                  int getPixel (int x, int y) {
    \ 000000                      .section farcode,text
    \ 000000                      .public getPixel
    \ 000000          getPixel:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 5a                   phy
    \ 000005 5a                   phy
    \ 000006 8301                 sta     1,s
    \ 000008 a5..                 lda     dp:.tiny _Dp
    \ 00000a 8303                 sta     3,s
0433                  	void __far *ptr;
0434                  	uint8_t byte, length;
0435                      if (vBitPlane[vickyBitmapPage]) // if Bitmap for the page is enabled
    \ 00000c 22......             jsl     long:`?L1321`
    \ 000010 d003                 bne     `?L1507`
    \ 000012 4c....               jmp     .kbank `?L145`
    \ 000015          `?L1507`:
0436                  	{
0437                  		// check screen Boundaries
0438                  		if (x<vickyResX && y<vickyResY)
    \ 000015 a20000               ldx     ##0
    \ 000018 a301                 lda     1,s
    \ 00001a 1001                 bpl     `?L565`
    \ 00001c ca                   dex
    \ 00001d          `?L565`:
    \ 00001d 22......             jsl     long:`?L1313`
    \ 000021 5003                 bvc     `?L567`
    \ 000023 490080               eor     ##-32768
    \ 000026 106e     `?L567`:    bpl     `?L145`
    \ 000028 a20000               ldx     ##0
    \ 00002b a303                 lda     3,s
    \ 00002d 1001                 bpl     `?L569`
    \ 00002f ca                   dex
    \ 000030          `?L569`:
    \ 000030 22......             jsl     long:`?L1326`
    \ 000034 5003                 bvc     `?L571`
    \ 000036 490080               eor     ##-32768
    \ 000039 105b     `?L571`:    bpl     `?L145`
0439                  		{
0440                  			ptr = (void *)(0xb00000+x+y*vickyResX);
    \ 00003b a301                 lda     1,s
    \ 00003d a20000               ldx     ##0
    \ 000040 a8                   tay
    \ 000041 1001                 bpl     `?L573`
    \ 000043 ca                   dex
    \ 000044 18       `?L573`:    clc
    \ 000045 690000               adc     ##0
    \ 000048 48                   pha
    \ 000049 22......             jsl     long:`?L1336`
    \ 00004d 68                   pla
    \ 00004e 86..                 stx     dp:.tiny (_Dp+10)
    \ 000050 85..                 sta     dp:.tiny (_Dp+8)
    \ 000052 a303                 lda     3,s
    \ 000054 a20000               ldx     ##0
    \ 000057 a8                   tay
    \ 000058 1001                 bpl     `?L575`
    \ 00005a ca                   dex
    \ 00005b          `?L575`:
    \ 00005b 22......             jsl     long:`?L1275`
    \ 00005f 65..                 adc     dp:.tiny (_Dp+8)
    \ 000061 48                   pha
    \ 000062 8a                   txa
    \ 000063 65..                 adc     dp:.tiny (_Dp+10)
    \ 000065 68                   pla
    \ 000066 85..                 sta     dp:.tiny _Dp
    \ 000068 64..                 stz     dp:.tiny (_Dp+2)
0441                  			ptr+= (long) bitplane[vickyBitmapPage].start;
    \ 00006a a6..                 ldx     dp:.tiny (_Dp+2)
    \ 00006c a5..                 lda     dp:.tiny _Dp
0442                  			return __read_vram (ptr);
    \ 00006e 86..                 stx     dp:.tiny (_Dp+2)
    \ 000070 85..                 sta     dp:.tiny _Dp
    \ 000072 22......             jsl     long:`?L1302`
    \ 000076          `?L506`:
    \ 000076 22......             jsl     long:`?L1331`
    \ 00007a 5003                 bvc     `?L578`
    \ 00007c 490080               eor     ##-32768
    \ 00007f 30f5     `?L578`:    bmi     `?L506`
    \ 000081 e220                 sep     #32
    \ 000083 a7..                 lda     [.tiny _Dp]
    \ 000085 c220                 rep     #32
    \ 000087 af0209af `?L509`:    lda     long:11471106
    \ 00008b f0fa                 beq     `?L509`
    \ 00008d af0109af             lda     long:11471105
    \ 000091 29ff00               and     ##255
    \ 000094 8003                 bra     `?L143`
    \ 000096          `?L145`:
0443                  		}
0444                  	}
0445                  	return -1;
    \ 000096 a9ffff               lda     ##-1
    \ 000099          `?L143`:
0446                  }
    \ 000099 7a                   ply
    \ 00009a 7a                   ply
    \ 00009b 5c......             jmp     long:`?L185`
0447                  
0448                  // -----------------------------------------------------
0449                  // Simple getScanLine Implementation by Ernesto Contreras
0450                  // Results in pixBuffer[]
0451                  // -----------------------------------------------------
0452                  int getScanLine (int y, uint8_t __far *buffer) {
    \ 000000                      .section farcode,text
    \ 000000                      .public getScanLine
    \ 000000          getScanLine:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 d4..                 pei     dp:.tiny (_Dp+12)
    \ 000006 d4..                 pei     dp:.tiny (_Dp+14)
    \ 000008 a8                   tay
    \ 000009 3b                   tsc
    \ 00000a 38                   sec
    \ 00000b e91000               sbc     ##16
    \ 00000e 1b                   tcs
    \ 00000f 98                   tya
    \ 000010 830d                 sta     13,s
    \ 000012 a5..                 lda     dp:.tiny _Dp
    \ 000014 85..                 sta     dp:.tiny (_Dp+12)
    \ 000016 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000018 85..                 sta     dp:.tiny (_Dp+14)
0453                  	void __far *ptr,*ptr2;
0454                  	int st,length, length2, length3, bank;
0455                      if (vBitPlane[vickyBitmapPage]) // if Bitmap for the page is enabled
    \ 00001a 22......             jsl     long:`?L1321`
    \ 00001e f009                 beq     `?L155`
0456                  	
0457                  	// initialize variables 
0458                  	st=0;
    \ 000020 a90000               lda     ##0
    \ 000023 8301                 sta     1,s
    \ 000025 8301                 sta     1,s
    \ 000027 8002                 bra     `?L156`
    \ 000029 a301     `?L155`:    lda     1,s
    \ 00002b          `?L156`:
0459                  	// check screen Boundaries
0460                  	if (y<vickyResY)
    \ 00002b a20000               ldx     ##0
    \ 00002e a30d                 lda     13,s
    \ 000030 1001                 bpl     `?L580`
    \ 000032 ca                   dex
    \ 000033          `?L580`:
    \ 000033 22......             jsl     long:`?L1326`
    \ 000037 5003                 bvc     `?L582`
    \ 000039 490080               eor     ##-32768
    \ 00003c 3003     `?L582`:    bmi     `?L1508`
    \ 00003e 4c....               jmp     .kbank `?L158`
    \ 000041          `?L1508`:
0461                  	{
0462                  		ptr = (0xb00000+y*vickyResX); // calculate position of scanline in Memory
    \ 000041 22......             jsl     long:`?L1346`
    \ 000045 1001                 bpl     `?L584`
    \ 000047 ca                   dex
    \ 000048          `?L584`:
    \ 000048 22......             jsl     long:`?L1275`
    \ 00004c 690000               adc     ##0
    \ 00004f 48                   pha
0463                  		ptr+= (long) bitplane[vickyBitmapPage].start;
0464                  		length = vickyResX; // read as many bytes as current vickyResX
0465                  		if (((long)ptr & 0xff0000)==((long)ptr+length & 0xff0000))
    \ 000050 22......             jsl     long:`?L1336`
    \ 000054 68                   pla
    \ 000055 86..                 stx     dp:.tiny (_Dp+10)
    \ 000057 85..                 sta     dp:.tiny (_Dp+8)
    \ 000059 ad....               lda     vickyResX
    \ 00005c 830f                 sta     15,s
    \ 00005e a5..                 lda     dp:.tiny (_Dp+10)
    \ 000060 29ff00               and     ##255
    \ 000063 aa                   tax
    \ 000064 a5..                 lda     dp:.tiny (_Dp+8)
    \ 000066 290000               and     ##0
    \ 000069 86..                 stx     dp:.tiny (_Dp+2)
    \ 00006b 85..                 sta     dp:.tiny _Dp
    \ 00006d a30f                 lda     15,s
    \ 00006f a20000               ldx     ##0
    \ 000072 a8                   tay
    \ 000073 1001                 bpl     `?L587`
    \ 000075 ca                   dex
    \ 000076 18       `?L587`:    clc
    \ 000077 65..                 adc     dp:.tiny (_Dp+8)
    \ 000079 48                   pha
    \ 00007a 8a                   txa
    \ 00007b 65..                 adc     dp:.tiny (_Dp+10)
    \ 00007d aa                   tax
    \ 00007e 68                   pla
    \ 00007f 86..                 stx     dp:.tiny (_Dp+6)
    \ 000081 85..                 sta     dp:.tiny (_Dp+4)
    \ 000083 a5..                 lda     dp:.tiny (_Dp+6)
    \ 000085 29ff00               and     ##255
    \ 000088 aa                   tax
    \ 000089 a5..                 lda     dp:.tiny (_Dp+4)
    \ 00008b 290000               and     ##0
    \ 00008e 86..                 stx     dp:.tiny (_Dp+6)
    \ 000090 85..                 sta     dp:.tiny (_Dp+4)
    \ 000092 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000094 c5..                 cmp     dp:.tiny _Dp
    \ 000096 d053                 bne     `?L161`
    \ 000098 a5..                 lda     dp:.tiny (_Dp+6)
    \ 00009a c5..                 cmp     dp:.tiny (_Dp+2)
    \ 00009c d04d                 bne     `?L161`
0466                  		// Test if bytes requested from FIFO cross a 64k Bank boundary
0467                  		{
0468                  			// of course they dont!
0469                  			while (st<length)
    \ 00009e a301                 lda     1,s
    \ 0000a0 a301     `?L164`:    lda     1,s
    \ 0000a2 38                   sec
    \ 0000a3 e30f                 sbc     15,s
    \ 0000a5 5003                 bvc     `?L590`
    \ 0000a7 490080               eor     ##-32768
    \ 0000aa 3003     `?L590`:    bmi     `?L1509`
    \ 0000ac 4c....               jmp     .kbank `?L162`
    \ 0000af          `?L1509`:
0470                  			{
0471                  				st = read_vram_buffer(ptr, length, buffer);
    \ 0000af a5..                 lda     dp:.tiny (_Dp+12)
    \ 0000b1 85..                 sta     dp:.tiny (_Dp+4)
    \ 0000b3 a5..                 lda     dp:.tiny (_Dp+14)
    \ 0000b5 85..                 sta     dp:.tiny (_Dp+6)
    \ 0000b7 22......             jsl     long:`?L1285`
    \ 0000bb a30f                 lda     15,s
    \ 0000bd 22......             jsl     long:read_vram_buffer
    \ 0000c1 8301                 sta     1,s
0472                  				if (st<length)
    \ 0000c3 a301                 lda     1,s
    \ 0000c5 38                   sec
    \ 0000c6 e30f                 sbc     15,s
    \ 0000c8 5003                 bvc     `?L593`
    \ 0000ca 490080               eor     ##-32768
    \ 0000cd 1018     `?L593`:    bpl     `?L168`
0473                  				{
0474                  					// recalculate all pointers and lengths for a retry
0475                  					ptr = (0xb00000+y*vickyResX); // calculate position of scanline in Memory
    \ 0000cf 22......             jsl     long:`?L1346`
    \ 0000d3 1001                 bpl     `?L595`
    \ 0000d5 ca                   dex
    \ 0000d6          `?L595`:
    \ 0000d6 22......             jsl     long:`?L1275`
    \ 0000da 690000               adc     ##0
    \ 0000dd 48                   pha
    \ 0000de 22......             jsl     long:`?L1336`
    \ 0000e2 68                   pla
    \ 0000e3 86..                 stx     dp:.tiny (_Dp+10)
    \ 0000e5 85..                 sta     dp:.tiny (_Dp+8)
    \ 0000e7 a301     `?L168`:    lda     1,s
    \ 0000e9 80b5                 bra     `?L164`
    \ 0000eb          `?L161`:
0476                  					ptr+= (long) bitplane[vickyBitmapPage].start;
0477                  				}
0478                  			}
0479                  		}
0480                  		else
0481                  		// Ooops this byte group just crossed the line!, let's do something about it! 
0482                  		// Let's do a FIFO request for the group of bytes in each bank
0483                  		{
0484                  			// Calculate boundaries for both FIFO requests
0485                  			bank=(long)(ptr+length) & (0xff0000);
    \ 0000eb a90000               lda     ##0
    \ 0000ee 8301                 sta     1,s
0486                  			length2=(bank-0x10000)-(long)ptr-1; // calculate number of bytes to reach end of bank
    \ 0000f0 38                   sec
    \ 0000f1 e5..                 sbc     dp:.tiny (_Dp+8)
    \ 0000f3 3a                   dec     a
    \ 0000f4 8309                 sta     9,s
0487                  			length3=vickyResX-length2;
    \ 0000f6 ad....               lda     vickyResX
    \ 0000f9 38                   sec
    \ 0000fa e309                 sbc     9,s
    \ 0000fc 8301                 sta     1,s
0488                  			ptr2=(long)ptr+length & 0xff0000;
    \ 0000fe a30f                 lda     15,s
    \ 000100 a20000               ldx     ##0
    \ 000103 a8                   tay
    \ 000104 1001                 bpl     `?L598`
    \ 000106 ca                   dex
    \ 000107 18       `?L598`:    clc
    \ 000108 65..                 adc     dp:.tiny (_Dp+8)
    \ 00010a 48                   pha
    \ 00010b 8a                   txa
    \ 00010c 65..                 adc     dp:.tiny (_Dp+10)
    \ 00010e aa                   tax
    \ 00010f 68                   pla
    \ 000110 86..                 stx     dp:.tiny (_Dp+2)
    \ 000112 85..                 sta     dp:.tiny _Dp
    \ 000114 a9ff00               lda     ##255
    \ 000117 25..                 and     dp:.tiny (_Dp+2)
    \ 000119 48                   pha
    \ 00011a a90000               lda     ##0
    \ 00011d 25..                 and     dp:.tiny _Dp
    \ 00011f 8307                 sta     7,s
    \ 000121 68                   pla
    \ 000122 8307                 sta     7,s
0489                  			// FIFO for 1st Bank
0490                  			st=0;
    \ 000124 a90000               lda     ##0
    \ 000127 8303                 sta     3,s
0491                  			while (st<length2)
    \ 000129 8303                 sta     3,s
    \ 00012b a309                 lda     9,s
    \ 00012d a303     `?L170`:    lda     3,s
    \ 00012f 38                   sec
    \ 000130 e309                 sbc     9,s
    \ 000132 5003                 bvc     `?L600`
    \ 000134 490080               eor     ##-32768
    \ 000137 1053     `?L600`:    bpl     `?L171`
0492                  			{
0493                  				st = read_vram_buffer(ptr, length2, buffer);
    \ 000139 a5..                 lda     dp:.tiny (_Dp+12)
    \ 00013b 85..                 sta     dp:.tiny (_Dp+4)
    \ 00013d a5..                 lda     dp:.tiny (_Dp+14)
    \ 00013f 85..                 sta     dp:.tiny (_Dp+6)
    \ 000141 22......             jsl     long:`?L1285`
    \ 000145 a309                 lda     9,s
    \ 000147 22......             jsl     long:read_vram_buffer
    \ 00014b 830b                 sta     11,s
0494                  				if (st<length2)
    \ 00014d a30b                 lda     11,s
    \ 00014f 38                   sec
    \ 000150 e309                 sbc     9,s
    \ 000152 5003                 bvc     `?L603`
    \ 000154 490080               eor     ##-32768
    \ 000157 1029     `?L603`:    bpl     `?L173`
0495                  				{
0496                  					// recalculate all pointers and lengths for a retry
0497                  					ptr = (0xb00000+y*vickyResX); // calculate position of scanline in Memory
    \ 000159 22......             jsl     long:`?L1346`
    \ 00015d 1001                 bpl     `?L605`
    \ 00015f ca                   dex
    \ 000160          `?L605`:
    \ 000160 22......             jsl     long:`?L1275`
    \ 000164 690000               adc     ##0
    \ 000167 48                   pha
    \ 000168 22......             jsl     long:`?L1336`
    \ 00016c 68                   pla
    \ 00016d 86..                 stx     dp:.tiny (_Dp+10)
    \ 00016f 85..                 sta     dp:.tiny (_Dp+8)
0498                  					ptr+= (long) bitplane[vickyBitmapPage].start;
0499                  					bank=(long)(ptr+length) & (0xff0000);
    \ 000171 a90000               lda     ##0
    \ 000174 8303                 sta     3,s
0500                  					length2=(bank-0x10000)-(long)ptr-1; // calculate number of bytes to reach end of bank
    \ 000176 38                   sec
    \ 000177 e5..                 sbc     dp:.tiny (_Dp+8)
    \ 000179 3a                   dec     a
    \ 00017a 8303                 sta     3,s
    \ 00017c a303                 lda     3,s
    \ 00017e 8309                 sta     9,s
    \ 000180 8002                 bra     `?L174`
    \ 000182 a309     `?L173`:    lda     9,s
    \ 000184 a30b     `?L174`:    lda     11,s
    \ 000186 8303                 sta     3,s
    \ 000188 a309                 lda     9,s
    \ 00018a 80a1                 bra     `?L170`
    \ 00018c          `?L171`:
0501                  				}
0502                  			}
0503                  
0504                  			//FIFO for 2nd Bank
0505                  			st=0;
    \ 00018c a90000               lda     ##0
    \ 00018f 8303                 sta     3,s
0506                  			while (st<length3)
    \ 000191 a307                 lda     7,s
    \ 000193 85..                 sta     dp:.tiny (_Dp+10)
    \ 000195 a305                 lda     5,s
    \ 000197 85..                 sta     dp:.tiny (_Dp+8)
    \ 000199 a309                 lda     9,s
    \ 00019b 8305                 sta     5,s
    \ 00019d a301                 lda     1,s
    \ 00019f a303     `?L176`:    lda     3,s
    \ 0001a1 38                   sec
    \ 0001a2 e301                 sbc     1,s
    \ 0001a4 5003                 bvc     `?L608`
    \ 0001a6 490080               eor     ##-32768
    \ 0001a9 107d     `?L608`:    bpl     `?L162`
0507                  			{
0508                  				st = read_vram_buffer(ptr2, length3, (void *)(buffer+length2+1));
    \ 0001ab a5..                 lda     dp:.tiny (_Dp+12)
    \ 0001ad 1a                   inc     a
    \ 0001ae 18                   clc
    \ 0001af 6305                 adc     5,s
    \ 0001b1 85..                 sta     dp:.tiny (_Dp+4)
    \ 0001b3 64..                 stz     dp:.tiny (_Dp+6)
    \ 0001b5 22......             jsl     long:`?L1285`
    \ 0001b9 a301                 lda     1,s
    \ 0001bb 22......             jsl     long:read_vram_buffer
    \ 0001bf 8303                 sta     3,s
0509                  				if (st<length3)
    \ 0001c1 a303                 lda     3,s
    \ 0001c3 38                   sec
    \ 0001c4 e301                 sbc     1,s
    \ 0001c6 5003                 bvc     `?L611`
    \ 0001c8 490080               eor     ##-32768
    \ 0001cb 1054     `?L611`:    bpl     `?L179`
0510                  				{
0511                  					// recalculate all pointers and lengths for a retry
0512                  					ptr = (0xb00000+y*vickyResX); // calculate position of scanline in Memory
    \ 0001cd 22......             jsl     long:`?L1346`
    \ 0001d1 1001                 bpl     `?L613`
    \ 0001d3 ca                   dex
    \ 0001d4          `?L613`:
    \ 0001d4 22......             jsl     long:`?L1275`
    \ 0001d8 690000               adc     ##0
    \ 0001db 48                   pha
0513                  					ptr+= (long) bitplane[vickyBitmapPage].start;
0514                  					bank=(long)(ptr+length) & (0xff0000);
0515                  					length2=(bank-0x10000)-(long)ptr-1; // calculate number of bytes to reach end of bank
0516                  					length3=vickyResX-length2;
0517                  					ptr2=(long)ptr+length & 0xff0000;
    \ 0001dc 22......             jsl     long:`?L1336`
    \ 0001e0 68                   pla
    \ 0001e1 86..                 stx     dp:.tiny (_Dp+2)
    \ 0001e3 85..                 sta     dp:.tiny _Dp
    \ 0001e5 a90000               lda     ##0
    \ 0001e8 8301                 sta     1,s
    \ 0001ea 38                   sec
    \ 0001eb e5..                 sbc     dp:.tiny _Dp
    \ 0001ed 3a                   dec     a
    \ 0001ee 8305                 sta     5,s
    \ 0001f0 ad....               lda     vickyResX
    \ 0001f3 38                   sec
    \ 0001f4 e305                 sbc     5,s
    \ 0001f6 8301                 sta     1,s
    \ 0001f8 a30f                 lda     15,s
    \ 0001fa a20000               ldx     ##0
    \ 0001fd a8                   tay
    \ 0001fe 1001                 bpl     `?L616`
    \ 000200 ca                   dex
    \ 000201 18       `?L616`:    clc
    \ 000202 65..                 adc     dp:.tiny _Dp
    \ 000204 48                   pha
    \ 000205 8a                   txa
    \ 000206 65..                 adc     dp:.tiny (_Dp+2)
    \ 000208 aa                   tax
    \ 000209 68                   pla
    \ 00020a 86..                 stx     dp:.tiny (_Dp+2)
    \ 00020c 85..                 sta     dp:.tiny _Dp
    \ 00020e a5..                 lda     dp:.tiny (_Dp+2)
    \ 000210 29ff00               and     ##255
    \ 000213 aa                   tax
    \ 000214 a5..                 lda     dp:.tiny _Dp
    \ 000216 290000               and     ##0
    \ 000219 86..                 stx     dp:.tiny (_Dp+10)
    \ 00021b 85..                 sta     dp:.tiny (_Dp+8)
    \ 00021d a301                 lda     1,s
    \ 00021f 8002                 bra     `?L180`
    \ 000221 a301     `?L179`:    lda     1,s
    \ 000223 a301     `?L180`:    lda     1,s
    \ 000225 4c....               jmp     .kbank `?L176`
    \ 000228 a30f     `?L162`:    lda     15,s
    \ 00022a 8002                 bra     `?L154`
    \ 00022c a303     `?L158`:    lda     3,s
    \ 00022e          `?L154`:
0518                  				}
0519                  			}
0520                  		}
0521                  	}
0522                  	return length; // returns number of bytes read
0523                  }
    \ 00022e a8                   tay
    \ 00022f 3b                   tsc
    \ 000230 18                   clc
    \ 000231 691000               adc     ##16
    \ 000234 1b                   tcs
    \ 000235 98                   tya
    \ 000236 5c......             jmp     long:`?L1265`
0524                  
0525                  // -----------------------------------------------------
0526                  // Simple setPixel Implementation by Ernesto Contreras
0527                  // -----------------------------------------------------
0528                  static inline void setPixel (unsigned long x, unsigned long y, uint8_t col)
0529                  {
    \ 000000                      .section farcode,text
    \ 000000          setPixel:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 86..                 stx     dp:.tiny (_Dp+6)
    \ 000006 85..                 sta     dp:.tiny (_Dp+4)
0530                  uint8_t __far24 *ptr;
0531                  	if (vBitPlane[vickyBitmapPage]) // if Bitmap for the page is enabled
    \ 000008 22......             jsl     long:`?L1321`
    \ 00000c f045                 beq     `?L185`
0532                  		{
0533                  			// check screen Boundaries
0534                  			if (x<vickyResX && y<vickyResY)
    \ 00000e a5..                 lda     dp:.tiny (_Dp+4)
    \ 000010 cd....               cmp     vickyResX
    \ 000013 a5..                 lda     dp:.tiny (_Dp+6)
    \ 000015 ed....               sbc     vickyResX+2
    \ 000018 b039                 bcs     `?L185`
    \ 00001a a5..                 lda     dp:.tiny _Dp
    \ 00001c cd....               cmp     vickyResY
    \ 00001f a5..                 lda     dp:.tiny (_Dp+2)
    \ 000021 ed....               sbc     vickyResY+2
    \ 000024 b02d                 bcs     `?L185`
0535                  			{
0536                  					ptr = (0xb00000+x+y*vickyResX);
    \ 000026 a6..                 ldx     dp:.tiny (_Dp+6)
    \ 000028 a5..                 lda     dp:.tiny (_Dp+4)
    \ 00002a 18                   clc
    \ 00002b 690000               adc     ##0
    \ 00002e 48                   pha
    \ 00002f 22......             jsl     long:`?L1336`
    \ 000033 68                   pla
    \ 000034 22......             jsl     long:`?L1303`
    \ 000038 48                   pha
    \ 000039 8a                   txa
    \ 00003a 65..                 adc     dp:.tiny (_Dp+10)
    \ 00003c aa                   tax
    \ 00003d 68                   pla
0537                  					ptr+= (long) bitplane[vickyBitmapPage].start;
0538                  					*ptr = col;
    \ 00003e 22......             jsl     long:`?L1283`
    \ 000042 a00100               ldy     ##1
    \ 000045 b7..                 lda     [.tiny (_Dp+4)],y
    \ 000047 22......             jsl     long:`?L1288`
    \ 00004b e220                 sep     #32
    \ 00004d a308                 lda     8,s
    \ 00004f 87..                 sta     [.tiny _Dp]
    \ 000051 c220                 rep     #32
    \ 000053          `?L185`:
0539                  			}
0540                  		}
0541                  }
    \ 000053 7a                   ply
    \ 000054 84..                 sty     dp:.tiny (_Dp+10)
    \ 000056 7a                   ply
    \ 000057 84..                 sty     dp:.tiny (_Dp+8)
    \ 000059 6b                   rtl
0542                  
0543                  // -----------------------------------------------------
0544                  // Plot function
0545                  // wrapper for setPixel.. by Ernesto Contreras
0546                  // This function is callable directly from an external program, but can´t be inlined
0547                  // -----------------------------------------------------
0548                  void plot (unsigned long x, unsigned long y, uint8_t col)
0549                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot
    \ 000000          plot:
    \ 000000 86..                 stx     dp:.tiny (_Dp+6)
    \ 000002 85..                 sta     dp:.tiny (_Dp+4)
0550                  	setPixel(x,y,col);
    \ 000004 a304                 lda     4,s
    \ 000006 48                   pha
    \ 000007 a6..                 ldx     dp:.tiny (_Dp+6)
    \ 000009 a5..                 lda     dp:.tiny (_Dp+4)
    \ 00000b 22......             jsl     long:setPixel
    \ 00000f 68                   pla
0551                  }
    \ 000010 6b                   rtl
0552                  
0553                  
0554                  // ----------------------------------------------------------
0555                  // setPixel_fast by Ernesto Contreras
0556                  // removed boundary checking for speed optimization
0557                  // Warning: calling function is responsible that the x,y range is not out of bounds or the universe might collapse! (at least for the Foenix..)
0558                  // ----------------------------------------------------------
0559                  static inline void setPixel_fast (unsigned long x, unsigned long y, uint8_t col)
0560                  {
0561                  uint8_t __far24 *ptr;
0562                  		ptr = (0xb00000+x+y*vickyResX);
0563                  		ptr+= (long) bitplane[vickyBitmapPage].start;
0564                  		*ptr = col;
0565                  }
0566                  // ----------------------------------------------------------
0567                  // clrBitmap function by Ernesto Contreras
0568                  // Modified memset function from Calypsi
0569                  // thx to hth313 - Calypsi creator for his memset  support!
0570                  // ----------------------------------------------------------
0571                  void clrBitmap ()
0572                  {uint8_t __far24 *ptr;
    \ 000000                      .section farcode,text
    \ 000000                      .public clrBitmap
    \ 000000          clrBitmap:
0573                  	ptr= bitplane[vickyBitmapPage].start;
0574                      VDMA_CONTROL_REG |= VDMA_CTRL_TRF_Fill + 1; //1=Enable!
0575                  	VDMA_DST_ADDY = ptr;
0576                      VDMA_BYTE_2_WRITE = 0;
0577                      VDMA_SIZE = (long) (vickyResX*vickyResY);
    \ 000000 22......             jsl     long:`?L1286`
    \ 000004 e220                 sep     #32
    \ 000006 a905                 lda     #5
    \ 000008 22......             jsl     long:`?L1306`
    \ 00000c 8f0704af             sta     long:11469831
    \ 000010 a900                 lda     #0
    \ 000012 8f0104af             sta     long:11469825
    \ 000016 c220                 rep     #32
    \ 000018 22......             jsl     long:`?L1291`
    \ 00001c 8f0804af             sta     long:11469832
    \ 000020 8a                   txa
    \ 000021 8f0a04af             sta     long:11469834
0578                  
0579                      // Start VDMA
0580                      VDMA_CONTROL_REG |= VDMA_CTRL_Start_TRF;
0581                  
0582                      // When started, the 65816 is held, but it takes a few cycles.
0583                      // Provide a short delay to ensure that we do not execute too far
0584                      // before the transfer actually starts. Call a delay subroutine for
0585                      // this.
0586                      DMA_wait_delay();
    \ 000025 22......             jsl     long:`?L1298`
0587                      wait_for_DMA_to_finish();
0588                  }
    \ 000029 6b                   rtl
0589                  
0590                  // ----------------------------------------------------------
0591                  // Vram2Dram_linearCopy function  - Experimental & not working yet
0592                  // The author is not responsible for any loss of bytes under any circumstance!!
0593                  // Author Alonso Contreras (my evil twin)
0594                  // ----------------------------------------------------------
0595                  void vram2dram_linearCopy ( long source, int __far *buffer, long length)
0596                  {uint8_t __far24 *ptr;
    \ 000000                      .section farcode,text
    \ 000000                      .public vram2dram_linearCopy
    \ 000000          vram2dram_linearCopy:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 d4..                 pei     dp:.tiny (_Dp+12)
    \ 000006 d4..                 pei     dp:.tiny (_Dp+14)
    \ 000008 86..                 stx     dp:.tiny (_Dp+10)
    \ 00000a 85..                 sta     dp:.tiny (_Dp+8)
0597                  	//source+= (long) bitplane[vickyBitmapPage].start;
0598                      VDMA_CONTROL_REG |= VDMA_CTRL_SysRAM_Dst + 1; //1=Enable!
    \ 00000c e220                 sep     #32
    \ 00000e a921                 lda     #33
    \ 000010 0f0004af             ora     long:11469824
    \ 000014 8f0004af             sta     long:11469824
0599                  	SDMA_CTRL_REG0 |= SDMA_CTRL0_SysRAM_Dst + 1;
    \ 000018 a921                 lda     #33
0600                  
0601                  	ptr=source + (long) bitplane[vickyBitmapPage].start;
0602                  	// Set source, destination and lenght of copy
0603                  	VDMA_SRC_ADDY = ptr;
0604                  	SDMA_DST_ADDY = buffer;
0605                      VDMA_SIZE = length;
0606                  	SDMA_SIZE = length;
0607                      printf ("source: %x dest: %x len:%ld\r",ptr,buffer,length);
    \ 00001a 22......             jsl     long:`?L1350`
    \ 00001e d4..                 pei     dp:.tiny (_Dp+10)
    \ 000020 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000022 a90001               lda     ##256
    \ 000025 85..                 sta     dp:.tiny (_Dp+8)
    \ 000027 a9af00               lda     ##175
    \ 00002a 85..                 sta     dp:.tiny (_Dp+10)
    \ 00002c ad....               lda     vickyBitmapPage
    \ 00002f 0a                   asl     a
    \ 000030 0a                   asl     a
    \ 000031 0a                   asl     a
    \ 000032 85..                 sta     dp:.tiny (_Dp+12)
    \ 000034 18                   clc
    \ 000035 a5..                 lda     dp:.tiny (_Dp+8)
    \ 000037 65..                 adc     dp:.tiny (_Dp+12)
    \ 000039 85..                 sta     dp:.tiny (_Dp+8)
    \ 00003b a00300               ldy     ##3
    \ 00003e b7..                 lda     [.tiny (_Dp+8)],y
    \ 000040 29ff00               and     ##255
    \ 000043 aa                   tax
    \ 000044 a00100               ldy     ##1
    \ 000047 b7..                 lda     [.tiny (_Dp+8)],y
    \ 000049 22......             jsl     long:_FillDP2
    \ 00004d ..                   .byte   .tiny (_Dp+8)
    \ 00004e 22......             jsl     long:_FillDP2
    \ 000052 ..                   .byte   .tiny (_Dp+10)
    \ 000053 18                   clc
    \ 000054 65..                 adc     dp:.tiny (_Dp+8)
    \ 000056 48                   pha
    \ 000057 8a                   txa
    \ 000058 65..                 adc     dp:.tiny (_Dp+10)
    \ 00005a aa                   tax
    \ 00005b 68                   pla
    \ 00005c 86..                 stx     dp:.tiny (_Dp+14)
    \ 00005e 85..                 sta     dp:.tiny (_Dp+12)
    \ 000060 a5..                 lda     dp:.tiny (_Dp+12)
    \ 000062 8f0204af             sta     long:11469826
    \ 000066 e220                 sep     #32
    \ 000068 a5..                 lda     dp:.tiny (_Dp+14)
    \ 00006a 8f0404af             sta     long:11469828
    \ 00006e c220                 rep     #32
    \ 000070 a5..                 lda     dp:.tiny _Dp
    \ 000072 85..                 sta     dp:.tiny (_Dp+8)
    \ 000074 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000076 85..                 sta     dp:.tiny (_Dp+10)
    \ 000078 a5..                 lda     dp:.tiny (_Dp+8)
    \ 00007a 8f2504af             sta     long:11469861
    \ 00007e e220                 sep     #32
    \ 000080 a5..                 lda     dp:.tiny (_Dp+10)
    \ 000082 8f2704af             sta     long:11469863
    \ 000086 c220                 rep     #32
    \ 000088 a5..                 lda     dp:.tiny (_Dp+4)
    \ 00008a 8f0804af             sta     long:11469832
    \ 00008e a5..                 lda     dp:.tiny (_Dp+6)
    \ 000090 8f0a04af             sta     long:11469834
    \ 000094 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000096 8d2804               sta     1064
    \ 000099 a5..                 lda     dp:.tiny (_Dp+6)
    \ 00009b 8d2a04               sta     1066
    \ 00009e a5..                 lda     dp:.tiny (_Dp+6)
    \ 0000a0 48                   pha
    \ 0000a1 a5..                 lda     dp:.tiny (_Dp+4)
    \ 0000a3 48                   pha
    \ 0000a4 a5..                 lda     dp:.tiny (_Dp+2)
    \ 0000a6 48                   pha
    \ 0000a7 a5..                 lda     dp:.tiny _Dp
    \ 0000a9 48                   pha
    \ 0000aa a6..                 ldx     dp:.tiny (_Dp+14)
    \ 0000ac a5..                 lda     dp:.tiny (_Dp+12)
    \ 0000ae da                   phx
    \ 0000af 48                   pha
    \ 0000b0 a9....               lda     ##`_StringLiteral_[115,111,117,114,99,101,58,32,37,120,32,100,101,115,116,58,32,37,120,32,108,101,110,58,37,108,100,13]`
    \ 0000b3 22......             jsl     long:printf
0608                      // Start VDMA
0609                      VDMA_CONTROL_REG |= VDMA_CTRL_Start_TRF;
    \ 0000b7 3b                   tsc
    \ 0000b8 18                   clc
    \ 0000b9 690c00               adc     ##12
    \ 0000bc 1b                   tcs
    \ 0000bd e220                 sep     #32
    \ 0000bf a980                 lda     #-128
    \ 0000c1 0f0004af             ora     long:11469824
    \ 0000c5 8f0004af             sta     long:11469824
0610                  	SDMA_CTRL_REG0 |= SDMA_CTRL0_Start_TRF;
    \ 0000c9 a980                 lda     #-128
0611                  	printf ("Xfer inititated\r");
    \ 0000cb 22......             jsl     long:`?L1350`
    \ 0000cf a9....               lda     ##`_StringLiteral_[88,102,101,114,32,105,110,105,116,105,116,97,116,101,100,13]`
    \ 0000d2 22......             jsl     long:printf
0612                      // When started, the 65816 is held, but it takes a few cycles.
0613                      // Provide a short delay to ensure that we do not execute too far
0614                      // before the transfer actually starts. Call a delay subroutine for
0615                      // this.
0616                      DMA_wait_delay();
    \ 0000d6 22......             jsl     long:DMA_wait_delay
0617                  	printf ("waiting..\r");
    \ 0000da a9....               lda     ##`_StringLiteral_[119,97,105,116,105,110,103,46,46,13]`
    \ 0000dd 22......             jsl     long:printf
0618                      wait_for_DMA_to_finish();
    \ 0000e1 22......             jsl     long:wait_for_DMA_to_finish
0619                  	printf ("Finish..\r");
    \ 0000e5 a9....               lda     ##`_StringLiteral_[70,105,110,105,115,104,46,46,13]`
    \ 0000e8 22......             jsl     long:printf
    \ 0000ec          `?L1265`:
0620                  }
    \ 0000ec 7a                   ply
    \ 0000ed 84..                 sty     dp:.tiny (_Dp+14)
    \ 0000ef 7a                   ply
    \ 0000f0 84..                 sty     dp:.tiny (_Dp+12)
    \ 0000f2 5c......             jmp     long:`?L185`
0621                  
0622                  //----------------------------------------------------
0623                  // Super Simple Rectangle by Ernesto Contreras
0624                  // ---------------------------------------------------
0625                  void plot_rectangle (int x0, int y0, int x1, int y1, uint8_t col)
0626                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot_rectangle
    \ 000000          plot_rectangle:
    \ 000000 5a                   phy
    \ 000001 5a                   phy
    \ 000002 5a                   phy
    \ 000003 8301                 sta     1,s
    \ 000005 a5..                 lda     dp:.tiny _Dp
    \ 000007 8303                 sta     3,s
    \ 000009 a5..                 lda     dp:.tiny (_Dp+2)
    \ 00000b 8305                 sta     5,s
0627                  	plot_line (x0,y0,x1,y0,col);
    \ 00000d a30c                 lda     12,s
    \ 00000f 48                   pha
    \ 000010 a305                 lda     5,s
    \ 000012 48                   pha
    \ 000013 a309                 lda     9,s
    \ 000015 85..                 sta     dp:.tiny (_Dp+2)
    \ 000017 a307                 lda     7,s
    \ 000019 85..                 sta     dp:.tiny _Dp
    \ 00001b a305                 lda     5,s
    \ 00001d 22......             jsl     long:plot_line
0628                  	plot_line (x0,y1,x1,y1,col);
    \ 000021 a310                 lda     16,s
    \ 000023 48                   pha
    \ 000024 a310                 lda     16,s
    \ 000026 48                   pha
    \ 000027 a30d                 lda     13,s
    \ 000029 85..                 sta     dp:.tiny (_Dp+2)
    \ 00002b a312                 lda     18,s
    \ 00002d 85..                 sta     dp:.tiny _Dp
    \ 00002f a309                 lda     9,s
    \ 000031 22......             jsl     long:plot_line
0629                  	plot_line (x0,y0,x0,y1,col);
    \ 000035 a314                 lda     20,s
    \ 000037 48                   pha
    \ 000038 a314                 lda     20,s
    \ 00003a 48                   pha
    \ 00003b a30d                 lda     13,s
    \ 00003d 85..                 sta     dp:.tiny (_Dp+2)
    \ 00003f a30f                 lda     15,s
    \ 000041 85..                 sta     dp:.tiny _Dp
    \ 000043 a30d                 lda     13,s
    \ 000045 22......             jsl     long:plot_line
0630                  	plot_line (x1,y0,x1,y1,col);
    \ 000049 a318                 lda     24,s
    \ 00004b 48                   pha
    \ 00004c a318                 lda     24,s
    \ 00004e 48                   pha
    \ 00004f a315                 lda     21,s
    \ 000051 85..                 sta     dp:.tiny (_Dp+2)
    \ 000053 a313                 lda     19,s
    \ 000055 85..                 sta     dp:.tiny _Dp
    \ 000057 a315                 lda     21,s
    \ 000059 22......             jsl     long:plot_line
    \ 00005d 3b                   tsc
    \ 00005e 18                   clc
    \ 00005f 691000               adc     ##16
    \ 000062 1b                   tcs
0631                  }
    \ 000063 7a                   ply
    \ 000064 7a                   ply
    \ 000065 7a                   ply
    \ 000066 6b                   rtl
0632                  
0633                  //-----------------------------------------
0634                  // Solid Rectangle by Ernesto Contreras
0635                  // Uses VDMA Fill function
0636                  //------------------------------------------
0637                  void plot_solid_rectangle  (int x0, int y0, int x1, int y1, uint8_t col)
0638                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot_solid_rectangle
    \ 000000          plot_solid_rectangle:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 a8                   tay
    \ 000005 3b                   tsc
    \ 000006 38                   sec
    \ 000007 e90a00               sbc     ##10
    \ 00000a 1b                   tcs
    \ 00000b 98                   tya
    \ 00000c aa                   tax
    \ 00000d a5..                 lda     dp:.tiny _Dp
    \ 00000f 8303                 sta     3,s
    \ 000011 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000013 8305                 sta     5,s
0639                  uint8_t __far24 *ptr;
0640                  int swap;
0641                  long address;
0642                  
0643                  	if (x0>x1) // Ensure x1 is greater than x0 
    \ 000015 a305                 lda     5,s
    \ 000017 86..                 stx     dp:.tiny _Dp
    \ 000019 38                   sec
    \ 00001a e5..                 sbc     dp:.tiny _Dp
    \ 00001c 5003                 bvc     `?L633`
    \ 00001e 490080               eor     ##-32768
    \ 000021 1011     `?L633`:    bpl     `?L210`
0644                  	{ 
0645                  	  swap=x0;
    \ 000023 8a                   txa
    \ 000024 8301                 sta     1,s
0646                  	  x0=x1;
    \ 000026 a305                 lda     5,s
    \ 000028 a8                   tay
0647                  	  x1=swap;
    \ 000029 a301                 lda     1,s
    \ 00002b aa                   tax
    \ 00002c 98                   tya
    \ 00002d 8307                 sta     7,s
    \ 00002f 8a                   txa
    \ 000030 8305                 sta     5,s
    \ 000032 8003                 bra     `?L211`
    \ 000034 8a       `?L210`:    txa
    \ 000035 8307                 sta     7,s
    \ 000037          `?L211`:
0648                  	}
0649                  	
0650                  	if (y0>y1) // Ensure y1 is greater than y0 
    \ 000037 a312                 lda     18,s
    \ 000039 38                   sec
    \ 00003a e303                 sbc     3,s
    \ 00003c 5003                 bvc     `?L635`
    \ 00003e 490080               eor     ##-32768
    \ 000041 100b     `?L635`:    bpl     `?L213`
0651                  	{ 
0652                  	  swap=y0;
    \ 000043 a303                 lda     3,s
    \ 000045 8301                 sta     1,s
0653                  	  y0=y1;
    \ 000047 a312                 lda     18,s
    \ 000049 a8                   tay
0654                  	  y1=swap;
    \ 00004a a301                 lda     1,s
    \ 00004c 8005                 bra     `?L1241`
    \ 00004e a303     `?L213`:    lda     3,s
    \ 000050 a8                   tay
    \ 000051 a312                 lda     18,s
    \ 000053 aa       `?L1241`:   tax
0655                  	}
0656                  
0657                  	// one pixel rectangles are not allowed!
0658                  	if (x0==x1) {x1++;}
    \ 000054 a305                 lda     5,s
    \ 000056 c307                 cmp     7,s
    \ 000058 d009                 bne     `?L216`
    \ 00005a 1a                   inc     a
    \ 00005b 3a                   dec     a
    \ 00005c 1a                   inc     a
    \ 00005d 8301                 sta     1,s
    \ 00005f a301                 lda     1,s
    \ 000061 8002                 bra     `?L1240`
    \ 000063 1a       `?L216`:    inc     a
    \ 000064 3a                   dec     a
    \ 000065 8303     `?L1240`:   sta     3,s
0659                  	if (y0==y1) {y1++;}
    \ 000067 84..                 sty     dp:.tiny _Dp
    \ 000069 e4..                 cpx     dp:.tiny _Dp
    \ 00006b d008                 bne     `?L219`
    \ 00006d 8a                   txa
    \ 00006e 1a                   inc     a
    \ 00006f 8301                 sta     1,s
    \ 000071 a301                 lda     1,s
    \ 000073 8001                 bra     `?L1239`
    \ 000075 8a       `?L219`:    txa
    \ 000076 8305     `?L1239`:   sta     5,s
0660                  	
0661                  	// validate coordinates before memset
0662                  	if (x0<0) {x0=0;}
    \ 000078 a307                 lda     7,s
    \ 00007a 1007                 bpl     `?L222`
    \ 00007c a90000               lda     ##0
    \ 00007f 8301                 sta     1,s
    \ 000081 8002                 bra     `?L1238`
    \ 000083 1a       `?L222`:    inc     a
    \ 000084 3a                   dec     a
    \ 000085 8301     `?L1238`:   sta     1,s
0663                  	if (y0<0) {y0=0;}
    \ 000087 84..                 sty     dp:.tiny _Dp
    \ 000089 a5..                 lda     dp:.tiny _Dp
    \ 00008b 1005                 bpl     `?L225`
    \ 00008d a90000               lda     ##0
    \ 000090 8001                 bra     `?L1237`
    \ 000092 98       `?L225`:    tya
    \ 000093 8307     `?L1237`:   sta     7,s
0664                  	if (x1<0) {x1=0;}
    \ 000095 a303                 lda     3,s
    \ 000097 1005                 bpl     `?L229`
    \ 000099 a90000               lda     ##0
    \ 00009c 8303                 sta     3,s
    \ 00009e          `?L229`:
0665                  	if (y1<0) {y1=0;}
    \ 00009e a305                 lda     5,s
    \ 0000a0 1005                 bpl     `?L232`
    \ 0000a2 a90000               lda     ##0
    \ 0000a5 8305                 sta     5,s
    \ 0000a7          `?L232`:
0666                  	
0667                  	if (x0>=vickyResX) {x0=vickyResX-1;}
    \ 0000a7 a20000               ldx     ##0
    \ 0000aa a301                 lda     1,s
    \ 0000ac 1001                 bpl     `?L637`
    \ 0000ae ca                   dex
    \ 0000af          `?L637`:
    \ 0000af 22......             jsl     long:`?L1313`
    \ 0000b3 5003                 bvc     `?L639`
    \ 0000b5 490080               eor     ##-32768
    \ 0000b8 3006     `?L639`:    bmi     `?L234`
    \ 0000ba ad....               lda     vickyResX
    \ 0000bd 3a                   dec     a
    \ 0000be 8002                 bra     `?L1236`
    \ 0000c0 a301     `?L234`:    lda     1,s
    \ 0000c2 8309     `?L1236`:   sta     9,s
0668                  	if (y0>=vickyResY) {y0=vickyResY;}
    \ 0000c4 a20000               ldx     ##0
    \ 0000c7 a307                 lda     7,s
    \ 0000c9 1001                 bpl     `?L641`
    \ 0000cb ca                   dex
    \ 0000cc          `?L641`:
    \ 0000cc 22......             jsl     long:`?L1326`
    \ 0000d0 5003                 bvc     `?L643`
    \ 0000d2 490080               eor     ##-32768
    \ 0000d5 3005     `?L643`:    bmi     `?L238`
    \ 0000d7 ad....               lda     vickyResY
    \ 0000da 8307                 sta     7,s
    \ 0000dc          `?L238`:
0669                  	if (x1>=vickyResX) {x1=vickyResX-1;}
    \ 0000dc a20000               ldx     ##0
    \ 0000df a303                 lda     3,s
    \ 0000e1 1001                 bpl     `?L645`
    \ 0000e3 ca                   dex
    \ 0000e4          `?L645`:
    \ 0000e4 22......             jsl     long:`?L1313`
    \ 0000e8 5003                 bvc     `?L647`
    \ 0000ea 490080               eor     ##-32768
    \ 0000ed 3008     `?L647`:    bmi     `?L240`
    \ 0000ef ad....               lda     vickyResX
    \ 0000f2 3a                   dec     a
    \ 0000f3 8301                 sta     1,s
    \ 0000f5 8004                 bra     `?L241`
    \ 0000f7 a303     `?L240`:    lda     3,s
    \ 0000f9 8301                 sta     1,s
    \ 0000fb          `?L241`:
0670                  	if (y1>=vickyResY) {y1=vickyResY;}
    \ 0000fb a20000               ldx     ##0
    \ 0000fe a305                 lda     5,s
    \ 000100 1001                 bpl     `?L649`
    \ 000102 ca                   dex
    \ 000103          `?L649`:
    \ 000103 22......             jsl     long:`?L1326`
    \ 000107 5003                 bvc     `?L651`
    \ 000109 490080               eor     ##-32768
    \ 00010c 3007     `?L651`:    bmi     `?L243`
    \ 00010e ad....               lda     vickyResY
    \ 000111 8303                 sta     3,s
    \ 000113 8002                 bra     `?L1235`
    \ 000115 a305     `?L243`:    lda     5,s
    \ 000117 8303     `?L1235`:   sta     3,s
0671                  
0672                  	ptr= bitplane[vickyBitmapPage].start;
0673                  	address=(x0 + vickyResX * y0);
    \ 000119 22......             jsl     long:`?L1286`
    \ 00011d a309                 lda     9,s
    \ 00011f a20000               ldx     ##0
    \ 000122 a8                   tay
    \ 000123 1001                 bpl     `?L653`
    \ 000125 ca                   dex
    \ 000126          `?L653`:
    \ 000126 86..                 stx     dp:.tiny (_Dp+10)
    \ 000128 85..                 sta     dp:.tiny (_Dp+8)
    \ 00012a ad....               lda     vickyResX
    \ 00012d 85..                 sta     dp:.tiny _Dp
    \ 00012f ad....               lda     vickyResX+2
    \ 000132 85..                 sta     dp:.tiny (_Dp+2)
    \ 000134 a307                 lda     7,s
    \ 000136 a20000               ldx     ##0
    \ 000139 a8                   tay
    \ 00013a 1001                 bpl     `?L655`
    \ 00013c ca                   dex
    \ 00013d          `?L655`:
    \ 00013d 86..                 stx     dp:.tiny (_Dp+6)
    \ 00013f 85..                 sta     dp:.tiny (_Dp+4)
    \ 000141 22......             jsl     long:_Mul32
    \ 000145 18                   clc
    \ 000146 65..                 adc     dp:.tiny (_Dp+8)
    \ 000148 48                   pha
    \ 000149 8a                   txa
    \ 00014a 65..                 adc     dp:.tiny (_Dp+10)
    \ 00014c aa                   tax
    \ 00014d 68                   pla
0674                  	ptr= address + (long)bitplane[vickyBitmapPage].start;
0675                      VDMA_CONTROL_REG |= VDMA_CTRL_TRF_Fill | VDMA_CTRL_1D_2D  + 1; //1 added to Enable!, I believe Calypsi memset function needs this change too!
0676                  	VDMA_DST_ADDY = ptr; // calculate destination address 
0677                      VDMA_BYTE_2_WRITE = col;
0678                  	VDMA_X_SIZE = x1-x0;  
0679                  	VDMA_Y_SIZE = y1-y0;
0680                      VDMA_DST_STRIDE = vickyResX;
0681                  	// printf ("x:%d y:%d x1:%d y1:%d address:%ld %ld\n\r",x0,y0,x1,y1,address,ptr); // debug
0682                      // Start VDMA
0683                      VDMA_CONTROL_REG |= VDMA_CTRL_Start_TRF;
0684                  
0685                      // When started, the 65816 is held, but it takes a few cycles.
0686                      // Provide a short delay to ensure that we do not execute too far
0687                      // before the transfer actually starts. Call a delay subroutine for
0688                      // this.
0689                      DMA_wait_delay();
    \ 00014e 22......             jsl     long:`?L1283`
    \ 000152 a00300               ldy     ##3
    \ 000155 b7..                 lda     [.tiny (_Dp+4)],y
    \ 000157 29ff00               and     ##255
    \ 00015a aa                   tax
    \ 00015b a00100               ldy     ##1
    \ 00015e b7..                 lda     [.tiny (_Dp+4)],y
    \ 000160 18                   clc
    \ 000161 65..                 adc     dp:.tiny _Dp
    \ 000163 48                   pha
    \ 000164 8a                   txa
    \ 000165 65..                 adc     dp:.tiny (_Dp+2)
    \ 000167 aa                   tax
    \ 000168 68                   pla
    \ 000169 86..                 stx     dp:.tiny (_Dp+2)
    \ 00016b 85..                 sta     dp:.tiny _Dp
    \ 00016d e220                 sep     #32
    \ 00016f a907                 lda     #7
    \ 000171 22......             jsl     long:`?L1306`
    \ 000175 8f0704af             sta     long:11469831
    \ 000179 a314                 lda     20,s
    \ 00017b 8f0104af             sta     long:11469825
    \ 00017f c220                 rep     #32
    \ 000181 a301                 lda     1,s
    \ 000183 38                   sec
    \ 000184 e309                 sbc     9,s
    \ 000186 8f0804af             sta     long:11469832
    \ 00018a a303                 lda     3,s
    \ 00018c 38                   sec
    \ 00018d e307                 sbc     7,s
    \ 00018f 8f0a04af             sta     long:11469834
    \ 000193 ad....               lda     vickyResX
    \ 000196 8f0e04af             sta     long:11469838
    \ 00019a 22......             jsl     long:`?L1298`
0690                      wait_for_DMA_to_finish();
0691                  }
    \ 00019e 3b                   tsc
    \ 00019f 18                   clc
    \ 0001a0 690a00               adc     ##10
    \ 0001a3 1b                   tcs
    \ 0001a4 5c......             jmp     long:`?L1267`
0692                  
0693                  // ----------------------------------------------
0694                  // 4 point Bezier curve 
0695                  // Credits to M G Channel
0696                  // https://www.youtube.com/watch?v=KiscPiPdLv4
0697                  // Adapted by Ernesto Contreras
0698                  // ----------------------------------------------
0699                  void plot_bezier (int x0, int y0, int x1, int y1, int x2, int y2, int x3, int y3, uint8_t col)
0700                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot_bezier
    \ 000000          plot_bezier:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 d4..                 pei     dp:.tiny (_Dp+12)
    \ 000006 d4..                 pei     dp:.tiny (_Dp+14)
    \ 000008 a8                   tay
    \ 000009 3b                   tsc
    \ 00000a 38                   sec
    \ 00000b e91200               sbc     ##18
    \ 00000e 1b                   tcs
    \ 00000f 98                   tya
    \ 000010 8301                 sta     1,s
    \ 000012 a5..                 lda     dp:.tiny _Dp
    \ 000014 8303                 sta     3,s
    \ 000016 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000018 8305                 sta     5,s
0701                  	float u, pxe, pye,pxi,pyi;
0702                  	pxi=0;
    \ 00001a a90000               lda     ##0
    \ 00001d 85..                 sta     dp:.tiny _Dp
    \ 00001f 85..                 sta     dp:.tiny (_Dp+2)
0703                  	pyi=0;
    \ 000021 85..                 sta     dp:.tiny (_Dp+4)
    \ 000023 85..                 sta     dp:.tiny (_Dp+6)
0704                  	for (u=0;u<=1.0;u=u+0.02)
    \ 000025 85..                 sta     dp:.tiny (_Dp+8)
    \ 000027 85..                 sta     dp:.tiny (_Dp+10)
    \ 000029 a5..                 lda     dp:.tiny _Dp
    \ 00002b 830f                 sta     15,s
    \ 00002d a5..                 lda     dp:.tiny (_Dp+2)
    \ 00002f 8311                 sta     17,s
    \ 000031 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000033 8307                 sta     7,s
    \ 000035 a5..                 lda     dp:.tiny (_Dp+6)
    \ 000037 8309     `?L1242`:   sta     9,s
    \ 000039 a90000               lda     ##0
    \ 00003c a2803f               ldx     ##16256
    \ 00003f 22......             jsl     long:`?L1314`
    \ 000043 b013                 bcs     `?L249`
0705                  	{
0706                  		pxe=fast_pow(1-u,3)*x0+3*u*fast_pow(1-u,2)*x1+3*fast_pow(u,2)*(1-u)*x2+fast_pow(u,3)*x3;
0707                  		pye=fast_pow(1-u,3)*y0+3*u*fast_pow(1-u,2)*y1+3*fast_pow(u,2)*(1-u)*y2+fast_pow(u,3)*y3;
0708                  		if (pxi!=0 || pyi!=0)
0709                  		{
0710                  			plot_line (pxi,pyi,pxe,pye,col);
0711                  		}
0712                  		pxi=pxe;
0713                  		pyi=pye;
0714                  	}
0715                  }	
    \ 000045 3b                   tsc
    \ 000046 18                   clc
    \ 000047 691200               adc     ##18
    \ 00004a 1b                   tcs
    \ 00004b 7a                   ply
    \ 00004c 84..                 sty     dp:.tiny (_Dp+14)
    \ 00004e 7a                   ply
    \ 00004f 84..                 sty     dp:.tiny (_Dp+12)
    \ 000051 7a       `?L1267`:   ply
    \ 000052 84..                 sty     dp:.tiny (_Dp+10)
    \ 000054 7a                   ply
    \ 000055 84..                 sty     dp:.tiny (_Dp+8)
    \ 000057 6b                   rtl
    \ 000058 a20300   `?L249`:    ldx     ##3
    \ 00005b 86..                 stx     dp:.tiny _Dp
    \ 00005d d4..                 pei     dp:.tiny _Dp
    \ 00005f 22......             jsl     long:`?L1280`
    \ 000063 22......             jsl     long:_FillDP2
    \ 000067 ..                   .byte   .tiny _Dp
    \ 000068 22......             jsl     long:fast_pow
    \ 00006c 86..                 stx     dp:.tiny (_Dp+2)
    \ 00006e 85..                 sta     dp:.tiny _Dp
    \ 000070 a301                 lda     1,s
    \ 000072 a20000               ldx     ##0
    \ 000075 a8                   tay
    \ 000076 1001                 bpl     `?L663`
    \ 000078 ca                   dex
    \ 000079          `?L663`:
    \ 000079 22......             jsl     long:_SInt32ToFloat32
    \ 00007d 22......             jsl     long:_Float32Mul
    \ 000081 da                   phx
    \ 000082 48                   pha
    \ 000083 22......             jsl     long:`?L1353`
    \ 000087 a4..                 ldy     dp:.tiny (_Dp+10)
    \ 000089 22......             jsl     long:`?L1279`
    \ 00008d da                   phx
    \ 00008e 48                   pha
    \ 00008f a20200               ldx     ##2
    \ 000092 86..                 stx     dp:.tiny _Dp
    \ 000094 d4..                 pei     dp:.tiny _Dp
    \ 000096 22......             jsl     long:`?L1280`
    \ 00009a 22......             jsl     long:_FillDP2
    \ 00009e ..                   .byte   .tiny _Dp
    \ 00009f 22......             jsl     long:fast_pow
    \ 0000a3 22......             jsl     long:_FillDP4
    \ 0000a7 ..                   .byte   .tiny _Dp
    \ 0000a8 22......             jsl     long:`?L1273`
    \ 0000ac a309                 lda     9,s
    \ 0000ae a20000               ldx     ##0
    \ 0000b1 a8                   tay
    \ 0000b2 1001                 bpl     `?L671`
    \ 0000b4 ca                   dex
    \ 0000b5          `?L671`:
    \ 0000b5 22......             jsl     long:_SInt32ToFloat32
    \ 0000b9 22......             jsl     long:_Float32Mul
    \ 0000bd 22......             jsl     long:_FillDP4
    \ 0000c1 ..                   .byte   .tiny _Dp
    \ 0000c2 22......             jsl     long:_Float32Add
    \ 0000c6 da                   phx
    \ 0000c7 48                   pha
    \ 0000c8 22......             jsl     long:`?L1344`
    \ 0000cc d4..                 pei     dp:.tiny (_Dp+2)
    \ 0000ce d4..                 pei     dp:.tiny _Dp
    \ 0000d0 a20200               ldx     ##2
    \ 0000d3 22......             jsl     long:`?L1300`
    \ 0000d7 22......             jsl     long:_FillDP2
    \ 0000db ..                   .byte   .tiny _Dp
    \ 0000dc 22......             jsl     long:_FillDP2
    \ 0000e0 ..                   .byte   .tiny (_Dp+2)
    \ 0000e1 22......             jsl     long:_Float32Mul
    \ 0000e5 da                   phx
    \ 0000e6 48                   pha
    \ 0000e7 22......             jsl     long:`?L1280`
    \ 0000eb 22......             jsl     long:_FillDP4
    \ 0000ef ..                   .byte   .tiny _Dp
    \ 0000f0 22......             jsl     long:`?L1273`
    \ 0000f4 a324                 lda     36,s
    \ 0000f6 a20000               ldx     ##0
    \ 0000f9 a8                   tay
    \ 0000fa 1001                 bpl     `?L680`
    \ 0000fc ca                   dex
    \ 0000fd          `?L680`:
    \ 0000fd 22......             jsl     long:_SInt32ToFloat32
    \ 000101 22......             jsl     long:_Float32Mul
    \ 000105 22......             jsl     long:_FillDP4
    \ 000109 ..                   .byte   .tiny _Dp
    \ 00010a 22......             jsl     long:_Float32Add
    \ 00010e da                   phx
    \ 00010f 48                   pha
    \ 000110 a20300               ldx     ##3
    \ 000113 22......             jsl     long:`?L1300`
    \ 000117 86..                 stx     dp:.tiny (_Dp+2)
    \ 000119 85..                 sta     dp:.tiny _Dp
    \ 00011b a328                 lda     40,s
    \ 00011d a20000               ldx     ##0
    \ 000120 a8                   tay
    \ 000121 1001                 bpl     `?L686`
    \ 000123 ca                   dex
    \ 000124          `?L686`:
    \ 000124 22......             jsl     long:_SInt32ToFloat32
    \ 000128 22......             jsl     long:_Float32Mul
    \ 00012c 22......             jsl     long:_FillDP4
    \ 000130 ..                   .byte   .tiny _Dp
    \ 000131 22......             jsl     long:_Float32Add
    \ 000135 86..                 stx     dp:.tiny (_Dp+14)
    \ 000137 85..                 sta     dp:.tiny (_Dp+12)
    \ 000139 a20300               ldx     ##3
    \ 00013c 86..                 stx     dp:.tiny _Dp
    \ 00013e d4..                 pei     dp:.tiny _Dp
    \ 000140 22......             jsl     long:`?L1280`
    \ 000144 22......             jsl     long:_FillDP2
    \ 000148 ..                   .byte   .tiny _Dp
    \ 000149 22......             jsl     long:fast_pow
    \ 00014d 86..                 stx     dp:.tiny (_Dp+2)
    \ 00014f 85..                 sta     dp:.tiny _Dp
    \ 000151 a303                 lda     3,s
    \ 000153 a20000               ldx     ##0
    \ 000156 a8                   tay
    \ 000157 1001                 bpl     `?L693`
    \ 000159 ca                   dex
    \ 00015a          `?L693`:
    \ 00015a 22......             jsl     long:_SInt32ToFloat32
    \ 00015e 22......             jsl     long:_Float32Mul
    \ 000162 da                   phx
    \ 000163 48                   pha
    \ 000164 22......             jsl     long:`?L1353`
    \ 000168 a4..                 ldy     dp:.tiny (_Dp+10)
    \ 00016a 22......             jsl     long:`?L1279`
    \ 00016e da                   phx
    \ 00016f 48                   pha
    \ 000170 a20200               ldx     ##2
    \ 000173 86..                 stx     dp:.tiny _Dp
    \ 000175 d4..                 pei     dp:.tiny _Dp
    \ 000177 22......             jsl     long:`?L1280`
    \ 00017b 22......             jsl     long:_FillDP2
    \ 00017f ..                   .byte   .tiny _Dp
    \ 000180 22......             jsl     long:fast_pow
    \ 000184 22......             jsl     long:_FillDP4
    \ 000188 ..                   .byte   .tiny _Dp
    \ 000189 22......             jsl     long:`?L1273`
    \ 00018d a322                 lda     34,s
    \ 00018f a20000               ldx     ##0
    \ 000192 a8                   tay
    \ 000193 1001                 bpl     `?L701`
    \ 000195 ca                   dex
    \ 000196          `?L701`:
    \ 000196 22......             jsl     long:_SInt32ToFloat32
    \ 00019a 22......             jsl     long:_Float32Mul
    \ 00019e 22......             jsl     long:_FillDP4
    \ 0001a2 ..                   .byte   .tiny _Dp
    \ 0001a3 22......             jsl     long:_Float32Add
    \ 0001a7 da                   phx
    \ 0001a8 48                   pha
    \ 0001a9 22......             jsl     long:`?L1344`
    \ 0001ad d4..                 pei     dp:.tiny (_Dp+2)
    \ 0001af d4..                 pei     dp:.tiny _Dp
    \ 0001b1 a20200               ldx     ##2
    \ 0001b4 22......             jsl     long:`?L1300`
    \ 0001b8 22......             jsl     long:_FillDP2
    \ 0001bc ..                   .byte   .tiny _Dp
    \ 0001bd 22......             jsl     long:_FillDP2
    \ 0001c1 ..                   .byte   .tiny (_Dp+2)
    \ 0001c2 22......             jsl     long:_Float32Mul
    \ 0001c6 da                   phx
    \ 0001c7 48                   pha
    \ 0001c8 22......             jsl     long:`?L1280`
    \ 0001cc 22......             jsl     long:_FillDP4
    \ 0001d0 ..                   .byte   .tiny _Dp
    \ 0001d1 22......             jsl     long:`?L1273`
    \ 0001d5 a326                 lda     38,s
    \ 0001d7 a20000               ldx     ##0
    \ 0001da a8                   tay
    \ 0001db 1001                 bpl     `?L710`
    \ 0001dd ca                   dex
    \ 0001de          `?L710`:
    \ 0001de 22......             jsl     long:_SInt32ToFloat32
    \ 0001e2 22......             jsl     long:_Float32Mul
    \ 0001e6 22......             jsl     long:_FillDP4
    \ 0001ea ..                   .byte   .tiny _Dp
    \ 0001eb 22......             jsl     long:_Float32Add
    \ 0001ef da                   phx
    \ 0001f0 48                   pha
    \ 0001f1 a20300               ldx     ##3
    \ 0001f4 22......             jsl     long:`?L1300`
    \ 0001f8 86..                 stx     dp:.tiny (_Dp+2)
    \ 0001fa 85..                 sta     dp:.tiny _Dp
    \ 0001fc a32a                 lda     42,s
    \ 0001fe a20000               ldx     ##0
    \ 000201 a8                   tay
    \ 000202 1001                 bpl     `?L716`
    \ 000204 ca                   dex
    \ 000205          `?L716`:
    \ 000205 22......             jsl     long:_SInt32ToFloat32
    \ 000209 22......             jsl     long:_Float32Mul
    \ 00020d 22......             jsl     long:_FillDP4
    \ 000211 ..                   .byte   .tiny _Dp
    \ 000212 22......             jsl     long:_Float32Add
    \ 000216 830b                 sta     11,s
    \ 000218 8a                   txa
    \ 000219 830d                 sta     13,s
    \ 00021b a311                 lda     17,s
    \ 00021d 85..                 sta     dp:.tiny (_Dp+2)
    \ 00021f a30f                 lda     15,s
    \ 000221 85..                 sta     dp:.tiny _Dp
    \ 000223 a90000               lda     ##0
    \ 000226 aa                   tax
    \ 000227 22......             jsl     long:_Float32EQ
    \ 00022b d00f                 bne     `?L255`
    \ 00022d a309                 lda     9,s
    \ 00022f 85..                 sta     dp:.tiny (_Dp+2)
    \ 000231 a307                 lda     7,s
    \ 000233 85..                 sta     dp:.tiny _Dp
    \ 000235 8a                   txa
    \ 000236 22......             jsl     long:_Float32EQ
    \ 00023a f031                 beq     `?L254`
    \ 00023c a328     `?L255`:    lda     40,s
    \ 00023e 48                   pha
    \ 00023f a30f                 lda     15,s
    \ 000241 aa                   tax
    \ 000242 a30d                 lda     13,s
    \ 000244 22......             jsl     long:_Float32ToSInt32
    \ 000248 48                   pha
    \ 000249 a6..                 ldx     dp:.tiny (_Dp+14)
    \ 00024b a5..                 lda     dp:.tiny (_Dp+12)
    \ 00024d 22......             jsl     long:_Float32ToSInt32
    \ 000251 85..                 sta     dp:.tiny (_Dp+2)
    \ 000253 a30d                 lda     13,s
    \ 000255 aa                   tax
    \ 000256 a30b                 lda     11,s
    \ 000258 22......             jsl     long:_Float32ToSInt32
    \ 00025c 85..                 sta     dp:.tiny _Dp
    \ 00025e a315                 lda     21,s
    \ 000260 aa                   tax
    \ 000261 a313                 lda     19,s
    \ 000263 22......             jsl     long:_Float32ToSInt32
    \ 000267 22......             jsl     long:plot_line
    \ 00026b 68                   pla
    \ 00026c 68                   pla
    \ 00026d          `?L254`:
    \ 00026d a5..                 lda     dp:.tiny (_Dp+12)
    \ 00026f 8307                 sta     7,s
    \ 000271 a5..                 lda     dp:.tiny (_Dp+14)
    \ 000273 8309                 sta     9,s
    \ 000275 22......             jsl     long:`?L1285`
    \ 000279 a90ad7               lda     ##55050
    \ 00027c a2a33c               ldx     ##15523
    \ 00027f 22......             jsl     long:`?L1340`
    \ 000283 a307                 lda     7,s
    \ 000285 830f                 sta     15,s
    \ 000287 a309                 lda     9,s
    \ 000289 8311                 sta     17,s
    \ 00028b a30b                 lda     11,s
    \ 00028d 8307                 sta     7,s
    \ 00028f a30d                 lda     13,s
    \ 000291 4c....               jmp     .kbank `?L1242`
0716                  		
0717                  // ---------------------------
0718                  // Simple pow function (power), to avoid adding complete Math.h
0719                  // Ernesto Contreras
0720                  // ---------------------------
0721                  float fast_pow(float value,int power)
0722                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public fast_pow
    \ 000000          fast_pow:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+12)
    \ 000004 d4..                 pei     dp:.tiny (_Dp+14)
    \ 000006 5a                   phy
    \ 000007 86..                 stx     dp:.tiny (_Dp+14)
    \ 000009 85..                 sta     dp:.tiny (_Dp+12)
    \ 00000b a5..                 lda     dp:.tiny _Dp
    \ 00000d 85..                 sta     dp:.tiny (_Dp+8)
0723                  	int c;
0724                  	float result;
0725                  	result=1;
    \ 00000f a90000               lda     ##0
    \ 000012 85..                 sta     dp:.tiny _Dp
    \ 000014 a9803f               lda     ##16256
    \ 000017 85..                 sta     dp:.tiny (_Dp+2)
0726                  	for (c=0;c<power;c++)
    \ 000019 a90000               lda     ##0
    \ 00001c 8301                 sta     1,s
    \ 00001e a301     `?L260`:    lda     1,s
    \ 000020 38                   sec
    \ 000021 e5..                 sbc     dp:.tiny (_Dp+8)
    \ 000023 5003                 bvc     `?L729`
    \ 000025 490080               eor     ##-32768
    \ 000028 300f     `?L729`:    bmi     `?L259`
0727                  	{
0728                  		result*=value;
0729                  	}
0730                  	return result;
    \ 00002a a6..                 ldx     dp:.tiny (_Dp+2)
    \ 00002c a5..                 lda     dp:.tiny _Dp
0731                  }
    \ 00002e 7a                   ply
    \ 00002f 7a                   ply
    \ 000030 84..                 sty     dp:.tiny (_Dp+14)
    \ 000032 7a                   ply
    \ 000033 84..                 sty     dp:.tiny (_Dp+12)
    \ 000035 7a                   ply
    \ 000036 84..                 sty     dp:.tiny (_Dp+8)
    \ 000038 6b                   rtl
    \ 000039          `?L259`:
    \ 000039 a6..                 ldx     dp:.tiny (_Dp+14)
    \ 00003b a5..                 lda     dp:.tiny (_Dp+12)
    \ 00003d 22......             jsl     long:`?L1273`
    \ 000041 a301                 lda     1,s
    \ 000043 1a                   inc     a
    \ 000044 8301                 sta     1,s
    \ 000046 a301                 lda     1,s
    \ 000048 80d4                 bra     `?L260`
0732                  
0733                  // ------------------------------------------
0734                  // Graphics Primitives
0735                  // Bresenham Algorithms in C
0736                  // Original Author: Bert Timmerman
0737                  // https://gist.github.com/bert/1085538
0738                  // Modified for Calypsi by Ernesto Contreras 
0739                  // ------------------------------------------
0740                  
0741                  
0742                  //----------------------------------------------------------
0743                  // Plot Line 
0744                  // Bresenham Algorithm
0745                  // Modified by Ernesto Contreras to optimize horizontal line cases (used to fill solid figures & floodfill)
0746                  // --------------------------------------------------------
0747                  void plot_line (int x0, int y0, int x1, int y1, uint8_t col)
0748                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot_line
    \ 000000          plot_line:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 d4..                 pei     dp:.tiny (_Dp+12)
    \ 000006 d4..                 pei     dp:.tiny (_Dp+14)
    \ 000008 a8                   tay
    \ 000009 3b                   tsc
    \ 00000a 38                   sec
    \ 00000b e91400               sbc     ##20
    \ 00000e 1b                   tcs
    \ 00000f 98                   tya
    \ 000010 8307                 sta     7,s
    \ 000012 a5..                 lda     dp:.tiny _Dp
    \ 000014 8309                 sta     9,s
    \ 000016 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000018 8313                 sta     19,s
0749                  long swap;
0750                  uint8_t __far24 *ptr;
0751                  	if (y0==y1) 
    \ 00001a a320                 lda     32,s
    \ 00001c c309                 cmp     9,s
    \ 00001e f003                 beq     `?L1510`
    \ 000020 4c....               jmp     .kbank `?L267`
    \ 000023          `?L1510`:
0752                  	// ------------------------------------------------
0753                      // Optimizations for horizontal Lines
0754                  	// ------------------------------------------------
0755                  	{
0756                  		if (y0<=vickyResY && y0>=0)
    \ 000023 18                   clc
    \ 000024 a20000               ldx     ##0
    \ 000027 a309                 lda     9,s
    \ 000029 1001                 bpl     `?L732`
    \ 00002b ca                   dex
    \ 00002c          `?L732`:
    \ 00002c ed....               sbc     vickyResY
    \ 00002f 8a                   txa
    \ 000030 ed....               sbc     vickyResY+2
    \ 000033 5003                 bvc     `?L734`
    \ 000035 490080               eor     ##-32768
    \ 000038 3003     `?L734`:    bmi     `?L1511`
    \ 00003a 4c....               jmp     .kbank `?L266`
    \ 00003d a309     `?L1511`:   lda     9,s
    \ 00003f 1003                 bpl     `?L1512`
    \ 000041 4c....               jmp     .kbank `?L266`
    \ 000044          `?L1512`:
0757                  		{
0758                  			if (x0>x1)
    \ 000044 a313                 lda     19,s
    \ 000046 38                   sec
    \ 000047 e307                 sbc     7,s
    \ 000049 5003                 bvc     `?L736`
    \ 00004b 490080               eor     ##-32768
    \ 00004e 1019     `?L736`:    bpl     `?L273`
0759                  			{
0760                  				swap=x1;
    \ 000050 a313                 lda     19,s
    \ 000052 a20000               ldx     ##0
    \ 000055 a8                   tay
    \ 000056 1001                 bpl     `?L738`
    \ 000058 ca                   dex
    \ 000059          `?L738`:
    \ 000059 86..                 stx     dp:.tiny (_Dp+2)
    \ 00005b 85..                 sta     dp:.tiny _Dp
0761                  				x1=x0;
    \ 00005d a307                 lda     7,s
    \ 00005f 8301                 sta     1,s
0762                  				x0=swap;
    \ 000061 a5..                 lda     dp:.tiny _Dp
    \ 000063 8303                 sta     3,s
    \ 000065 8303                 sta     3,s
    \ 000067 8008                 bra     `?L274`
    \ 000069 a307     `?L273`:    lda     7,s
    \ 00006b 8303                 sta     3,s
    \ 00006d a313                 lda     19,s
    \ 00006f 8301                 sta     1,s
    \ 000071          `?L274`:
0763                  			}
0764                  			
0765                  			// validate Coordinates
0766                  			if (x1>=vickyResX)
    \ 000071 a20000               ldx     ##0
    \ 000074 a301                 lda     1,s
    \ 000076 1001                 bpl     `?L740`
    \ 000078 ca                   dex
    \ 000079          `?L740`:
    \ 000079 22......             jsl     long:`?L1313`
    \ 00007d 5003                 bvc     `?L742`
    \ 00007f 490080               eor     ##-32768
    \ 000082 300a     `?L742`:    bmi     `?L276`
0767                  				x1=vickyResX-1;
    \ 000084 ad....               lda     vickyResX
    \ 000087 3a                   dec     a
    \ 000088 8301                 sta     1,s
    \ 00008a a301                 lda     1,s
    \ 00008c 8002                 bra     `?L1246`
    \ 00008e a301     `?L276`:    lda     1,s
    \ 000090 8305     `?L1246`:   sta     5,s
0768                  			if (x0>=vickyResX)
    \ 000092 a20000               ldx     ##0
    \ 000095 a303                 lda     3,s
    \ 000097 1001                 bpl     `?L744`
    \ 000099 ca                   dex
    \ 00009a          `?L744`:
    \ 00009a 22......             jsl     long:`?L1313`
    \ 00009e 5003                 bvc     `?L746`
    \ 0000a0 490080               eor     ##-32768
    \ 0000a3 300a     `?L746`:    bmi     `?L280`
0769                  				x0=vickyResX-1;
    \ 0000a5 ad....               lda     vickyResX
    \ 0000a8 3a                   dec     a
    \ 0000a9 8301                 sta     1,s
    \ 0000ab a301                 lda     1,s
    \ 0000ad 8303                 sta     3,s
    \ 0000af          `?L280`:
0770                  			if (x1<0)
    \ 0000af a305                 lda     5,s
    \ 0000b1 1007                 bpl     `?L282`
0771                  				x1=0;
    \ 0000b3 a90000               lda     ##0
    \ 0000b6 8301                 sta     1,s
    \ 0000b8 8002                 bra     `?L1245`
    \ 0000ba 1a       `?L282`:    inc     a
    \ 0000bb 3a                   dec     a
    \ 0000bc 8301     `?L1245`:   sta     1,s
0772                  			if (x0<0)
    \ 0000be a303                 lda     3,s
    \ 0000c0 1007                 bpl     `?L286`
0773                  				x0=0;
    \ 0000c2 a90000               lda     ##0
    \ 0000c5 8303                 sta     3,s
    \ 0000c7 8303                 sta     3,s
    \ 0000c9          `?L286`:
0774                  			
0775                  			swap=x1-x0;
    \ 0000c9 a301                 lda     1,s
    \ 0000cb 38                   sec
    \ 0000cc e303                 sbc     3,s
    \ 0000ce a20000               ldx     ##0
    \ 0000d1 a8                   tay
    \ 0000d2 1001                 bpl     `?L748`
    \ 0000d4 ca                   dex
    \ 0000d5          `?L748`:
    \ 0000d5 86..                 stx     dp:.tiny (_Dp+10)
    \ 0000d7 85..                 sta     dp:.tiny (_Dp+8)
0776                  			// ----------------------------------------------------
0777                  			//if line crosses a 64k page use setPixel (safer slower method) 
0778                  			// ----------------------------------------------------
0779                  			if (((swap+x0+y0*vickyResX) & 0xffff) < ((x0+y0*vickyResX) & 0xffff) )
    \ 0000d9 a303                 lda     3,s
    \ 0000db a20000               ldx     ##0
    \ 0000de a8                   tay
    \ 0000df 1001                 bpl     `?L750`
    \ 0000e1 ca                   dex
    \ 0000e2 18       `?L750`:    clc
    \ 0000e3 65..                 adc     dp:.tiny (_Dp+8)
    \ 0000e5 48                   pha
    \ 0000e6 8a                   txa
    \ 0000e7 65..                 adc     dp:.tiny (_Dp+10)
    \ 0000e9 aa                   tax
    \ 0000ea 68                   pla
    \ 0000eb 22......             jsl     long:`?L1347`
    \ 0000ef 1001                 bpl     `?L752`
    \ 0000f1 ca                   dex
    \ 0000f2          `?L752`:
    \ 0000f2 22......             jsl     long:`?L1275`
    \ 0000f6 65..                 adc     dp:.tiny (_Dp+12)
    \ 0000f8 48                   pha
    \ 0000f9 8a                   txa
    \ 0000fa 65..                 adc     dp:.tiny (_Dp+14)
    \ 0000fc aa                   tax
    \ 0000fd 68                   pla
    \ 0000fe 86..                 stx     dp:.tiny (_Dp+2)
    \ 000100 85..                 sta     dp:.tiny _Dp
    \ 000102 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000104 290000               and     ##0
    \ 000107 aa                   tax
    \ 000108 a5..                 lda     dp:.tiny _Dp
    \ 00010a 29ffff               and     ##65535
    \ 00010d 86..                 stx     dp:.tiny (_Dp+2)
    \ 00010f 85..                 sta     dp:.tiny _Dp
    \ 000111 d4..                 pei     dp:.tiny (_Dp+2)
    \ 000113 d4..                 pei     dp:.tiny _Dp
    \ 000115 a307                 lda     7,s
    \ 000117 a20000               ldx     ##0
    \ 00011a a8                   tay
    \ 00011b 1001                 bpl     `?L755`
    \ 00011d ca                   dex
    \ 00011e          `?L755`:
    \ 00011e 86..                 stx     dp:.tiny (_Dp+14)
    \ 000120 85..                 sta     dp:.tiny (_Dp+12)
    \ 000122 a30d                 lda     13,s
    \ 000124 a20000               ldx     ##0
    \ 000127 a8                   tay
    \ 000128 1001                 bpl     `?L757`
    \ 00012a ca                   dex
    \ 00012b          `?L757`:
    \ 00012b 22......             jsl     long:`?L1275`
    \ 00012f 65..                 adc     dp:.tiny (_Dp+12)
    \ 000131 48                   pha
    \ 000132 8a                   txa
    \ 000133 65..                 adc     dp:.tiny (_Dp+14)
    \ 000135 aa                   tax
    \ 000136 68                   pla
    \ 000137 86..                 stx     dp:.tiny (_Dp+6)
    \ 000139 85..                 sta     dp:.tiny (_Dp+4)
    \ 00013b a5..                 lda     dp:.tiny (_Dp+6)
    \ 00013d 290000               and     ##0
    \ 000140 aa                   tax
    \ 000141 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000143 29ffff               and     ##65535
    \ 000146 86..                 stx     dp:.tiny (_Dp+6)
    \ 000148 85..                 sta     dp:.tiny (_Dp+4)
    \ 00014a 22......             jsl     long:_FillDP2
    \ 00014e ..                   .byte   .tiny _Dp
    \ 00014f 22......             jsl     long:_FillDP2
    \ 000153 ..                   .byte   .tiny (_Dp+2)
    \ 000154 a5..                 lda     dp:.tiny _Dp
    \ 000156 c5..                 cmp     dp:.tiny (_Dp+4)
    \ 000158 a5..                 lda     dp:.tiny (_Dp+2)
    \ 00015a e5..                 sbc     dp:.tiny (_Dp+6)
    \ 00015c 5003                 bvc     `?L760`
    \ 00015e 490080               eor     ##-32768
    \ 000161 1070     `?L760`:    bpl     `?L288`
    \ 000163          `?L291`:
0780                  			{
0781                  				do
0782                  				{
0783                  					setPixel_fast(x0+swap--,y0,col);
    \ 000163 22......             jsl     long:`?L1285`
    \ 000167 a5..                 lda     dp:.tiny (_Dp+10)
    \ 000169 aa                   tax
    \ 00016a a5..                 lda     dp:.tiny (_Dp+8)
    \ 00016c d001                 bne     `?L762`
    \ 00016e ca                   dex
    \ 00016f 3a       `?L762`:    dec     a
    \ 000170 86..                 stx     dp:.tiny (_Dp+14)
    \ 000172 85..                 sta     dp:.tiny (_Dp+12)
    \ 000174 a303                 lda     3,s
    \ 000176 a20000               ldx     ##0
    \ 000179 a8                   tay
    \ 00017a 1001                 bpl     `?L764`
    \ 00017c ca                   dex
    \ 00017d 18       `?L764`:    clc
    \ 00017e 65..                 adc     dp:.tiny _Dp
    \ 000180 48                   pha
    \ 000181 8a                   txa
    \ 000182 65..                 adc     dp:.tiny (_Dp+2)
    \ 000184 aa                   tax
    \ 000185 68                   pla
    \ 000186 86..                 stx     dp:.tiny (_Dp+6)
    \ 000188 85..                 sta     dp:.tiny (_Dp+4)
    \ 00018a a309                 lda     9,s
    \ 00018c a20000               ldx     ##0
    \ 00018f a8                   tay
    \ 000190 1001                 bpl     `?L766`
    \ 000192 ca                   dex
    \ 000193          `?L766`:
    \ 000193 86..                 stx     dp:.tiny (_Dp+2)
    \ 000195 85..                 sta     dp:.tiny _Dp
    \ 000197 a6..                 ldx     dp:.tiny (_Dp+6)
    \ 000199 a5..                 lda     dp:.tiny (_Dp+4)
    \ 00019b 18                   clc
    \ 00019c 690000               adc     ##0
    \ 00019f 48                   pha
    \ 0001a0 22......             jsl     long:`?L1336`
    \ 0001a4 68                   pla
    \ 0001a5 22......             jsl     long:`?L1303`
    \ 0001a9 48                   pha
    \ 0001aa 8a                   txa
    \ 0001ab 65..                 adc     dp:.tiny (_Dp+10)
    \ 0001ad aa                   tax
    \ 0001ae 68                   pla
    \ 0001af 22......             jsl     long:`?L1283`
    \ 0001b3 a00100               ldy     ##1
    \ 0001b6 b7..                 lda     [.tiny (_Dp+4)],y
    \ 0001b8 22......             jsl     long:`?L1288`
    \ 0001bc e220                 sep     #32
    \ 0001be a322                 lda     34,s
    \ 0001c0 87..                 sta     [.tiny _Dp]
    \ 0001c2 c220                 rep     #32
0784                  				}while (swap>=0);
    \ 0001c4 a5..                 lda     dp:.tiny (_Dp+12)
    \ 0001c6 85..                 sta     dp:.tiny (_Dp+8)
    \ 0001c8 a5..                 lda     dp:.tiny (_Dp+14)
    \ 0001ca 85..                 sta     dp:.tiny (_Dp+10)
    \ 0001cc a5..                 lda     dp:.tiny (_Dp+14)
    \ 0001ce 1093                 bpl     `?L291`
    \ 0001d0 4c....               jmp     .kbank `?L266`
    \ 0001d3          `?L288`:
0785                  			}
0786                  			else
0787                  				//----------------------------------
0788                  				// Use fast pixel laying method!
0789                  				//-----------------------------------
0790                  			{
0791                  				if (vBitPlane[vickyBitmapPage]) // if Bitmap for the page is enabled
    \ 0001d3 22......             jsl     long:`?L1321`
    \ 0001d7 d003                 bne     `?L1513`
    \ 0001d9 4c....               jmp     .kbank `?L266`
    \ 0001dc          `?L1513`:
0792                  				{
0793                  					ptr = 0xb00000+x0+y0*vickyResX;
    \ 0001dc a303                 lda     3,s
    \ 0001de a20000               ldx     ##0
    \ 0001e1 a8                   tay
    \ 0001e2 1001                 bpl     `?L769`
    \ 0001e4 ca                   dex
    \ 0001e5 18       `?L769`:    clc
    \ 0001e6 690000               adc     ##0
    \ 0001e9 48                   pha
    \ 0001ea 22......             jsl     long:`?L1336`
    \ 0001ee 68                   pla
    \ 0001ef 22......             jsl     long:`?L1347`
    \ 0001f3 1001                 bpl     `?L771`
    \ 0001f5 ca                   dex
    \ 0001f6          `?L771`:
    \ 0001f6 22......             jsl     long:`?L1275`
    \ 0001fa 65..                 adc     dp:.tiny (_Dp+12)
    \ 0001fc 48                   pha
    \ 0001fd 8a                   txa
    \ 0001fe 65..                 adc     dp:.tiny (_Dp+14)
    \ 000200 aa                   tax
    \ 000201 68                   pla
    \ 000202 86..                 stx     dp:.tiny (_Dp+14)
    \ 000204 85..                 sta     dp:.tiny (_Dp+12)
0794                  					ptr+= (long)bitplane[vickyBitmapPage].start;
    \ 000206 22......             jsl     long:`?L1319`
    \ 00020a ad....               lda     vickyBitmapPage
    \ 00020d 22......             jsl     long:`?L1287`
    \ 000211 a00100               ldy     ##1
    \ 000214 b7..                 lda     [.tiny _Dp],y
    \ 000216 85..                 sta     dp:.tiny _Dp
    \ 000218 18                   clc
    \ 000219 a5..                 lda     dp:.tiny (_Dp+12)
    \ 00021b 65..                 adc     dp:.tiny _Dp
    \ 00021d 85..                 sta     dp:.tiny (_Dp+12)
    \ 00021f          `?L297`:
0795                  					do 
0796                  					{
0797                  							*(ptr+swap--) = col;
    \ 00021f a5..                 lda     dp:.tiny (_Dp+8)
    \ 000221 85..                 sta     dp:.tiny (_Dp+4)
    \ 000223 a5..                 lda     dp:.tiny (_Dp+10)
    \ 000225 85..                 sta     dp:.tiny (_Dp+6)
    \ 000227 a5..                 lda     dp:.tiny (_Dp+10)
    \ 000229 aa                   tax
    \ 00022a a5..                 lda     dp:.tiny (_Dp+8)
    \ 00022c d001                 bne     `?L774`
    \ 00022e ca                   dex
    \ 00022f 3a       `?L774`:    dec     a
    \ 000230 86..                 stx     dp:.tiny (_Dp+2)
    \ 000232 85..                 sta     dp:.tiny _Dp
    \ 000234 a5..                 lda     dp:.tiny (_Dp+12)
    \ 000236 85..                 sta     dp:.tiny (_Dp+8)
    \ 000238 a5..                 lda     dp:.tiny (_Dp+14)
    \ 00023a 85..                 sta     dp:.tiny (_Dp+10)
    \ 00023c 18                   clc
    \ 00023d a5..                 lda     dp:.tiny (_Dp+8)
    \ 00023f 65..                 adc     dp:.tiny (_Dp+4)
    \ 000241 85..                 sta     dp:.tiny (_Dp+8)
    \ 000243 e220                 sep     #32
    \ 000245 a322                 lda     34,s
    \ 000247 87..                 sta     [.tiny (_Dp+8)]
    \ 000249 c220                 rep     #32
0798                  					}while (swap>=0);
    \ 00024b a5..                 lda     dp:.tiny _Dp
    \ 00024d 85..                 sta     dp:.tiny (_Dp+8)
    \ 00024f a5..                 lda     dp:.tiny (_Dp+2)
    \ 000251 85..                 sta     dp:.tiny (_Dp+10)
    \ 000253 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000255 10c8                 bpl     `?L297`
    \ 000257 4c....               jmp     .kbank `?L266`
    \ 00025a          `?L267`:
0799                  				}
0800                  			}
0801                  		}
0802                  	}
0803                  	else
0804                  	// -------------------------------------
0805                  	// use regular Bresenham method for slanted lines
0806                  	// -------------------------------------
0807                  	{
0808                  		 int dx =  abs (x1 - x0), sx = x0 < x1 ? 1 : -1;
    \ 00025a a313                 lda     19,s
    \ 00025c 38                   sec
    \ 00025d e307                 sbc     7,s
    \ 00025f 22......             jsl     long:abs
    \ 000263 830b                 sta     11,s
    \ 000265 a307                 lda     7,s
    \ 000267 38                   sec
    \ 000268 e313                 sbc     19,s
    \ 00026a 5003                 bvc     `?L777`
    \ 00026c 490080               eor     ##-32768
    \ 00026f 3007     `?L777`:    bmi     `?L480`
    \ 000271 a9ffff               lda     ##-1
    \ 000274 8301                 sta     1,s
    \ 000276 8005                 bra     `?L1244`
    \ 000278 a90100   `?L480`:    lda     ##1
    \ 00027b 8301                 sta     1,s
    \ 00027d 8301     `?L1244`:   sta     1,s
0809                  		 int dy = -abs (y1 - y0), sy = y0 < y1 ? 1 : -1; 
    \ 00027f a320                 lda     32,s
    \ 000281 38                   sec
    \ 000282 e309                 sbc     9,s
    \ 000284 22......             jsl     long:abs
    \ 000288 85..                 sta     dp:.tiny _Dp
    \ 00028a 38                   sec
    \ 00028b a90000               lda     ##0
    \ 00028e e5..                 sbc     dp:.tiny _Dp
    \ 000290 830d                 sta     13,s
    \ 000292 a309                 lda     9,s
    \ 000294 38                   sec
    \ 000295 e320                 sbc     32,s
    \ 000297 5003                 bvc     `?L780`
    \ 000299 490080               eor     ##-32768
    \ 00029c 3007     `?L780`:    bmi     `?L483`
    \ 00029e a9ffff               lda     ##-1
    \ 0002a1 8303                 sta     3,s
    \ 0002a3 8005                 bra     `?L1243`
    \ 0002a5 a90100   `?L483`:    lda     ##1
    \ 0002a8 8303                 sta     3,s
    \ 0002aa 8303     `?L1243`:   sta     3,s
0810                  		 int err = dx + dy, e2; /* error value e_xy */
    \ 0002ac a30d                 lda     13,s
    \ 0002ae 18                   clc
    \ 0002af 630b                 adc     11,s
    \ 0002b1 8305                 sta     5,s
0811                  		 
0812                  		 for (;;)
    \ 0002b3 a307                 lda     7,s
    \ 0002b5 8311                 sta     17,s
    \ 0002b7 a309                 lda     9,s
    \ 0002b9 830f                 sta     15,s
    \ 0002bb a305                 lda     5,s
    \ 0002bd 8307                 sta     7,s
    \ 0002bf          `?L300`:
0813                  		 {  /* loop */
0814                  			setPixel (x0,y0, col);
    \ 0002bf a322                 lda     34,s
    \ 0002c1 48                   pha
    \ 0002c2 a311                 lda     17,s
    \ 0002c4 a20000               ldx     ##0
    \ 0002c7 a8                   tay
    \ 0002c8 1001                 bpl     `?L782`
    \ 0002ca ca                   dex
    \ 0002cb          `?L782`:
    \ 0002cb 86..                 stx     dp:.tiny (_Dp+2)
    \ 0002cd 85..                 sta     dp:.tiny _Dp
    \ 0002cf a313                 lda     19,s
    \ 0002d1 a20000               ldx     ##0
    \ 0002d4 a8                   tay
    \ 0002d5 1001                 bpl     `?L784`
    \ 0002d7 ca                   dex
    \ 0002d8          `?L784`:
    \ 0002d8 22......             jsl     long:setPixel
0815                  			if (x0 == x1 && y0 == y1) break;
    \ 0002dc 68                   pla
    \ 0002dd a313                 lda     19,s
    \ 0002df c311                 cmp     17,s
    \ 0002e1 d019                 bne     `?L305`
    \ 0002e3 a320                 lda     32,s
    \ 0002e5 c30f                 cmp     15,s
    \ 0002e7 d013                 bne     `?L305`
    \ 0002e9          `?L266`:
0816                  			e2 = 2 * err;
0817                  			if (e2 >= dy) { err += dy; x0 += sx; } /* e_xy+e_x > 0 */
0818                  			if (e2 <= dx) { err += dx; y0 += sy; } /* e_xy+e_y < 0 */
0819                  		 }
0820                  	}
0821                  }
    \ 0002e9 3b                   tsc
    \ 0002ea 18                   clc
    \ 0002eb 691400               adc     ##20
    \ 0002ee 1b                   tcs
    \ 0002ef 7a                   ply
    \ 0002f0 84..                 sty     dp:.tiny (_Dp+14)
    \ 0002f2 7a                   ply
    \ 0002f3 84..                 sty     dp:.tiny (_Dp+12)
    \ 0002f5 7a                   ply
    \ 0002f6 84..                 sty     dp:.tiny (_Dp+10)
    \ 0002f8 7a                   ply
    \ 0002f9 84..                 sty     dp:.tiny (_Dp+8)
    \ 0002fb 6b                   rtl
    \ 0002fc a307     `?L305`:    lda     7,s
    \ 0002fe 0a                   asl     a
    \ 0002ff 8309                 sta     9,s
    \ 000301 38                   sec
    \ 000302 e30d                 sbc     13,s
    \ 000304 5003                 bvc     `?L787`
    \ 000306 490080               eor     ##-32768
    \ 000309 3010     `?L787`:    bmi     `?L308`
    \ 00030b a30d                 lda     13,s
    \ 00030d 18                   clc
    \ 00030e 6307                 adc     7,s
    \ 000310 8307                 sta     7,s
    \ 000312 a301                 lda     1,s
    \ 000314 18                   clc
    \ 000315 6311                 adc     17,s
    \ 000317 8305                 sta     5,s
    \ 000319 8002                 bra     `?L1247`
    \ 00031b a311     `?L308`:    lda     17,s
    \ 00031d 8305     `?L1247`:   sta     5,s
    \ 00031f a30b                 lda     11,s
    \ 000321 38                   sec
    \ 000322 e309                 sbc     9,s
    \ 000324 5003                 bvc     `?L789`
    \ 000326 490080               eor     ##-32768
    \ 000329 3010     `?L789`:    bmi     `?L311`
    \ 00032b a30b                 lda     11,s
    \ 00032d 18                   clc
    \ 00032e 6307                 adc     7,s
    \ 000330 8307                 sta     7,s
    \ 000332 a303                 lda     3,s
    \ 000334 18                   clc
    \ 000335 630f                 adc     15,s
    \ 000337 8309                 sta     9,s
    \ 000339 8002                 bra     `?L1248`
    \ 00033b a30f     `?L311`:    lda     15,s
    \ 00033d 8309     `?L1248`:   sta     9,s
    \ 00033f a305                 lda     5,s
    \ 000341 8311                 sta     17,s
    \ 000343 a309                 lda     9,s
    \ 000345 830f                 sta     15,s
    \ 000347 4c....               jmp     .kbank `?L300`
0822                  
0823                  
0824                  void plot_circle (int xm, int ym, int r, uint8_t col)
0825                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot_circle
    \ 000000          plot_circle:
    \ 000000 a8                   tay
    \ 000001 3b                   tsc
    \ 000002 38                   sec
    \ 000003 e90e00               sbc     ##14
    \ 000006 1b                   tcs
    \ 000007 98                   tya
    \ 000008 8307                 sta     7,s
    \ 00000a a5..                 lda     dp:.tiny _Dp
    \ 00000c 8309                 sta     9,s
    \ 00000e a5..                 lda     dp:.tiny (_Dp+2)
    \ 000010 8301                 sta     1,s
0826                     int x = -r, y = 0, err = 2-2*r; /* II. Quadrant */ 
    \ 000012 a301                 lda     1,s
    \ 000014 85..                 sta     dp:.tiny _Dp
    \ 000016 38                   sec
    \ 000017 a90000               lda     ##0
    \ 00001a e5..                 sbc     dp:.tiny _Dp
    \ 00001c aa                   tax
    \ 00001d a00000               ldy     ##0
    \ 000020 a301                 lda     1,s
    \ 000022 0a                   asl     a
    \ 000023 85..                 sta     dp:.tiny _Dp
    \ 000025 a90200               lda     ##2
    \ 000028 38                   sec
    \ 000029 e5..                 sbc     dp:.tiny _Dp
    \ 00002b 8301                 sta     1,s
0827                     {
0828                  	   do {
    \ 00002d 8a                   txa
    \ 00002e 830d                 sta     13,s
    \ 000030 98                   tya
    \ 000031 830b                 sta     11,s
    \ 000033          `?L317`:
0829                  			setPixel (xm-x, ym+y, col); /*   I. Quadrant */
    \ 000033 a312                 lda     18,s
    \ 000035 48                   pha
    \ 000036 a30d                 lda     13,s
    \ 000038 18                   clc
    \ 000039 630b                 adc     11,s
    \ 00003b a20000               ldx     ##0
    \ 00003e a8                   tay
    \ 00003f 1001                 bpl     `?L791`
    \ 000041 ca                   dex
    \ 000042          `?L791`:
    \ 000042 86..                 stx     dp:.tiny (_Dp+2)
    \ 000044 85..                 sta     dp:.tiny _Dp
    \ 000046 a309                 lda     9,s
    \ 000048 38                   sec
    \ 000049 e30f                 sbc     15,s
    \ 00004b a20000               ldx     ##0
    \ 00004e a8                   tay
    \ 00004f 1001                 bpl     `?L793`
    \ 000051 ca                   dex
    \ 000052          `?L793`:
    \ 000052 22......             jsl     long:setPixel
0830                  			setPixel (xm-y, ym-x, col); /*  II. Quadrant */
    \ 000056 68                   pla
    \ 000057 a312                 lda     18,s
    \ 000059 48                   pha
    \ 00005a a30b                 lda     11,s
    \ 00005c 38                   sec
    \ 00005d e30f                 sbc     15,s
    \ 00005f a20000               ldx     ##0
    \ 000062 a8                   tay
    \ 000063 1001                 bpl     `?L796`
    \ 000065 ca                   dex
    \ 000066          `?L796`:
    \ 000066 86..                 stx     dp:.tiny (_Dp+2)
    \ 000068 85..                 sta     dp:.tiny _Dp
    \ 00006a a309                 lda     9,s
    \ 00006c 38                   sec
    \ 00006d e30d                 sbc     13,s
    \ 00006f a20000               ldx     ##0
    \ 000072 a8                   tay
    \ 000073 1001                 bpl     `?L798`
    \ 000075 ca                   dex
    \ 000076          `?L798`:
    \ 000076 22......             jsl     long:setPixel
0831                  			setPixel (xm+x, ym-y, col); /* III. Quadrant */
    \ 00007a 68                   pla
    \ 00007b a312                 lda     18,s
    \ 00007d 48                   pha
    \ 00007e a30b                 lda     11,s
    \ 000080 38                   sec
    \ 000081 e30d                 sbc     13,s
    \ 000083 a20000               ldx     ##0
    \ 000086 a8                   tay
    \ 000087 1001                 bpl     `?L801`
    \ 000089 ca                   dex
    \ 00008a          `?L801`:
    \ 00008a 86..                 stx     dp:.tiny (_Dp+2)
    \ 00008c 85..                 sta     dp:.tiny _Dp
    \ 00008e a30f                 lda     15,s
    \ 000090 18                   clc
    \ 000091 6309                 adc     9,s
    \ 000093 a20000               ldx     ##0
    \ 000096 a8                   tay
    \ 000097 1001                 bpl     `?L803`
    \ 000099 ca                   dex
    \ 00009a          `?L803`:
    \ 00009a 22......             jsl     long:setPixel
0832                  			setPixel (xm+y, ym+x, col); /*  IV. Quadrant */
    \ 00009e 68                   pla
    \ 00009f a312                 lda     18,s
    \ 0000a1 48                   pha
    \ 0000a2 a30f                 lda     15,s
    \ 0000a4 18                   clc
    \ 0000a5 630b                 adc     11,s
    \ 0000a7 a20000               ldx     ##0
    \ 0000aa a8                   tay
    \ 0000ab 1001                 bpl     `?L806`
    \ 0000ad ca                   dex
    \ 0000ae          `?L806`:
    \ 0000ae 86..                 stx     dp:.tiny (_Dp+2)
    \ 0000b0 85..                 sta     dp:.tiny _Dp
    \ 0000b2 a30d                 lda     13,s
    \ 0000b4 18                   clc
    \ 0000b5 6309                 adc     9,s
    \ 0000b7 a20000               ldx     ##0
    \ 0000ba a8                   tay
    \ 0000bb 1001                 bpl     `?L808`
    \ 0000bd ca                   dex
    \ 0000be          `?L808`:
    \ 0000be 22......             jsl     long:setPixel
0833                  		  r = err;
    \ 0000c2 68                   pla
    \ 0000c3 a301                 lda     1,s
    \ 0000c5 8303                 sta     3,s
0834                  		  if (r >  x) err += ++x*2+1; /* e_xy+e_x > 0 */
    \ 0000c7 a30d                 lda     13,s
    \ 0000c9 38                   sec
    \ 0000ca e303                 sbc     3,s
    \ 0000cc 5003                 bvc     `?L811`
    \ 0000ce 490080               eor     ##-32768
    \ 0000d1 1010     `?L811`:    bpl     `?L320`
    \ 0000d3 a30d                 lda     13,s
    \ 0000d5 1a                   inc     a
    \ 0000d6 8305                 sta     5,s
    \ 0000d8 a305                 lda     5,s
    \ 0000da 0a                   asl     a
    \ 0000db 1a                   inc     a
    \ 0000dc 18                   clc
    \ 0000dd 6301                 adc     1,s
    \ 0000df 8301                 sta     1,s
    \ 0000e1 8004                 bra     `?L321`
    \ 0000e3 a30d     `?L320`:    lda     13,s
    \ 0000e5 8305                 sta     5,s
    \ 0000e7          `?L321`:
0835                  		  if (r <= y) err += ++y*2+1; /* e_xy+e_y < 0 */
    \ 0000e7 a30b                 lda     11,s
    \ 0000e9 38                   sec
    \ 0000ea e303                 sbc     3,s
    \ 0000ec 5003                 bvc     `?L813`
    \ 0000ee 490080               eor     ##-32768
    \ 0000f1 3012     `?L813`:    bmi     `?L323`
    \ 0000f3 a30b                 lda     11,s
    \ 0000f5 1a                   inc     a
    \ 0000f6 8303                 sta     3,s
    \ 0000f8 a303                 lda     3,s
    \ 0000fa 0a                   asl     a
    \ 0000fb 1a                   inc     a
    \ 0000fc 18                   clc
    \ 0000fd 6301                 adc     1,s
    \ 0000ff aa                   tax
    \ 000100 8a                   txa
    \ 000101 8301                 sta     1,s
    \ 000103 8004                 bra     `?L319`
    \ 000105 a30b     `?L323`:    lda     11,s
    \ 000107 8303                 sta     3,s
    \ 000109          `?L319`:
0836                  	   } while (x < 0);
    \ 000109 a305                 lda     5,s
    \ 00010b 830d                 sta     13,s
    \ 00010d a303                 lda     3,s
    \ 00010f 830b                 sta     11,s
    \ 000111 a305                 lda     5,s
    \ 000113 1003                 bpl     `?L1514`
    \ 000115 4c....               jmp     .kbank `?L317`
    \ 000118          `?L1514`:
0837                     }
0838                  }
    \ 000118 3b                   tsc
    \ 000119 18                   clc
    \ 00011a 690e00               adc     ##14
    \ 00011d 1b                   tcs
    \ 00011e 6b                   rtl
0839                  
0840                  
0841                  // -------------------------------------------------------------------
0842                  // Midpoint Ellipse Algorithm C++ Code
0843                  // X,y of center point
0844                  // a, b Horizontal, vertical axis length
0845                  // https://educativesite.com/midpoint-ellipse-algorithm-c-code/
0846                  // -------------------------------------------------------------------
0847                  void plot_ellipse(int xc, int yc, double a, double b, uint8_t col)
0848                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot_ellipse
    \ 000000          plot_ellipse:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 d4..                 pei     dp:.tiny (_Dp+12)
    \ 000006 d4..                 pei     dp:.tiny (_Dp+14)
    \ 000008 a8                   tay
    \ 000009 3b                   tsc
    \ 00000a 38                   sec
    \ 00000b e90e00               sbc     ##14
    \ 00000e 1b                   tcs
    \ 00000f 98                   tya
    \ 000010 830b                 sta     11,s
    \ 000012 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000014 85..                 sta     dp:.tiny (_Dp+12)
    \ 000016 a5..                 lda     dp:.tiny (_Dp+6)
    \ 000018 85..                 sta     dp:.tiny (_Dp+14)
    \ 00001a a5..                 lda     dp:.tiny _Dp
    \ 00001c 830d                 sta     13,s
    \ 00001e a31c                 lda     28,s
    \ 000020 85..                 sta     dp:.tiny (_Dp+10)
    \ 000022 a31a                 lda     26,s
    \ 000024 85..                 sta     dp:.tiny (_Dp+8)
0849                      double p=b*b-a*a*b+a*a/4;
    \ 000026 22......             jsl     long:`?L1285`
    \ 00002a a6..                 ldx     dp:.tiny (_Dp+10)
    \ 00002c a5..                 lda     dp:.tiny (_Dp+8)
    \ 00002e 22......             jsl     long:_Float32Mul
    \ 000032 da                   phx
    \ 000033 48                   pha
    \ 000034 22......             jsl     long:`?L1305`
    \ 000038 22......             jsl     long:`?L1270`
    \ 00003c 68                   pla
    \ 00003d fa                   plx
    \ 00003e 22......             jsl     long:_Float32Sub
    \ 000042 da                   phx
    \ 000043 48                   pha
    \ 000044 22......             jsl     long:`?L1289`
    \ 000048 a5..                 lda     dp:.tiny (_Dp+12)
    \ 00004a 22......             jsl     long:`?L1317`
    \ 00004e 22......             jsl     long:_FillDP4
    \ 000052 ..                   .byte   .tiny _Dp
    \ 000053 22......             jsl     long:`?L1342`
0850                      int x=0, y=b;
    \ 000057 a90000               lda     ##0
    \ 00005a 8301                 sta     1,s
    \ 00005c a6..                 ldx     dp:.tiny (_Dp+10)
    \ 00005e a5..                 lda     dp:.tiny (_Dp+8)
    \ 000060 22......             jsl     long:_Float32ToSInt32
    \ 000064 8303                 sta     3,s
0851                  	
0852                      while(2.0*b*b*x <= 2.0*a*a*y)
    \ 000066 a5..                 lda     dp:.tiny _Dp
    \ 000068 8305                 sta     5,s
    \ 00006a a5..                 lda     dp:.tiny (_Dp+2)
    \ 00006c 8307                 sta     7,s
    \ 00006e a301                 lda     1,s
    \ 000070 8309                 sta     9,s
    \ 000072 a90000   `?L329`:    lda     ##0
    \ 000075 22......             jsl     long:`?L1277`
    \ 000079 a4..                 ldy     dp:.tiny (_Dp+12)
    \ 00007b 84..                 sty     dp:.tiny _Dp
    \ 00007d a4..                 ldy     dp:.tiny (_Dp+14)
    \ 00007f 22......             jsl     long:`?L1272`
    \ 000083 a303                 lda     3,s
    \ 000085 a20000               ldx     ##0
    \ 000088 a8                   tay
    \ 000089 1001                 bpl     `?L825`
    \ 00008b ca                   dex
    \ 00008c          `?L825`:
    \ 00008c 22......             jsl     long:_SInt32ToFloat32
    \ 000090 22......             jsl     long:_Float32Mul
    \ 000094 da                   phx
    \ 000095 48                   pha
    \ 000096 a90000               lda     ##0
    \ 000099 a20040               ldx     ##16384
    \ 00009c 22......             jsl     long:`?L1269`
    \ 0000a0 a30d                 lda     13,s
    \ 0000a2 a20000               ldx     ##0
    \ 0000a5 a8                   tay
    \ 0000a6 1001                 bpl     `?L831`
    \ 0000a8 ca                   dex
    \ 0000a9          `?L831`:
    \ 0000a9 22......             jsl     long:_SInt32ToFloat32
    \ 0000ad 22......             jsl     long:`?L1273`
    \ 0000b1 68                   pla
    \ 0000b2 fa                   plx
    \ 0000b3 22......             jsl     long:_Float32LT
    \ 0000b7 b003                 bcs     `?L1515`
    \ 0000b9 4c....               jmp     .kbank `?L330`
    \ 0000bc          `?L1515`:
0853                      {
0854                          if(p < 0)
    \ 0000bc a307                 lda     7,s
    \ 0000be aa                   tax
    \ 0000bf a305                 lda     5,s
    \ 0000c1 a00000               ldy     ##0
    \ 0000c4 84..                 sty     dp:.tiny _Dp
    \ 0000c6 c8                   iny
    \ 0000c7 88                   dey
    \ 0000c8 22......             jsl     long:`?L1315`
    \ 0000cc b05d                 bcs     `?L332`
0855                          {
0856                              x++;
    \ 0000ce a309                 lda     9,s
    \ 0000d0 1a                   inc     a
    \ 0000d1 8301                 sta     1,s
0857                              p = p+2*b*b*x+b*b;
    \ 0000d3 a307                 lda     7,s
    \ 0000d5 85..                 sta     dp:.tiny (_Dp+2)
    \ 0000d7 a305                 lda     5,s
    \ 0000d9 85..                 sta     dp:.tiny _Dp
    \ 0000db d4..                 pei     dp:.tiny (_Dp+2)
    \ 0000dd d4..                 pei     dp:.tiny _Dp
    \ 0000df 98                   tya
    \ 0000e0 a20040               ldx     ##16384
    \ 0000e3 22......             jsl     long:`?L1269`
    \ 0000e7 a305                 lda     5,s
    \ 0000e9 a20000               ldx     ##0
    \ 0000ec a8                   tay
    \ 0000ed 1001                 bpl     `?L839`
    \ 0000ef ca                   dex
    \ 0000f0          `?L839`:
    \ 0000f0 22......             jsl     long:_SInt32ToFloat32
    \ 0000f4 22......             jsl     long:_Float32Mul
    \ 0000f8 22......             jsl     long:_FillDP2
    \ 0000fc ..                   .byte   .tiny _Dp
    \ 0000fd 22......             jsl     long:_FillDP2
    \ 000101 ..                   .byte   .tiny (_Dp+2)
    \ 000102 22......             jsl     long:_Float32Add
    \ 000106 da                   phx
    \ 000107 48                   pha
    \ 000108 22......             jsl     long:`?L1285`
    \ 00010c a6..                 ldx     dp:.tiny (_Dp+10)
    \ 00010e a5..                 lda     dp:.tiny (_Dp+8)
    \ 000110 22......             jsl     long:_Float32Mul
    \ 000114 22......             jsl     long:_FillDP4
    \ 000118 ..                   .byte   .tiny _Dp
    \ 000119 22......             jsl     long:_Float32Add
    \ 00011d 8305                 sta     5,s
    \ 00011f 8a                   txa
    \ 000120 8307                 sta     7,s
    \ 000122 a301                 lda     1,s
    \ 000124 8309                 sta     9,s
    \ 000126 a303                 lda     3,s
    \ 000128 4c....               jmp     .kbank `?L1249`
    \ 00012b          `?L332`:
0858                          }
0859                          else
0860                          {
0861                              x++;
    \ 00012b a309                 lda     9,s
    \ 00012d 1a                   inc     a
    \ 00012e 8301                 sta     1,s
0862                              y--;
    \ 000130 3b                   tsc
0863                              p = p+2*b*b*x-2*a*a*y-b*b;
    \ 000131 22......             jsl     long:`?L1329`
    \ 000135 a307                 lda     7,s
    \ 000137 85..                 sta     dp:.tiny (_Dp+2)
    \ 000139 a305                 lda     5,s
    \ 00013b 85..                 sta     dp:.tiny _Dp
    \ 00013d d4..                 pei     dp:.tiny (_Dp+2)
    \ 00013f d4..                 pei     dp:.tiny _Dp
    \ 000141 98                   tya
    \ 000142 a20040               ldx     ##16384
    \ 000145 22......             jsl     long:`?L1269`
    \ 000149 a305                 lda     5,s
    \ 00014b a20000               ldx     ##0
    \ 00014e a8                   tay
    \ 00014f 1001                 bpl     `?L848`
    \ 000151 ca                   dex
    \ 000152          `?L848`:
    \ 000152 22......             jsl     long:_SInt32ToFloat32
    \ 000156 22......             jsl     long:_Float32Mul
    \ 00015a 22......             jsl     long:_FillDP2
    \ 00015e ..                   .byte   .tiny _Dp
    \ 00015f 22......             jsl     long:_FillDP2
    \ 000163 ..                   .byte   .tiny (_Dp+2)
    \ 000164 22......             jsl     long:_Float32Add
    \ 000168 da                   phx
    \ 000169 48                   pha
    \ 00016a a90000               lda     ##0
    \ 00016d 22......             jsl     long:`?L1277`
    \ 000171 a4..                 ldy     dp:.tiny (_Dp+12)
    \ 000173 84..                 sty     dp:.tiny _Dp
    \ 000175 a4..                 ldy     dp:.tiny (_Dp+14)
    \ 000177 22......             jsl     long:`?L1272`
    \ 00017b a307                 lda     7,s
    \ 00017d a20000               ldx     ##0
    \ 000180 a8                   tay
    \ 000181 1001                 bpl     `?L855`
    \ 000183 ca                   dex
    \ 000184          `?L855`:
    \ 000184 22......             jsl     long:_SInt32ToFloat32
    \ 000188 22......             jsl     long:`?L1273`
    \ 00018c 68                   pla
    \ 00018d fa                   plx
    \ 00018e 22......             jsl     long:_Float32Sub
    \ 000192 da                   phx
    \ 000193 48                   pha
    \ 000194 22......             jsl     long:`?L1307`
    \ 000198 22......             jsl     long:`?L1273`
    \ 00019c 68                   pla
    \ 00019d fa                   plx
    \ 00019e 22......             jsl     long:`?L1309`
    \ 0001a2 8305                 sta     5,s
    \ 0001a4 a5..                 lda     dp:.tiny (_Dp+2)
    \ 0001a6 8307                 sta     7,s
    \ 0001a8 a301                 lda     1,s
    \ 0001aa 8309                 sta     9,s
    \ 0001ac a303                 lda     3,s
    \ 0001ae 8301     `?L1249`:   sta     1,s
0864                          }
0865                          setPixel(xc+x,yc+y,col);
    \ 0001b0 a31e                 lda     30,s
    \ 0001b2 48                   pha
    \ 0001b3 a303                 lda     3,s
    \ 0001b5 22......             jsl     long:`?L1325`
    \ 0001b9 1001                 bpl     `?L862`
    \ 0001bb ca                   dex
    \ 0001bc          `?L862`:
    \ 0001bc 86..                 stx     dp:.tiny (_Dp+2)
    \ 0001be 85..                 sta     dp:.tiny _Dp
    \ 0001c0 a30b                 lda     11,s
    \ 0001c2 22......             jsl     long:`?L1324`
    \ 0001c6 1001                 bpl     `?L864`
    \ 0001c8 ca                   dex
    \ 0001c9          `?L864`:
    \ 0001c9 22......             jsl     long:setPixel
0866                          setPixel(xc+x,yc-y,col);
    \ 0001cd 68                   pla
    \ 0001ce a31e                 lda     30,s
    \ 0001d0 48                   pha
    \ 0001d1 a30f                 lda     15,s
    \ 0001d3 38                   sec
    \ 0001d4 e303                 sbc     3,s
    \ 0001d6 a20000               ldx     ##0
    \ 0001d9 a8                   tay
    \ 0001da 1001                 bpl     `?L867`
    \ 0001dc ca                   dex
    \ 0001dd          `?L867`:
    \ 0001dd 86..                 stx     dp:.tiny (_Dp+2)
    \ 0001df 85..                 sta     dp:.tiny _Dp
    \ 0001e1 a30b                 lda     11,s
    \ 0001e3 22......             jsl     long:`?L1324`
    \ 0001e7 1001                 bpl     `?L869`
    \ 0001e9 ca                   dex
    \ 0001ea          `?L869`:
    \ 0001ea 22......             jsl     long:setPixel
0867                          setPixel(xc-x,yc+y,col);
    \ 0001ee 68                   pla
    \ 0001ef a31e                 lda     30,s
    \ 0001f1 48                   pha
    \ 0001f2 a303                 lda     3,s
    \ 0001f4 22......             jsl     long:`?L1325`
    \ 0001f8 1001                 bpl     `?L872`
    \ 0001fa ca                   dex
    \ 0001fb          `?L872`:
    \ 0001fb 22......             jsl     long:`?L1328`
    \ 0001ff 1001                 bpl     `?L874`
    \ 000201 ca                   dex
    \ 000202          `?L874`:
    \ 000202 22......             jsl     long:setPixel
0868                          setPixel(xc-x,yc-y,col);
    \ 000206 68                   pla
    \ 000207 a31e                 lda     30,s
    \ 000209 48                   pha
    \ 00020a a30f                 lda     15,s
    \ 00020c 38                   sec
    \ 00020d e303                 sbc     3,s
    \ 00020f a20000               ldx     ##0
    \ 000212 a8                   tay
    \ 000213 1001                 bpl     `?L877`
    \ 000215 ca                   dex
    \ 000216          `?L877`:
    \ 000216 22......             jsl     long:`?L1328`
    \ 00021a 1001                 bpl     `?L879`
    \ 00021c ca                   dex
    \ 00021d          `?L879`:
    \ 00021d 22......             jsl     long:setPixel
    \ 000221 68                   pla
    \ 000222 a301                 lda     1,s
    \ 000224 8303                 sta     3,s
    \ 000226 4c....               jmp     .kbank `?L329`
    \ 000229          `?L330`:
0869                      }
0870                   
0871                      p=b*b*(x+0.5)*(x+0.5)+a*a*(y-1)*(y-1)-a*a*b*b;
    \ 000229 22......             jsl     long:`?L1285`
    \ 00022d a6..                 ldx     dp:.tiny (_Dp+10)
    \ 00022f a5..                 lda     dp:.tiny (_Dp+8)
    \ 000231 22......             jsl     long:_Float32Mul
    \ 000235 da                   phx
    \ 000236 48                   pha
    \ 000237 a30d                 lda     13,s
    \ 000239 a20000               ldx     ##0
    \ 00023c a8                   tay
    \ 00023d 1001                 bpl     `?L883`
    \ 00023f ca                   dex
    \ 000240          `?L883`:
    \ 000240 22......             jsl     long:_SInt32ToFloat32
    \ 000244 22......             jsl     long:`?L1281`
    \ 000248 22......             jsl     long:_FillDP4
    \ 00024c ..                   .byte   .tiny _Dp
    \ 00024d 22......             jsl     long:_Float32Mul
    \ 000251 da                   phx
    \ 000252 48                   pha
    \ 000253 a30d                 lda     13,s
    \ 000255 a20000               ldx     ##0
    \ 000258 a8                   tay
    \ 000259 1001                 bpl     `?L888`
    \ 00025b ca                   dex
    \ 00025c          `?L888`:
    \ 00025c 22......             jsl     long:_SInt32ToFloat32
    \ 000260 22......             jsl     long:`?L1281`
    \ 000264 22......             jsl     long:_FillDP4
    \ 000268 ..                   .byte   .tiny _Dp
    \ 000269 22......             jsl     long:_Float32Mul
    \ 00026d da                   phx
    \ 00026e 48                   pha
    \ 00026f 22......             jsl     long:`?L1289`
    \ 000273 a5..                 lda     dp:.tiny (_Dp+12)
    \ 000275 22......             jsl     long:`?L1273`
    \ 000279 a307                 lda     7,s
    \ 00027b 3a                   dec     a
    \ 00027c a20000               ldx     ##0
    \ 00027f a8                   tay
    \ 000280 1001                 bpl     `?L894`
    \ 000282 ca                   dex
    \ 000283          `?L894`:
    \ 000283 22......             jsl     long:_SInt32ToFloat32
    \ 000287 22......             jsl     long:`?L1273`
    \ 00028b a307                 lda     7,s
    \ 00028d 3a                   dec     a
    \ 00028e a20000               ldx     ##0
    \ 000291 a8                   tay
    \ 000292 1001                 bpl     `?L898`
    \ 000294 ca                   dex
    \ 000295          `?L898`:
    \ 000295 22......             jsl     long:_SInt32ToFloat32
    \ 000299 22......             jsl     long:_Float32Mul
    \ 00029d 22......             jsl     long:_FillDP4
    \ 0002a1 ..                   .byte   .tiny _Dp
    \ 0002a2 22......             jsl     long:_Float32Add
    \ 0002a6 da                   phx
    \ 0002a7 48                   pha
    \ 0002a8 22......             jsl     long:`?L1305`
    \ 0002ac 22......             jsl     long:_Float32Mul
    \ 0002b0 22......             jsl     long:`?L1269`
    \ 0002b4 68                   pla
    \ 0002b5 fa                   plx
    \ 0002b6 22......             jsl     long:`?L1309`
0872                      while(y > 0)
    \ 0002ba 8305                 sta     5,s
    \ 0002bc a5..                 lda     dp:.tiny (_Dp+2)
    \ 0002be 8307                 sta     7,s
    \ 0002c0 a309                 lda     9,s
    \ 0002c2 8301                 sta     1,s
    \ 0002c4 a90000   `?L335`:    lda     ##0
    \ 0002c7 38                   sec
    \ 0002c8 e303                 sbc     3,s
    \ 0002ca 5003                 bvc     `?L907`
    \ 0002cc 490080               eor     ##-32768
    \ 0002cf 3003     `?L907`:    bmi     `?L1516`
    \ 0002d1 4c....               jmp     .kbank `?L336`
    \ 0002d4          `?L1516`:
0873                      {
0874                          if(p <= 0)
    \ 0002d4 a307                 lda     7,s
    \ 0002d6 85..                 sta     dp:.tiny (_Dp+2)
    \ 0002d8 a305                 lda     5,s
    \ 0002da 22......             jsl     long:`?L1349`
    \ 0002de 9067                 bcc     `?L338`
0875                          {
0876                              x++;
    \ 0002e0 a301                 lda     1,s
    \ 0002e2 1a                   inc     a
    \ 0002e3 8301                 sta     1,s
0877                              y--;
    \ 0002e5 3b                   tsc
0878                              p = p+2*b*b*x-2*a*a*y+a*a;
    \ 0002e6 22......             jsl     long:`?L1329`
    \ 0002ea a307                 lda     7,s
    \ 0002ec 85..                 sta     dp:.tiny (_Dp+2)
    \ 0002ee a305                 lda     5,s
    \ 0002f0 85..                 sta     dp:.tiny _Dp
    \ 0002f2 d4..                 pei     dp:.tiny (_Dp+2)
    \ 0002f4 d4..                 pei     dp:.tiny _Dp
    \ 0002f6 a90000               lda     ##0
    \ 0002f9 a20040               ldx     ##16384
    \ 0002fc 22......             jsl     long:`?L1269`
    \ 000300 a305                 lda     5,s
    \ 000302 a20000               ldx     ##0
    \ 000305 a8                   tay
    \ 000306 1001                 bpl     `?L912`
    \ 000308 ca                   dex
    \ 000309          `?L912`:
    \ 000309 22......             jsl     long:_SInt32ToFloat32
    \ 00030d 22......             jsl     long:_Float32Mul
    \ 000311 22......             jsl     long:_FillDP2
    \ 000315 ..                   .byte   .tiny _Dp
    \ 000316 22......             jsl     long:_FillDP2
    \ 00031a ..                   .byte   .tiny (_Dp+2)
    \ 00031b 22......             jsl     long:_Float32Add
    \ 00031f da                   phx
    \ 000320 48                   pha
    \ 000321 a90000               lda     ##0
    \ 000324 22......             jsl     long:`?L1277`
    \ 000328 a4..                 ldy     dp:.tiny (_Dp+12)
    \ 00032a 84..                 sty     dp:.tiny _Dp
    \ 00032c a4..                 ldy     dp:.tiny (_Dp+14)
    \ 00032e 22......             jsl     long:`?L1272`
    \ 000332 a307                 lda     7,s
    \ 000334 a20000               ldx     ##0
    \ 000337 a8                   tay
    \ 000338 1001                 bpl     `?L919`
    \ 00033a ca                   dex
    \ 00033b          `?L919`:
    \ 00033b 22......             jsl     long:_SInt32ToFloat32
    \ 00033f 22......             jsl     long:`?L1273`
    \ 000343 68                   pla
    \ 000344 fa                   plx
    \ 000345 802c                 bra     `?L1253`
    \ 000347          `?L338`:
0879                          }
0880                          else
0881                          {
0882                              y--;
    \ 000347 3b                   tsc
0883                              p = p-2*a*a*y+a*a;
    \ 000348 22......             jsl     long:`?L1329`
    \ 00034c a90000               lda     ##0
    \ 00034f 22......             jsl     long:`?L1277`
    \ 000353 a4..                 ldy     dp:.tiny (_Dp+12)
    \ 000355 84..                 sty     dp:.tiny _Dp
    \ 000357 a4..                 ldy     dp:.tiny (_Dp+14)
    \ 000359 22......             jsl     long:`?L1272`
    \ 00035d a303                 lda     3,s
    \ 00035f a20000               ldx     ##0
    \ 000362 a8                   tay
    \ 000363 1001                 bpl     `?L928`
    \ 000365 ca                   dex
    \ 000366          `?L928`:
    \ 000366 22......             jsl     long:_SInt32ToFloat32
    \ 00036a 22......             jsl     long:`?L1273`
    \ 00036e a307                 lda     7,s
    \ 000370 aa                   tax
    \ 000371 a305                 lda     5,s
    \ 000373          `?L1253`:
    \ 000373 22......             jsl     long:_Float32Sub
    \ 000377 da                   phx
    \ 000378 48                   pha
    \ 000379 22......             jsl     long:`?L1289`
    \ 00037d a5..                 lda     dp:.tiny (_Dp+12)
    \ 00037f 22......             jsl     long:_Float32Mul
    \ 000383 22......             jsl     long:_FillDP4
    \ 000387 ..                   .byte   .tiny _Dp
    \ 000388 22......             jsl     long:_Float32Add
    \ 00038c 8305                 sta     5,s
    \ 00038e 8a                   txa
    \ 00038f 8307                 sta     7,s
0884                          }
0885                          setPixel(xc+x,yc+y,col);
    \ 000391 a31e                 lda     30,s
    \ 000393 48                   pha
    \ 000394 a305                 lda     5,s
    \ 000396 22......             jsl     long:`?L1325`
    \ 00039a 1001                 bpl     `?L935`
    \ 00039c ca                   dex
    \ 00039d          `?L935`:
    \ 00039d 86..                 stx     dp:.tiny (_Dp+2)
    \ 00039f 85..                 sta     dp:.tiny _Dp
    \ 0003a1 a303                 lda     3,s
    \ 0003a3 22......             jsl     long:`?L1324`
    \ 0003a7 1001                 bpl     `?L937`
    \ 0003a9 ca                   dex
    \ 0003aa          `?L937`:
    \ 0003aa 22......             jsl     long:setPixel
0886                          setPixel(xc+x,yc-y,col);
    \ 0003ae 68                   pla
    \ 0003af a31e                 lda     30,s
    \ 0003b1 48                   pha
    \ 0003b2 a30f                 lda     15,s
    \ 0003b4 38                   sec
    \ 0003b5 e305                 sbc     5,s
    \ 0003b7 a20000               ldx     ##0
    \ 0003ba a8                   tay
    \ 0003bb 1001                 bpl     `?L940`
    \ 0003bd ca                   dex
    \ 0003be          `?L940`:
    \ 0003be 86..                 stx     dp:.tiny (_Dp+2)
    \ 0003c0 85..                 sta     dp:.tiny _Dp
    \ 0003c2 a303                 lda     3,s
    \ 0003c4 22......             jsl     long:`?L1324`
    \ 0003c8 1001                 bpl     `?L942`
    \ 0003ca ca                   dex
    \ 0003cb          `?L942`:
    \ 0003cb 22......             jsl     long:setPixel
0887                          setPixel(xc-x,yc+y,col);
    \ 0003cf 68                   pla
    \ 0003d0 a31e                 lda     30,s
    \ 0003d2 48                   pha
    \ 0003d3 a305                 lda     5,s
    \ 0003d5 22......             jsl     long:`?L1325`
    \ 0003d9 1001                 bpl     `?L945`
    \ 0003db ca                   dex
    \ 0003dc          `?L945`:
    \ 0003dc 22......             jsl     long:`?L1327`
    \ 0003e0 1001                 bpl     `?L947`
    \ 0003e2 ca                   dex
    \ 0003e3          `?L947`:
    \ 0003e3 22......             jsl     long:setPixel
0888                          setPixel(xc-x,yc-y,col);
    \ 0003e7 68                   pla
    \ 0003e8 a31e                 lda     30,s
    \ 0003ea 48                   pha
    \ 0003eb a30f                 lda     15,s
    \ 0003ed 38                   sec
    \ 0003ee e305                 sbc     5,s
    \ 0003f0 a20000               ldx     ##0
    \ 0003f3 a8                   tay
    \ 0003f4 1001                 bpl     `?L950`
    \ 0003f6 ca                   dex
    \ 0003f7          `?L950`:
    \ 0003f7 22......             jsl     long:`?L1327`
    \ 0003fb 1001                 bpl     `?L952`
    \ 0003fd ca                   dex
    \ 0003fe          `?L952`:
    \ 0003fe 22......             jsl     long:setPixel
    \ 000402 68                   pla
    \ 000403 4c....               jmp     .kbank `?L335`
    \ 000406          `?L336`:
0889                      }
0890                  	// draw final pixels to close the ellipse - Modification Ernesto Contreras 
0891                  	setPixel(xc,(int)(yc+b),col);
    \ 000406 a31e                 lda     30,s
    \ 000408 48                   pha
    \ 000409 a30f                 lda     15,s
    \ 00040b a20000               ldx     ##0
    \ 00040e a8                   tay
    \ 00040f 1001                 bpl     `?L955`
    \ 000411 ca                   dex
    \ 000412          `?L955`:
    \ 000412 22......             jsl     long:_SInt32ToFloat32
    \ 000416 a4..                 ldy     dp:.tiny (_Dp+8)
    \ 000418 84..                 sty     dp:.tiny _Dp
    \ 00041a a4..                 ldy     dp:.tiny (_Dp+10)
    \ 00041c 22......             jsl     long:`?L1282`
    \ 000420 22......             jsl     long:`?L1311`
    \ 000424 1001                 bpl     `?L960`
    \ 000426 ca                   dex
    \ 000427          `?L960`:
    \ 000427 22......             jsl     long:`?L1348`
    \ 00042b 1001                 bpl     `?L962`
    \ 00042d ca                   dex
    \ 00042e          `?L962`:
    \ 00042e 22......             jsl     long:setPixel
0892                  	setPixel(xc,(int)(yc-b),col);
    \ 000432 68                   pla
    \ 000433 a31e                 lda     30,s
    \ 000435 48                   pha
    \ 000436 a30f                 lda     15,s
    \ 000438 a20000               ldx     ##0
    \ 00043b a8                   tay
    \ 00043c 1001                 bpl     `?L965`
    \ 00043e ca                   dex
    \ 00043f          `?L965`:
    \ 00043f 22......             jsl     long:_SInt32ToFloat32
    \ 000443 a4..                 ldy     dp:.tiny (_Dp+8)
    \ 000445 84..                 sty     dp:.tiny _Dp
    \ 000447 a4..                 ldy     dp:.tiny (_Dp+10)
    \ 000449 84..                 sty     dp:.tiny (_Dp+2)
    \ 00044b 22......             jsl     long:_Float32Sub
    \ 00044f 22......             jsl     long:`?L1311`
    \ 000453 1001                 bpl     `?L970`
    \ 000455 ca                   dex
    \ 000456          `?L970`:
    \ 000456 22......             jsl     long:`?L1348`
    \ 00045a 1001                 bpl     `?L972`
    \ 00045c ca                   dex
    \ 00045d          `?L972`:
    \ 00045d 22......             jsl     long:setPixel
    \ 000461 68                   pla
0893                  }
    \ 000462 3b                   tsc
    \ 000463 18                   clc
    \ 000464 690e00               adc     ##14
    \ 000467 5c......             jmp     long:`?L1268`
0894                  
0895                  //----------------------------------------------
0896                  // Modified MidPoint ellipse algorith to draw a "Faster" Solid Ellipse
0897                  // By Ernesto Contreras
0898                  // ---------------------------------------------
0899                  void plot_solid_ellipse(int xc, int yc, double a, double b, uint8_t col)
0900                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot_solid_ellipse
    \ 000000          plot_solid_ellipse:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 d4..                 pei     dp:.tiny (_Dp+12)
    \ 000006 d4..                 pei     dp:.tiny (_Dp+14)
    \ 000008 a8                   tay
    \ 000009 3b                   tsc
    \ 00000a 38                   sec
    \ 00000b e91600               sbc     ##22
    \ 00000e 1b                   tcs
    \ 00000f 98                   tya
    \ 000010 8313                 sta     19,s
    \ 000012 a5..                 lda     dp:.tiny _Dp
    \ 000014 8315                 sta     21,s
    \ 000016 a324                 lda     36,s
    \ 000018 85..                 sta     dp:.tiny (_Dp+14)
    \ 00001a a322                 lda     34,s
    \ 00001c 85..                 sta     dp:.tiny (_Dp+12)
0901                  	// 1 pixel height or width ellipses are not allowed!!, force at least 2 pixels in either dimension
0902                  	if (a==1) {a++;}
    \ 00001e 22......             jsl     long:`?L1332`
    \ 000022 a90000               lda     ##0
    \ 000025 a2803f               ldx     ##16256
    \ 000028 22......             jsl     long:_Float32EQ
    \ 00002c d00f                 bne     `?L344`
    \ 00002e 22......             jsl     long:`?L1332`
    \ 000032 a90000               lda     ##0
    \ 000035 e8                   inx
    \ 000036 ca                   dex
    \ 000037 22......             jsl     long:`?L1340`
    \ 00003b 8008                 bra     `?L345`
    \ 00003d          `?L344`:
    \ 00003d a5..                 lda     dp:.tiny (_Dp+4)
    \ 00003f 85..                 sta     dp:.tiny (_Dp+8)
    \ 000041 a5..                 lda     dp:.tiny (_Dp+6)
    \ 000043 85..                 sta     dp:.tiny (_Dp+10)
    \ 000045          `?L345`:
0903                  	if (b==1) {b++;}
    \ 000045 22......             jsl     long:`?L1337`
    \ 000049 a2803f               ldx     ##16256
    \ 00004c 22......             jsl     long:_Float32EQ
    \ 000050 d00e                 bne     `?L348`
    \ 000052 22......             jsl     long:`?L1337`
    \ 000056 e8                   inx
    \ 000057 ca                   dex
    \ 000058 22......             jsl     long:_Float32Add
    \ 00005c 86..                 stx     dp:.tiny (_Dp+14)
    \ 00005e 85..                 sta     dp:.tiny (_Dp+12)
    \ 000060          `?L348`:
0904                  	
0905                      double p=b*b-a*a*b+a*a/4;
    \ 000060 22......             jsl     long:`?L1289`
    \ 000064 a5..                 lda     dp:.tiny (_Dp+12)
    \ 000066 22......             jsl     long:_Float32Mul
    \ 00006a da                   phx
    \ 00006b 48                   pha
    \ 00006c 22......             jsl     long:`?L1307`
    \ 000070 22......             jsl     long:_Float32Mul
    \ 000074 a4..                 ldy     dp:.tiny (_Dp+12)
    \ 000076 84..                 sty     dp:.tiny _Dp
    \ 000078 a4..                 ldy     dp:.tiny (_Dp+14)
    \ 00007a 22......             jsl     long:`?L1272`
    \ 00007e 68                   pla
    \ 00007f fa                   plx
    \ 000080 22......             jsl     long:_Float32Sub
    \ 000084 da                   phx
    \ 000085 48                   pha
    \ 000086 22......             jsl     long:`?L1285`
    \ 00008a a6..                 ldx     dp:.tiny (_Dp+10)
    \ 00008c a5..                 lda     dp:.tiny (_Dp+8)
    \ 00008e 22......             jsl     long:`?L1317`
    \ 000092 22......             jsl     long:_FillDP4
    \ 000096 ..                   .byte   .tiny _Dp
    \ 000097 22......             jsl     long:_Float32Add
    \ 00009b 8301                 sta     1,s
    \ 00009d 8a                   txa
    \ 00009e 8303                 sta     3,s
0906                      int x=0, y=b;
    \ 0000a0 a90000               lda     ##0
    \ 0000a3 8305                 sta     5,s
    \ 0000a5 a6..                 ldx     dp:.tiny (_Dp+14)
    \ 0000a7 a5..                 lda     dp:.tiny (_Dp+12)
    \ 0000a9 22......             jsl     long:_Float32ToSInt32
    \ 0000ad 8307                 sta     7,s
0907                  	int ra,rb;
0908                  	
0909                  	ra=(int) a*(0.70);
    \ 0000af a6..                 ldx     dp:.tiny (_Dp+10)
    \ 0000b1 a5..                 lda     dp:.tiny (_Dp+8)
    \ 0000b3 22......             jsl     long:`?L1311`
    \ 0000b7 1001                 bpl     `?L988`
    \ 0000b9 ca                   dex
    \ 0000ba          `?L988`:
    \ 0000ba 22......             jsl     long:`?L1334`
    \ 0000be a0333f               ldy     ##16179
    \ 0000c1 22......             jsl     long:`?L1279`
    \ 0000c5 22......             jsl     long:_Float32ToSInt32
    \ 0000c9 8311                 sta     17,s
0910                  	rb=(int) b*(0.70);
    \ 0000cb a6..                 ldx     dp:.tiny (_Dp+14)
    \ 0000cd a5..                 lda     dp:.tiny (_Dp+12)
    \ 0000cf 22......             jsl     long:`?L1311`
    \ 0000d3 1001                 bpl     `?L994`
    \ 0000d5 ca                   dex
    \ 0000d6          `?L994`:
    \ 0000d6 22......             jsl     long:`?L1334`
    \ 0000da a0333f               ldy     ##16179
    \ 0000dd 22......             jsl     long:`?L1279`
    \ 0000e1 22......             jsl     long:_Float32ToSInt32
    \ 0000e5 830d                 sta     13,s
0911                  	
0912                  	// plot solid square with VDMA inside ellipse to save precious time!
0913                  	plot_solid_rectangle(xc-ra,yc-rb,xc+ra,yc+rb,col);
    \ 0000e7 a326                 lda     38,s
    \ 0000e9 48                   pha
    \ 0000ea a30f                 lda     15,s
    \ 0000ec 18                   clc
    \ 0000ed 6317                 adc     23,s
    \ 0000ef 48                   pha
    \ 0000f0 a315                 lda     21,s
    \ 0000f2 22......             jsl     long:`?L1330`
    \ 0000f6 e311                 sbc     17,s
    \ 0000f8 85..                 sta     dp:.tiny _Dp
    \ 0000fa a317                 lda     23,s
    \ 0000fc 38                   sec
    \ 0000fd e315                 sbc     21,s
    \ 0000ff 22......             jsl     long:plot_solid_rectangle
0914                  	
0915                      while(2.0*b*b*x <= 2.0*a*a*y)
    \ 000103 68                   pla
    \ 000104 68                   pla
    \ 000105 a305                 lda     5,s
    \ 000107 830f                 sta     15,s
    \ 000109 a90000   `?L350`:    lda     ##0
    \ 00010c a20040               ldx     ##16384
    \ 00010f 22......             jsl     long:`?L1269`
    \ 000113 a307                 lda     7,s
    \ 000115 a20000               ldx     ##0
    \ 000118 a8                   tay
    \ 000119 1001                 bpl     `?L1002`
    \ 00011b ca                   dex
    \ 00011c          `?L1002`:
    \ 00011c 22......             jsl     long:_SInt32ToFloat32
    \ 000120 22......             jsl     long:_Float32Mul
    \ 000124 da                   phx
    \ 000125 48                   pha
    \ 000126 a90000               lda     ##0
    \ 000129 22......             jsl     long:`?L1277`
    \ 00012d a4..                 ldy     dp:.tiny (_Dp+12)
    \ 00012f 84..                 sty     dp:.tiny _Dp
    \ 000131 a4..                 ldy     dp:.tiny (_Dp+14)
    \ 000133 22......             jsl     long:`?L1272`
    \ 000137 a313                 lda     19,s
    \ 000139 a20000               ldx     ##0
    \ 00013c a8                   tay
    \ 00013d 1001                 bpl     `?L1008`
    \ 00013f ca                   dex
    \ 000140          `?L1008`:
    \ 000140 22......             jsl     long:_SInt32ToFloat32
    \ 000144 22......             jsl     long:`?L1273`
    \ 000148 68                   pla
    \ 000149 fa                   plx
    \ 00014a 22......             jsl     long:_Float32LT
    \ 00014e b003                 bcs     `?L1517`
    \ 000150 4c....               jmp     .kbank `?L351`
    \ 000153          `?L1517`:
0916                      {
0917                          if(p < 0)
    \ 000153 a303                 lda     3,s
    \ 000155 aa                   tax
    \ 000156 a301                 lda     1,s
    \ 000158 a00000               ldy     ##0
    \ 00015b 84..                 sty     dp:.tiny _Dp
    \ 00015d c8                   iny
    \ 00015e 88                   dey
    \ 00015f 22......             jsl     long:`?L1315`
    \ 000163 b065                 bcs     `?L353`
0918                          {
0919                              x++;
    \ 000165 a30f                 lda     15,s
    \ 000167 1a                   inc     a
    \ 000168 8305                 sta     5,s
0920                              p = p+2*b*b*x+b*b;
    \ 00016a a303                 lda     3,s
    \ 00016c 85..                 sta     dp:.tiny (_Dp+2)
    \ 00016e a301                 lda     1,s
    \ 000170 85..                 sta     dp:.tiny _Dp
    \ 000172 d4..                 pei     dp:.tiny (_Dp+2)
    \ 000174 d4..                 pei     dp:.tiny _Dp
    \ 000176 98                   tya
    \ 000177 22......             jsl     long:`?L1277`
    \ 00017b a4..                 ldy     dp:.tiny (_Dp+12)
    \ 00017d 84..                 sty     dp:.tiny _Dp
    \ 00017f a4..                 ldy     dp:.tiny (_Dp+14)
    \ 000181 22......             jsl     long:`?L1272`
    \ 000185 a309                 lda     9,s
    \ 000187 a20000               ldx     ##0
    \ 00018a a8                   tay
    \ 00018b 1001                 bpl     `?L1016`
    \ 00018d ca                   dex
    \ 00018e          `?L1016`:
    \ 00018e 22......             jsl     long:_SInt32ToFloat32
    \ 000192 22......             jsl     long:_Float32Mul
    \ 000196 22......             jsl     long:_FillDP2
    \ 00019a ..                   .byte   .tiny _Dp
    \ 00019b 22......             jsl     long:_FillDP2
    \ 00019f ..                   .byte   .tiny (_Dp+2)
    \ 0001a0 22......             jsl     long:_Float32Add
    \ 0001a4 da                   phx
    \ 0001a5 48                   pha
    \ 0001a6 22......             jsl     long:`?L1289`
    \ 0001aa a5..                 lda     dp:.tiny (_Dp+12)
    \ 0001ac 22......             jsl     long:_Float32Mul
    \ 0001b0 22......             jsl     long:_FillDP4
    \ 0001b4 ..                   .byte   .tiny _Dp
    \ 0001b5 22......             jsl     long:`?L1342`
    \ 0001b9 a5..                 lda     dp:.tiny _Dp
    \ 0001bb 8301                 sta     1,s
    \ 0001bd a5..                 lda     dp:.tiny (_Dp+2)
    \ 0001bf 8303                 sta     3,s
    \ 0001c1 a305                 lda     5,s
    \ 0001c3 8309                 sta     9,s
    \ 0001c5 a307                 lda     7,s
    \ 0001c7 4c....               jmp     .kbank `?L1255`
    \ 0001ca          `?L353`:
0921                          }
0922                          else
0923                          {
0924                              x++;
    \ 0001ca a30f                 lda     15,s
    \ 0001cc 1a                   inc     a
    \ 0001cd 8305                 sta     5,s
0925                              y--;
    \ 0001cf 3b                   tsc
    \ 0001d0 18                   clc
    \ 0001d1 690700               adc     ##7
    \ 0001d4 aa                   tax
    \ 0001d5 de0000               dec     0,x
0926                              p = p+2*b*b*x-2*a*a*y-b*b;
    \ 0001d8 a303                 lda     3,s
    \ 0001da 85..                 sta     dp:.tiny (_Dp+2)
    \ 0001dc a301                 lda     1,s
    \ 0001de 85..                 sta     dp:.tiny _Dp
    \ 0001e0 d4..                 pei     dp:.tiny (_Dp+2)
    \ 0001e2 d4..                 pei     dp:.tiny _Dp
    \ 0001e4 98                   tya
    \ 0001e5 22......             jsl     long:`?L1277`
    \ 0001e9 a4..                 ldy     dp:.tiny (_Dp+12)
    \ 0001eb 84..                 sty     dp:.tiny _Dp
    \ 0001ed a4..                 ldy     dp:.tiny (_Dp+14)
    \ 0001ef 22......             jsl     long:`?L1272`
    \ 0001f3 a309                 lda     9,s
    \ 0001f5 a20000               ldx     ##0
    \ 0001f8 a8                   tay
    \ 0001f9 1001                 bpl     `?L1025`
    \ 0001fb ca                   dex
    \ 0001fc          `?L1025`:
    \ 0001fc 22......             jsl     long:_SInt32ToFloat32
    \ 000200 22......             jsl     long:_Float32Mul
    \ 000204 22......             jsl     long:_FillDP2
    \ 000208 ..                   .byte   .tiny _Dp
    \ 000209 22......             jsl     long:_FillDP2
    \ 00020d ..                   .byte   .tiny (_Dp+2)
    \ 00020e 22......             jsl     long:_Float32Add
    \ 000212 da                   phx
    \ 000213 48                   pha
    \ 000214 a90000               lda     ##0
    \ 000217 a20040               ldx     ##16384
    \ 00021a 22......             jsl     long:`?L1269`
    \ 00021e a30b                 lda     11,s
    \ 000220 a20000               ldx     ##0
    \ 000223 a8                   tay
    \ 000224 1001                 bpl     `?L1032`
    \ 000226 ca                   dex
    \ 000227          `?L1032`:
    \ 000227 22......             jsl     long:_SInt32ToFloat32
    \ 00022b 22......             jsl     long:`?L1273`
    \ 00022f 68                   pla
    \ 000230 fa                   plx
    \ 000231 22......             jsl     long:_Float32Sub
    \ 000235 da                   phx
    \ 000236 48                   pha
    \ 000237 22......             jsl     long:`?L1305`
    \ 00023b 22......             jsl     long:`?L1273`
    \ 00023f 68                   pla
    \ 000240 fa                   plx
    \ 000241 22......             jsl     long:`?L1309`
    \ 000245 8301                 sta     1,s
    \ 000247 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000249 8303                 sta     3,s
    \ 00024b a305                 lda     5,s
    \ 00024d 8309                 sta     9,s
    \ 00024f a307                 lda     7,s
    \ 000251 8305     `?L1255`:   sta     5,s
0927                          }
0928                  		plot_line(xc-x,yc+y,xc+x,yc+y,col);
    \ 000253 a326                 lda     38,s
    \ 000255 48                   pha
    \ 000256 a307                 lda     7,s
    \ 000258 18                   clc
    \ 000259 6317                 adc     23,s
    \ 00025b 48                   pha
    \ 00025c a30d                 lda     13,s
    \ 00025e 18                   clc
    \ 00025f 6317                 adc     23,s
    \ 000261 85..                 sta     dp:.tiny (_Dp+2)
    \ 000263 a309                 lda     9,s
    \ 000265 18                   clc
    \ 000266 6319                 adc     25,s
    \ 000268 22......             jsl     long:`?L1333`
0929                  		plot_line(xc-x,yc-y,xc+x,yc-y,col);
    \ 00026c 68                   pla
    \ 00026d 68                   pla
    \ 00026e a326                 lda     38,s
    \ 000270 48                   pha
    \ 000271 a317                 lda     23,s
    \ 000273 38                   sec
    \ 000274 e307                 sbc     7,s
    \ 000276 48                   pha
    \ 000277 a30d                 lda     13,s
    \ 000279 22......             jsl     long:`?L1330`
    \ 00027d e309                 sbc     9,s
    \ 00027f 22......             jsl     long:`?L1333`
    \ 000283 68                   pla
    \ 000284 68                   pla
    \ 000285 a309                 lda     9,s
    \ 000287 830f                 sta     15,s
    \ 000289 a305                 lda     5,s
    \ 00028b 8307                 sta     7,s
    \ 00028d 4c....               jmp     .kbank `?L350`
    \ 000290          `?L351`:
0930                      }
0931                   
0932                      p=b*b*(x+0.5)*(x+0.5)+a*a*(y-1)*(y-1)-a*a*b*b;
    \ 000290 22......             jsl     long:`?L1289`
    \ 000294 a5..                 lda     dp:.tiny (_Dp+12)
    \ 000296 22......             jsl     long:_Float32Mul
    \ 00029a da                   phx
    \ 00029b 48                   pha
    \ 00029c a313                 lda     19,s
    \ 00029e a20000               ldx     ##0
    \ 0002a1 a8                   tay
    \ 0002a2 1001                 bpl     `?L1042`
    \ 0002a4 ca                   dex
    \ 0002a5          `?L1042`:
    \ 0002a5 22......             jsl     long:_SInt32ToFloat32
    \ 0002a9 22......             jsl     long:`?L1281`
    \ 0002ad 22......             jsl     long:_FillDP4
    \ 0002b1 ..                   .byte   .tiny _Dp
    \ 0002b2 22......             jsl     long:_Float32Mul
    \ 0002b6 da                   phx
    \ 0002b7 48                   pha
    \ 0002b8 a313                 lda     19,s
    \ 0002ba a20000               ldx     ##0
    \ 0002bd a8                   tay
    \ 0002be 1001                 bpl     `?L1047`
    \ 0002c0 ca                   dex
    \ 0002c1          `?L1047`:
    \ 0002c1 22......             jsl     long:_SInt32ToFloat32
    \ 0002c5 22......             jsl     long:`?L1281`
    \ 0002c9 22......             jsl     long:_FillDP4
    \ 0002cd ..                   .byte   .tiny _Dp
    \ 0002ce 22......             jsl     long:_Float32Mul
    \ 0002d2 da                   phx
    \ 0002d3 48                   pha
    \ 0002d4 22......             jsl     long:`?L1285`
    \ 0002d8 a6..                 ldx     dp:.tiny (_Dp+10)
    \ 0002da a5..                 lda     dp:.tiny (_Dp+8)
    \ 0002dc 22......             jsl     long:`?L1273`
    \ 0002e0 a30b                 lda     11,s
    \ 0002e2 3a                   dec     a
    \ 0002e3 a20000               ldx     ##0
    \ 0002e6 a8                   tay
    \ 0002e7 1001                 bpl     `?L1053`
    \ 0002e9 ca                   dex
    \ 0002ea          `?L1053`:
    \ 0002ea 22......             jsl     long:_SInt32ToFloat32
    \ 0002ee 22......             jsl     long:`?L1273`
    \ 0002f2 a30b                 lda     11,s
    \ 0002f4 3a                   dec     a
    \ 0002f5 a20000               ldx     ##0
    \ 0002f8 a8                   tay
    \ 0002f9 1001                 bpl     `?L1057`
    \ 0002fb ca                   dex
    \ 0002fc          `?L1057`:
    \ 0002fc 22......             jsl     long:_SInt32ToFloat32
    \ 000300 22......             jsl     long:_Float32Mul
    \ 000304 22......             jsl     long:_FillDP4
    \ 000308 ..                   .byte   .tiny _Dp
    \ 000309 22......             jsl     long:_Float32Add
    \ 00030d da                   phx
    \ 00030e 48                   pha
    \ 00030f 22......             jsl     long:`?L1307`
    \ 000313 22......             jsl     long:_Float32Mul
    \ 000317 22......             jsl     long:`?L1278`
    \ 00031b a4..                 ldy     dp:.tiny (_Dp+12)
    \ 00031d 84..                 sty     dp:.tiny _Dp
    \ 00031f a4..                 ldy     dp:.tiny (_Dp+14)
    \ 000321 22......             jsl     long:`?L1272`
    \ 000325 68                   pla
    \ 000326 fa                   plx
    \ 000327 22......             jsl     long:`?L1309`
0933                      while(y > 0)
    \ 00032b 8309                 sta     9,s
    \ 00032d a5..                 lda     dp:.tiny (_Dp+2)
    \ 00032f 830b                 sta     11,s
    \ 000331 a30f                 lda     15,s
    \ 000333 8305                 sta     5,s
    \ 000335 a307                 lda     7,s
    \ 000337 8301     `?L1254`:   sta     1,s
    \ 000339 a90000               lda     ##0
    \ 00033c 38                   sec
    \ 00033d e301                 sbc     1,s
    \ 00033f 5003                 bvc     `?L1066`
    \ 000341 490080               eor     ##-32768
    \ 000344 3003     `?L1066`:   bmi     `?L1518`
    \ 000346 4c....               jmp     .kbank `?L343`
    \ 000349          `?L1518`:
0934                      {
0935                          if(p <= 0)
    \ 000349 a30b                 lda     11,s
    \ 00034b 85..                 sta     dp:.tiny (_Dp+2)
    \ 00034d a309                 lda     9,s
    \ 00034f 22......             jsl     long:`?L1349`
    \ 000353 9065                 bcc     `?L359`
0936                          {
0937                              x++;
    \ 000355 a305                 lda     5,s
    \ 000357 1a                   inc     a
    \ 000358 8305                 sta     5,s
0938                              y--;
    \ 00035a a301                 lda     1,s
    \ 00035c 3a                   dec     a
    \ 00035d 8307                 sta     7,s
0939                              p = p+2*b*b*x-2*a*a*y+a*a;
    \ 00035f a30b                 lda     11,s
    \ 000361 85..                 sta     dp:.tiny (_Dp+2)
    \ 000363 a309                 lda     9,s
    \ 000365 85..                 sta     dp:.tiny _Dp
    \ 000367 d4..                 pei     dp:.tiny (_Dp+2)
    \ 000369 d4..                 pei     dp:.tiny _Dp
    \ 00036b 8a                   txa
    \ 00036c 22......             jsl     long:`?L1277`
    \ 000370 a4..                 ldy     dp:.tiny (_Dp+12)
    \ 000372 84..                 sty     dp:.tiny _Dp
    \ 000374 a4..                 ldy     dp:.tiny (_Dp+14)
    \ 000376 22......             jsl     long:`?L1272`
    \ 00037a a309                 lda     9,s
    \ 00037c a20000               ldx     ##0
    \ 00037f a8                   tay
    \ 000380 1001                 bpl     `?L1071`
    \ 000382 ca                   dex
    \ 000383          `?L1071`:
    \ 000383 22......             jsl     long:_SInt32ToFloat32
    \ 000387 22......             jsl     long:_Float32Mul
    \ 00038b 22......             jsl     long:_FillDP2
    \ 00038f ..                   .byte   .tiny _Dp
    \ 000390 22......             jsl     long:_FillDP2
    \ 000394 ..                   .byte   .tiny (_Dp+2)
    \ 000395 22......             jsl     long:_Float32Add
    \ 000399 da                   phx
    \ 00039a 48                   pha
    \ 00039b a90000               lda     ##0
    \ 00039e a20040               ldx     ##16384
    \ 0003a1 22......             jsl     long:`?L1269`
    \ 0003a5 a30b                 lda     11,s
    \ 0003a7 a20000               ldx     ##0
    \ 0003aa a8                   tay
    \ 0003ab 1001                 bpl     `?L1078`
    \ 0003ad ca                   dex
    \ 0003ae          `?L1078`:
    \ 0003ae 22......             jsl     long:_SInt32ToFloat32
    \ 0003b2 22......             jsl     long:`?L1273`
    \ 0003b6 68                   pla
    \ 0003b7 fa                   plx
    \ 0003b8 8023                 bra     `?L1259`
    \ 0003ba          `?L359`:
0940                          }
0941                          else
0942                          {
0943                              y--;
    \ 0003ba a301                 lda     1,s
    \ 0003bc 3a                   dec     a
    \ 0003bd 8307                 sta     7,s
0944                              p = p-2*a*a*y+a*a;
    \ 0003bf 8a                   txa
    \ 0003c0 a20040               ldx     ##16384
    \ 0003c3 22......             jsl     long:`?L1269`
    \ 0003c7 a307                 lda     7,s
    \ 0003c9 a20000               ldx     ##0
    \ 0003cc a8                   tay
    \ 0003cd 1001                 bpl     `?L1087`
    \ 0003cf ca                   dex
    \ 0003d0          `?L1087`:
    \ 0003d0 22......             jsl     long:_SInt32ToFloat32
    \ 0003d4 22......             jsl     long:`?L1273`
    \ 0003d8 a30b                 lda     11,s
    \ 0003da aa                   tax
    \ 0003db a309                 lda     9,s
    \ 0003dd          `?L1259`:
    \ 0003dd 22......             jsl     long:_Float32Sub
    \ 0003e1 da                   phx
    \ 0003e2 48                   pha
    \ 0003e3 22......             jsl     long:`?L1285`
    \ 0003e7 a6..                 ldx     dp:.tiny (_Dp+10)
    \ 0003e9 a5..                 lda     dp:.tiny (_Dp+8)
    \ 0003eb 22......             jsl     long:_Float32Mul
    \ 0003ef 22......             jsl     long:_FillDP4
    \ 0003f3 ..                   .byte   .tiny _Dp
    \ 0003f4 22......             jsl     long:`?L1342`
    \ 0003f8 a5..                 lda     dp:.tiny _Dp
    \ 0003fa 8301                 sta     1,s
    \ 0003fc a5..                 lda     dp:.tiny (_Dp+2)
    \ 0003fe 8303                 sta     3,s
0945                          }
0946                  		if (a>b)
    \ 000400 a6..                 ldx     dp:.tiny (_Dp+14)
    \ 000402 a5..                 lda     dp:.tiny (_Dp+12)
    \ 000404 22......             jsl     long:`?L1314`
    \ 000408 b03d                 bcs     `?L362`
0947                  		{
0948                  			plot_line(xc-ra,yc+y,xc-x,yc+y,col);
    \ 00040a a326                 lda     38,s
    \ 00040c 48                   pha
    \ 00040d a309                 lda     9,s
    \ 00040f 18                   clc
    \ 000410 6317                 adc     23,s
    \ 000412 48                   pha
    \ 000413 22......             jsl     long:`?L1296`
0949                  			plot_line(xc+ra,yc+y,xc+x,yc+y,col);
    \ 000417 a32a                 lda     42,s
    \ 000419 48                   pha
    \ 00041a a30d                 lda     13,s
    \ 00041c 18                   clc
    \ 00041d 631b                 adc     27,s
    \ 00041f 48                   pha
    \ 000420 22......             jsl     long:`?L1292`
0950                  			plot_line(xc-ra,yc-y,xc-x,yc-y,col);
    \ 000424 a32e                 lda     46,s
    \ 000426 48                   pha
    \ 000427 a31f                 lda     31,s
    \ 000429 38                   sec
    \ 00042a e311                 sbc     17,s
    \ 00042c 48                   pha
    \ 00042d 22......             jsl     long:`?L1297`
0951                  			plot_line(xc+ra,yc-y,xc+x,yc-y,col);
    \ 000431 a332                 lda     50,s
    \ 000433 48                   pha
    \ 000434 a323                 lda     35,s
    \ 000436 38                   sec
    \ 000437 e315                 sbc     21,s
    \ 000439 48                   pha
    \ 00043a 22......             jsl     long:`?L1293`
    \ 00043e 3b                   tsc
    \ 00043f 18                   clc
    \ 000440 691000               adc     ##16
    \ 000443 1b                   tcs
    \ 000444 4c....               jmp     .kbank `?L363`
    \ 000447          `?L362`:
0952                  		}
0953                  		else
0954                  		{
0955                  			if (yc-y<yc-rb)
    \ 000447 a315                 lda     21,s
    \ 000449 38                   sec
    \ 00044a e307                 sbc     7,s
    \ 00044c 48                   pha
    \ 00044d a317                 lda     23,s
    \ 00044f 38                   sec
    \ 000450 e30f                 sbc     15,s
    \ 000452 85..                 sta     dp:.tiny _Dp
    \ 000454 68                   pla
    \ 000455 38                   sec
    \ 000456 e5..                 sbc     dp:.tiny _Dp
    \ 000458 5003                 bvc     `?L1099`
    \ 00045a 490080               eor     ##-32768
    \ 00045d 1028     `?L1099`:   bpl     `?L365`
0956                  			{
0957                  				plot_line(xc-x,yc-y,xc+x,yc-y,col);
    \ 00045f a326                 lda     38,s
    \ 000461 48                   pha
    \ 000462 a317                 lda     23,s
    \ 000464 38                   sec
    \ 000465 e309                 sbc     9,s
    \ 000467 48                   pha
    \ 000468 a309                 lda     9,s
    \ 00046a 22......             jsl     long:`?L1330`
    \ 00046e e30b                 sbc     11,s
    \ 000470 22......             jsl     long:`?L1295`
0958                  				plot_line(xc-x,yc+y,xc+x,yc+y,col);
    \ 000474 68                   pla
    \ 000475 68                   pla
    \ 000476 a326                 lda     38,s
    \ 000478 48                   pha
    \ 000479 a309                 lda     9,s
    \ 00047b 18                   clc
    \ 00047c 6317                 adc     23,s
    \ 00047e 48                   pha
    \ 00047f 22......             jsl     long:`?L1294`
    \ 000483 68                   pla
    \ 000484 68                   pla
    \ 000485 8059                 bra     `?L363`
    \ 000487          `?L365`:
0959                  			}
0960                  			else
0961                  			{
0962                  				// special case - if you remove it a line wont be completely filled in vertical ellipses
0963                  				if (yc-y==yc-rb) {plot_line(xc-x,yc+y,xc+x,yc+y,col);}
    \ 000487 a315                 lda     21,s
    \ 000489 38                   sec
    \ 00048a e307                 sbc     7,s
    \ 00048c 85..                 sta     dp:.tiny _Dp
    \ 00048e a315                 lda     21,s
    \ 000490 38                   sec
    \ 000491 e30d                 sbc     13,s
    \ 000493 c5..                 cmp     dp:.tiny _Dp
    \ 000495 d00f                 bne     `?L369`
    \ 000497 a326                 lda     38,s
    \ 000499 48                   pha
    \ 00049a a309                 lda     9,s
    \ 00049c 18                   clc
    \ 00049d 6317                 adc     23,s
    \ 00049f 48                   pha
    \ 0004a0 22......             jsl     long:`?L1294`
    \ 0004a4 68                   pla
    \ 0004a5 68                   pla
    \ 0004a6          `?L369`:
0964                  				plot_line(xc-ra,yc+y,xc-x,yc+y,col);
    \ 0004a6 a326                 lda     38,s
    \ 0004a8 48                   pha
    \ 0004a9 a309                 lda     9,s
    \ 0004ab 18                   clc
    \ 0004ac 6317                 adc     23,s
    \ 0004ae 48                   pha
    \ 0004af 22......             jsl     long:`?L1296`
0965                  				plot_line(xc+ra,yc+y,xc+x,yc+y,col);
    \ 0004b3 a32a                 lda     42,s
    \ 0004b5 48                   pha
    \ 0004b6 a30d                 lda     13,s
    \ 0004b8 18                   clc
    \ 0004b9 631b                 adc     27,s
    \ 0004bb 48                   pha
    \ 0004bc 22......             jsl     long:`?L1292`
0966                  				plot_line(xc-ra,yc-y,xc-x,yc-y,col);
    \ 0004c0 a32e                 lda     46,s
    \ 0004c2 48                   pha
    \ 0004c3 a31f                 lda     31,s
    \ 0004c5 38                   sec
    \ 0004c6 e311                 sbc     17,s
    \ 0004c8 48                   pha
    \ 0004c9 22......             jsl     long:`?L1297`
0967                  				plot_line(xc+ra,yc-y,xc+x,yc-y,col);
    \ 0004cd a332                 lda     50,s
    \ 0004cf 48                   pha
    \ 0004d0 a323                 lda     35,s
    \ 0004d2 38                   sec
    \ 0004d3 e315                 sbc     21,s
    \ 0004d5 48                   pha
    \ 0004d6 22......             jsl     long:`?L1293`
    \ 0004da 3b                   tsc
    \ 0004db 18                   clc
    \ 0004dc 691000               adc     ##16
    \ 0004df 1b                   tcs
    \ 0004e0 a301     `?L363`:    lda     1,s
    \ 0004e2 8309                 sta     9,s
    \ 0004e4 a303                 lda     3,s
    \ 0004e6 830b                 sta     11,s
    \ 0004e8 a307                 lda     7,s
    \ 0004ea 4c....               jmp     .kbank `?L1254`
    \ 0004ed          `?L343`:
0968                  			}
0969                  		}
0970                      }
0971                  }
    \ 0004ed 3b                   tsc
    \ 0004ee 18                   clc
    \ 0004ef 691600               adc     ##22
    \ 0004f2 1b       `?L1268`:   tcs
    \ 0004f3 7a                   ply
    \ 0004f4 84..                 sty     dp:.tiny (_Dp+14)
    \ 0004f6 7a                   ply
    \ 0004f7 84..                 sty     dp:.tiny (_Dp+12)
    \ 0004f9 7a                   ply
    \ 0004fa 84..                 sty     dp:.tiny (_Dp+10)
    \ 0004fc 7a                   ply
    \ 0004fd 84..                 sty     dp:.tiny (_Dp+8)
    \ 0004ff 6b                   rtl
0972                  
0973                  //--------------------------------------
0974                  // "Faster" Solid Circle
0975                  // By Ernesto Contreras 
0976                  //--------------------------------------
0977                  void plot_solid_circle(int xc,int yc, int r, uint8_t col) 
0978                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot_solid_circle
    \ 000000          plot_solid_circle:
    \ 000000 a8                   tay
    \ 000001 3b                   tsc
    \ 000002 38                   sec
    \ 000003 e90e00               sbc     ##14
    \ 000006 1b                   tcs
    \ 000007 98                   tya
    \ 000008 8309                 sta     9,s
    \ 00000a a5..                 lda     dp:.tiny _Dp
    \ 00000c 830b                 sta     11,s
    \ 00000e a5..                 lda     dp:.tiny (_Dp+2)
    \ 000010 8301                 sta     1,s
0979                  	int x;
0980                  	int y;
0981                  	int p;
0982                  	int r1;
0983                  	r1=(int)(r*0.70);
    \ 000012 a301                 lda     1,s
    \ 000014 a20000               ldx     ##0
    \ 000017 a8                   tay
    \ 000018 1001                 bpl     `?L1108`
    \ 00001a ca                   dex
    \ 00001b          `?L1108`:
    \ 00001b 22......             jsl     long:`?L1334`
    \ 00001f a0333f               ldy     ##16179
    \ 000022 22......             jsl     long:`?L1279`
    \ 000026 22......             jsl     long:_Float32ToSInt32
    \ 00002a 8307                 sta     7,s
0984                  	
0985                  	// 1 pixel radius circles are not allowed!!, force 2 radius!
0986                  	if (r==1) {r++;}
    \ 00002c a301                 lda     1,s
    \ 00002e c90100               cmp     ##1
    \ 000031 d007                 bne     `?L1260`
    \ 000033 a301                 lda     1,s
    \ 000035 1a                   inc     a
    \ 000036 8301                 sta     1,s
    \ 000038 a301                 lda     1,s
    \ 00003a 8303     `?L1260`:   sta     3,s
0987                  
0988                  	// plot solid square with VDMA inside circle to save precious time!
0989                  	plot_solid_rectangle (xc-r1,yc-r1,xc+r1,yc+r1,col);
    \ 00003c a312                 lda     18,s
    \ 00003e 48                   pha
    \ 00003f a309                 lda     9,s
    \ 000041 18                   clc
    \ 000042 630d                 adc     13,s
    \ 000044 48                   pha
    \ 000045 a30b                 lda     11,s
    \ 000047 18                   clc
    \ 000048 630d                 adc     13,s
    \ 00004a 85..                 sta     dp:.tiny (_Dp+2)
    \ 00004c a30f                 lda     15,s
    \ 00004e 38                   sec
    \ 00004f e30b                 sbc     11,s
    \ 000051 85..                 sta     dp:.tiny _Dp
    \ 000053 a30d                 lda     13,s
    \ 000055 38                   sec
    \ 000056 e30b                 sbc     11,s
    \ 000058 22......             jsl     long:plot_solid_rectangle
0990                  	x = 0;
    \ 00005c 68                   pla
    \ 00005d 68                   pla
    \ 00005e a90000               lda     ##0
    \ 000061 8301                 sta     1,s
0991                  	y = r;
    \ 000063 a303                 lda     3,s
    \ 000065 8301                 sta     1,s
0992                  	p=3-(2*r);
    \ 000067 1a                   inc     a
    \ 000068 3a                   dec     a
    \ 000069 0a                   asl     a
    \ 00006a 85..                 sta     dp:.tiny _Dp
    \ 00006c a90300               lda     ##3
    \ 00006f 38                   sec
    \ 000070 e5..                 sbc     dp:.tiny _Dp
    \ 000072 8303                 sta     3,s
0993                  
0994                  	for(x=0;x<=y;x++)
    \ 000074 a90000               lda     ##0
    \ 000077 830d                 sta     13,s
    \ 000079 a301                 lda     1,s
    \ 00007b 8305                 sta     5,s
    \ 00007d a303                 lda     3,s
    \ 00007f 8301                 sta     1,s
    \ 000081 a305     `?L378`:    lda     5,s
    \ 000083 38                   sec
    \ 000084 e30d                 sbc     13,s
    \ 000086 5003                 bvc     `?L1114`
    \ 000088 490080               eor     ##-32768
    \ 00008b 102b     `?L1114`:   bpl     `?L377`
0995                  	{
0996                  		if (p < 0)
0997                  			{
0998                  				p = p + (4 * x)+6;
0999                  			}
1000                  			else
1001                  			{
1002                  				y=y-1;
1003                  				p = p +4 *(x-y)+10;
1004                  			}
1005                  		plot_line(xc+x,yc-y,xc-x,yc-y,col);
1006                  		plot_line(xc+x,yc+y,xc-x,yc+y,col);
1007                  		plot_line(xc-y,yc-x,xc-r1,yc-x,col);
1008                  		plot_line(xc+r1,yc-x,xc+y,yc-x,col);
1009                  		plot_line(xc-y,yc+x,xc-r1,yc+x,col);
1010                  		plot_line(xc+r1,yc+x,xc+y,yc+x,col);
1011                  	}
1012                  	// special case if you remove it on certain circles a line won't be filled
1013                  	plot_line(xc-x,yc+y-1,xc+x,yc+y-1,col);
    \ 00008d a312                 lda     18,s
    \ 00008f 48                   pha
    \ 000090 a307                 lda     7,s
    \ 000092 18                   clc
    \ 000093 630d                 adc     13,s
    \ 000095 3a                   dec     a
    \ 000096 48                   pha
    \ 000097 a311                 lda     17,s
    \ 000099 18                   clc
    \ 00009a 630d                 adc     13,s
    \ 00009c 85..                 sta     dp:.tiny (_Dp+2)
    \ 00009e a309                 lda     9,s
    \ 0000a0 18                   clc
    \ 0000a1 630f                 adc     15,s
    \ 0000a3 3a                   dec     a
    \ 0000a4 85..                 sta     dp:.tiny _Dp
    \ 0000a6 a30d                 lda     13,s
    \ 0000a8 38                   sec
    \ 0000a9 e311                 sbc     17,s
    \ 0000ab 22......             jsl     long:plot_line
    \ 0000af 68                   pla
    \ 0000b0 68                   pla
1014                  }
    \ 0000b1 3b                   tsc
    \ 0000b2 18                   clc
    \ 0000b3 690e00               adc     ##14
    \ 0000b6 1b                   tcs
    \ 0000b7 6b                   rtl
    \ 0000b8 a301     `?L377`:    lda     1,s
    \ 0000ba 100f                 bpl     `?L381`
    \ 0000bc a30d                 lda     13,s
    \ 0000be 0a                   asl     a
    \ 0000bf 0a                   asl     a
    \ 0000c0 18                   clc
    \ 0000c1 6301                 adc     1,s
    \ 0000c3 18                   clc
    \ 0000c4 690600               adc     ##6
    \ 0000c7 8301                 sta     1,s
    \ 0000c9 8019                 bra     `?L382`
    \ 0000cb a305     `?L381`:    lda     5,s
    \ 0000cd 3a                   dec     a
    \ 0000ce 8303                 sta     3,s
    \ 0000d0 a30d                 lda     13,s
    \ 0000d2 38                   sec
    \ 0000d3 e303                 sbc     3,s
    \ 0000d5 0a                   asl     a
    \ 0000d6 0a                   asl     a
    \ 0000d7 18                   clc
    \ 0000d8 6301                 adc     1,s
    \ 0000da 18                   clc
    \ 0000db 690a00               adc     ##10
    \ 0000de 8301                 sta     1,s
    \ 0000e0 a303                 lda     3,s
    \ 0000e2 8305                 sta     5,s
    \ 0000e4 a312     `?L382`:    lda     18,s
    \ 0000e6 48                   pha
    \ 0000e7 a30d                 lda     13,s
    \ 0000e9 38                   sec
    \ 0000ea e307                 sbc     7,s
    \ 0000ec 48                   pha
    \ 0000ed a30d                 lda     13,s
    \ 0000ef 38                   sec
    \ 0000f0 e311                 sbc     17,s
    \ 0000f2 85..                 sta     dp:.tiny (_Dp+2)
    \ 0000f4 a30f                 lda     15,s
    \ 0000f6 38                   sec
    \ 0000f7 e309                 sbc     9,s
    \ 0000f9 85..                 sta     dp:.tiny _Dp
    \ 0000fb a311                 lda     17,s
    \ 0000fd 18                   clc
    \ 0000fe 630d                 adc     13,s
    \ 000100 22......             jsl     long:plot_line
    \ 000104 a316                 lda     22,s
    \ 000106 48                   pha
    \ 000107 a30b                 lda     11,s
    \ 000109 18                   clc
    \ 00010a 6311                 adc     17,s
    \ 00010c 48                   pha
    \ 00010d a311                 lda     17,s
    \ 00010f 38                   sec
    \ 000110 e315                 sbc     21,s
    \ 000112 85..                 sta     dp:.tiny (_Dp+2)
    \ 000114 a30d                 lda     13,s
    \ 000116 18                   clc
    \ 000117 6313                 adc     19,s
    \ 000119 85..                 sta     dp:.tiny _Dp
    \ 00011b a315                 lda     21,s
    \ 00011d 18                   clc
    \ 00011e 6311                 adc     17,s
    \ 000120 22......             jsl     long:plot_line
    \ 000124 a31a                 lda     26,s
    \ 000126 48                   pha
    \ 000127 a315                 lda     21,s
    \ 000129 38                   sec
    \ 00012a e317                 sbc     23,s
    \ 00012c 48                   pha
    \ 00012d a315                 lda     21,s
    \ 00012f 38                   sec
    \ 000130 e313                 sbc     19,s
    \ 000132 85..                 sta     dp:.tiny (_Dp+2)
    \ 000134 a317                 lda     23,s
    \ 000136 38                   sec
    \ 000137 e319                 sbc     25,s
    \ 000139 85..                 sta     dp:.tiny _Dp
    \ 00013b a315                 lda     21,s
    \ 00013d 38                   sec
    \ 00013e e311                 sbc     17,s
    \ 000140 22......             jsl     long:plot_line
    \ 000144 a31e                 lda     30,s
    \ 000146 48                   pha
    \ 000147 a319                 lda     25,s
    \ 000149 38                   sec
    \ 00014a e31b                 sbc     27,s
    \ 00014c 48                   pha
    \ 00014d a315                 lda     21,s
    \ 00014f 18                   clc
    \ 000150 6319                 adc     25,s
    \ 000152 85..                 sta     dp:.tiny (_Dp+2)
    \ 000154 a31b                 lda     27,s
    \ 000156 38                   sec
    \ 000157 e31d                 sbc     29,s
    \ 000159 85..                 sta     dp:.tiny _Dp
    \ 00015b a317                 lda     23,s
    \ 00015d 18                   clc
    \ 00015e 6319                 adc     25,s
    \ 000160 22......             jsl     long:plot_line
    \ 000164 a322                 lda     34,s
    \ 000166 48                   pha
    \ 000167 a31f                 lda     31,s
    \ 000169 18                   clc
    \ 00016a 631d                 adc     29,s
    \ 00016c 48                   pha
    \ 00016d a31d                 lda     29,s
    \ 00016f 38                   sec
    \ 000170 e31b                 sbc     27,s
    \ 000172 85..                 sta     dp:.tiny (_Dp+2)
    \ 000174 a321                 lda     33,s
    \ 000176 18                   clc
    \ 000177 631f                 adc     31,s
    \ 000179 85..                 sta     dp:.tiny _Dp
    \ 00017b a31d                 lda     29,s
    \ 00017d 38                   sec
    \ 00017e e319                 sbc     25,s
    \ 000180 22......             jsl     long:plot_line
    \ 000184 3b                   tsc
    \ 000185 18                   clc
    \ 000186 691400               adc     ##20
    \ 000189 1b                   tcs
    \ 00018a a312                 lda     18,s
    \ 00018c 48                   pha
    \ 00018d a30f                 lda     15,s
    \ 00018f 18                   clc
    \ 000190 630d                 adc     13,s
    \ 000192 48                   pha
    \ 000193 a309                 lda     9,s
    \ 000195 18                   clc
    \ 000196 630d                 adc     13,s
    \ 000198 85..                 sta     dp:.tiny (_Dp+2)
    \ 00019a a311                 lda     17,s
    \ 00019c 18                   clc
    \ 00019d 630f                 adc     15,s
    \ 00019f 85..                 sta     dp:.tiny _Dp
    \ 0001a1 a30b                 lda     11,s
    \ 0001a3 18                   clc
    \ 0001a4 630d                 adc     13,s
    \ 0001a6 22......             jsl     long:plot_line
    \ 0001aa 68                   pla
    \ 0001ab 68                   pla
    \ 0001ac a30d                 lda     13,s
    \ 0001ae 1a                   inc     a
    \ 0001af 8303                 sta     3,s
    \ 0001b1 a303                 lda     3,s
    \ 0001b3 830d                 sta     13,s
    \ 0001b5 4c....               jmp     .kbank `?L378`
1015                  
1016                  
1017                  
1018                  //------------------------------------------------------------------------------
1019                  // Scanline floodfill algorithm using stack instead of recursion, more robust
1020                  // Modified floodFillScanlineStack(int x, int y, int newColor, int oldColor)
1021                  // Credits to Lode Vandevenne.
1022                  // https://lodev.org/cgtutor/floodfill.html
1023                  // modified by Ernesto Contreras 
1024                  // -----------------------------------------------------------------------------
1025                  void floodFill(int x, int y, uint8_t newColor)
1026                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public floodFill
    \ 000000 a8       floodFill:  tay
    \ 000001 3b                   tsc
    \ 000002 38                   sec
    \ 000003 e90e0c               sbc     ##3086
    \ 000006 1b                   tcs
    \ 000007 98                   tya
    \ 000008 8309                 sta     9,s
    \ 00000a a5..                 lda     dp:.tiny _Dp
    \ 00000c 830c                 sta     12,s
1027                  // Global Array for Pixel buffer read
1028                    int st, dbcount;
1029                    uint8_t oldColor;
1030                    int x1;
1031                    int xInit;
1032                    
1033                    // Use of static to ask for this buffer memory only Once!
1034                    uint8_t BufferAbove[1024];
1035                    uint8_t BufferCurrent[1024];
1036                    uint8_t BufferBelow[1024];
1037                  
1038                    // init variables
1039                    x1=0;
1040                    xInit=0;
1041                    dbcount=0;
1042                    stackTop=0;
    \ 00000e a20000               ldx     ##0
    \ 000011 8e....               stx     stackTop
1043                    st=0;
1044                   
1045                   // Init Floodfill Algorithm
1046                    st=getScanLine(y,BufferCurrent);  // read "current" scan line y into bufferCurrent[]
    \ 000014 3b                   tsc
    \ 000015 22......             jsl     long:`?L1323`
    \ 000019 8301                 sta     1,s
1047                    oldColor=BufferCurrent[x];
    \ 00001b 3b                   tsc
    \ 00001c 18                   clc
    \ 00001d 690e08               adc     ##2062
    \ 000020 a8                   tay
    \ 000021 b309                 lda     (9,s),y
    \ 000023 e220                 sep     #32
    \ 000025 830b                 sta     11,s
    \ 000027 c220                 rep     #32
1048                    if(oldColor == newColor) return;
    \ 000029 3b                   tsc
    \ 00002a 18                   clc
    \ 00002b 69120c               adc     ##3090
    \ 00002e aa                   tax
    \ 00002f bd0000               lda     0,x
    \ 000032 e220                 sep     #32
    \ 000034 c30b                 cmp     11,s
    \ 000036 c220                 rep     #32
    \ 000038 d003                 bne     `?L1519`
    \ 00003a 4c....               jmp     .kbank `?L386`
    \ 00003d          `?L1519`:
1049                    // Global Buffers for FloodFill
1050                    bool spanAbove, spanBelow;
1051                    stackPush(x, y);
    \ 00003d a30c                 lda     12,s
    \ 00003f 85..                 sta     dp:.tiny _Dp
    \ 000041 a309                 lda     9,s
    \ 000043 22......             jsl     long:stackPush
    \ 000047          `?L391`:
1052                    while(stackPop(&x, &y))
    \ 000047 3b                   tsc
    \ 000048 18                   clc
    \ 000049 690c00               adc     ##12
    \ 00004c 85..                 sta     dp:.tiny _Dp
    \ 00004e 3b                   tsc
    \ 00004f 18                   clc
    \ 000050 690900               adc     ##9
    \ 000053 22......             jsl     long:stackPop
    \ 000057 1a                   inc     a
    \ 000058 3a                   dec     a
    \ 000059 d003                 bne     `?L1520`
    \ 00005b 4c....               jmp     .kbank `?L386`
    \ 00005e          `?L1520`:
1053                    {
1054                  	if (y>=1)
    \ 00005e a30c                 lda     12,s
    \ 000060 38                   sec
    \ 000061 e90100               sbc     ##1
    \ 000064 5003                 bvc     `?L1126`
    \ 000066 490080               eor     ##-32768
    \ 000069 3012     `?L1126`:   bmi     `?L395`
1055                  		st=getScanLine(y-1,BufferAbove);  // read scan line "above" line y into bufferAbove[]
    \ 00006b 3b                   tsc
    \ 00006c 18                   clc
    \ 00006d 690e00               adc     ##14
    \ 000070 85..                 sta     dp:.tiny _Dp
    \ 000072 64..                 stz     dp:.tiny (_Dp+2)
    \ 000074 a30c                 lda     12,s
    \ 000076 3a                   dec     a
    \ 000077 22......             jsl     long:getScanLine
    \ 00007b 8301                 sta     1,s
    \ 00007d          `?L395`:
1056                  	if (y>=0)
    \ 00007d a30c                 lda     12,s
    \ 00007f 3007                 bmi     `?L398`
1057                  		st=getScanLine(y,BufferCurrent);  // read "current" scan line y into bufferCurrent[]
    \ 000081 3b                   tsc
    \ 000082 22......             jsl     long:`?L1323`
    \ 000086 8301                 sta     1,s
    \ 000088          `?L398`:
1058                  	if (y < vickyResY-1)
    \ 000088 a30c                 lda     12,s
    \ 00008a a20000               ldx     ##0
    \ 00008d a8                   tay
    \ 00008e 1001                 bpl     `?L1130`
    \ 000090 ca                   dex
    \ 000091          `?L1130`:
    \ 000091 22......             jsl     long:`?L1322`
    \ 000095 d001                 bne     `?L1132`
    \ 000097 ca                   dex
    \ 000098          `?L1132`:
    \ 000098 22......             jsl     long:`?L1301`
    \ 00009c 5003                 bvc     `?L1134`
    \ 00009e 490080               eor     ##-32768
    \ 0000a1 1012     `?L1134`:   bpl     `?L401`
1059                  		st=getScanLine(y+1,BufferBelow);  // read scan line "below" line y into bufferBelow[]
    \ 0000a3 3b                   tsc
    \ 0000a4 18                   clc
    \ 0000a5 690e04               adc     ##1038
    \ 0000a8 85..                 sta     dp:.tiny _Dp
    \ 0000aa 64..                 stz     dp:.tiny (_Dp+2)
    \ 0000ac a30c                 lda     12,s
    \ 0000ae 1a                   inc     a
    \ 0000af 22......             jsl     long:getScanLine
    \ 0000b3 8301                 sta     1,s
    \ 0000b5          `?L401`:
1060                  
1061                  	x1 = x;
    \ 0000b5 a309                 lda     9,s
    \ 0000b7          `?L1262`:
1062                  	while((x1 >= 0) && BufferCurrent[x1] == oldColor) 
1063                  		x1--; //find leftmost pixel with color != oldcolor to begin fill
    \ 0000b7 a8                   tay
    \ 0000b8 84..                 sty     dp:.tiny _Dp
    \ 0000ba a5..                 lda     dp:.tiny _Dp
    \ 0000bc 301e                 bmi     `?L404`
    \ 0000be 3b                   tsc
    \ 0000bf 18                   clc
    \ 0000c0 690e08               adc     ##2062
    \ 0000c3 84..                 sty     dp:.tiny _Dp
    \ 0000c5 18                   clc
    \ 0000c6 65..                 adc     dp:.tiny _Dp
    \ 0000c8 aa                   tax
    \ 0000c9 a30b                 lda     11,s
    \ 0000cb e220                 sep     #32
    \ 0000cd dd0000               cmp     0,x
    \ 0000d0 c220                 rep     #32
    \ 0000d2 d008                 bne     `?L404`
    \ 0000d4 98                   tya
    \ 0000d5 3a                   dec     a
    \ 0000d6 8301                 sta     1,s
    \ 0000d8 a301                 lda     1,s
    \ 0000da 80db                 bra     `?L1262`
    \ 0000dc          `?L404`:
1064                  	xInit=++x1;
    \ 0000dc 98                   tya
    \ 0000dd 1a                   inc     a
    \ 0000de 8303                 sta     3,s
    \ 0000e0 a303                 lda     3,s
    \ 0000e2 8301                 sta     1,s
1065                  	spanAbove = spanBelow = 0;
    \ 0000e4 a90000               lda     ##0
    \ 0000e7 8305                 sta     5,s
    \ 0000e9 aa                   tax
1066                  	while(x1 < (vickyResX) && BufferCurrent[x1] == oldColor)
    \ 0000ea a303                 lda     3,s
    \ 0000ec 8307                 sta     7,s
    \ 0000ee 8a                   txa
    \ 0000ef 8303                 sta     3,s
    \ 0000f1 a20000   `?L406`:    ldx     ##0
    \ 0000f4 a307                 lda     7,s
    \ 0000f6 1001                 bpl     `?L1137`
    \ 0000f8 ca                   dex
    \ 0000f9          `?L1137`:
    \ 0000f9 22......             jsl     long:`?L1313`
    \ 0000fd 5003                 bvc     `?L1139`
    \ 0000ff 490080               eor     ##-32768
    \ 000102 3003     `?L1139`:   bmi     `?L1521`
    \ 000104 4c....               jmp     .kbank `?L407`
    \ 000107 3b       `?L1521`:   tsc
    \ 000108 18                   clc
    \ 000109 690e08               adc     ##2062
    \ 00010c 22......             jsl     long:`?L1290`
    \ 000110 f003                 beq     `?L1522`
    \ 000112 4c....               jmp     .kbank `?L407`
    \ 000115          `?L1522`:
1067                  	{
1068                  	  if(!spanAbove && (y > 0) && BufferAbove[x1] == oldColor)
    \ 000115 a303                 lda     3,s
    \ 000117 d025                 bne     `?L409`
    \ 000119 a90000               lda     ##0
    \ 00011c 38                   sec
    \ 00011d e30c                 sbc     12,s
    \ 00011f 5003                 bvc     `?L1141`
    \ 000121 490080               eor     ##-32768
    \ 000124 1018     `?L1141`:   bpl     `?L409`
    \ 000126 3b                   tsc
    \ 000127 18                   clc
    \ 000128 690e00               adc     ##14
    \ 00012b 22......             jsl     long:`?L1290`
    \ 00012f d00d                 bne     `?L409`
1069                  	  {
1070                  		stackPush(x1, y - 1);
    \ 000131 a30c                 lda     12,s
    \ 000133 3a                   dec     a
    \ 000134 22......             jsl     long:`?L1338`
1071                  		spanAbove = 1;
    \ 000138 8303                 sta     3,s
    \ 00013a 8303                 sta     3,s
    \ 00013c 8023                 bra     `?L410`
    \ 00013e          `?L409`:
1072                  	  }
1073                  	  else if(spanAbove && (y > 0) && BufferAbove[x1] != oldColor)
    \ 00013e a303                 lda     3,s
    \ 000140 f01f                 beq     `?L410`
    \ 000142 a90000               lda     ##0
    \ 000145 38                   sec
    \ 000146 e30c                 sbc     12,s
    \ 000148 5003                 bvc     `?L1144`
    \ 00014a 490080               eor     ##-32768
    \ 00014d 1012     `?L1144`:   bpl     `?L410`
    \ 00014f 3b                   tsc
    \ 000150 18                   clc
    \ 000151 690e00               adc     ##14
    \ 000154 22......             jsl     long:`?L1290`
    \ 000158 f007                 beq     `?L410`
1074                  	  {
1075                  		spanAbove = 0;
    \ 00015a a90000               lda     ##0
    \ 00015d 8303                 sta     3,s
    \ 00015f 8303                 sta     3,s
    \ 000161          `?L410`:
1076                  	  }
1077                  	  if(!spanBelow && (y < (vickyResY - 1)) && BufferBelow[x1]== oldColor)
    \ 000161 a305                 lda     5,s
    \ 000163 d033                 bne     `?L415`
    \ 000165 a30c                 lda     12,s
    \ 000167 a20000               ldx     ##0
    \ 00016a a8                   tay
    \ 00016b 1001                 bpl     `?L1146`
    \ 00016d ca                   dex
    \ 00016e          `?L1146`:
    \ 00016e 22......             jsl     long:`?L1322`
    \ 000172 d001                 bne     `?L1148`
    \ 000174 ca                   dex
    \ 000175          `?L1148`:
    \ 000175 22......             jsl     long:`?L1301`
    \ 000179 5003                 bvc     `?L1150`
    \ 00017b 490080               eor     ##-32768
    \ 00017e 1018     `?L1150`:   bpl     `?L415`
    \ 000180 3b                   tsc
    \ 000181 18                   clc
    \ 000182 690e04               adc     ##1038
    \ 000185 22......             jsl     long:`?L1290`
    \ 000189 d00d                 bne     `?L415`
1078                  	  {
1079                  		stackPush(x1, y + 1);
    \ 00018b a30c                 lda     12,s
    \ 00018d 1a                   inc     a
    \ 00018e 22......             jsl     long:`?L1338`
1080                  		spanBelow = 1;
    \ 000192 8305                 sta     5,s
    \ 000194 8305                 sta     5,s
    \ 000196 8031                 bra     `?L416`
    \ 000198          `?L415`:
1081                  	  }
1082                  	  else if(spanBelow && (y < (vickyResY - 1)) && BufferBelow[x1]!= oldColor)
    \ 000198 a305                 lda     5,s
    \ 00019a f02d                 beq     `?L416`
    \ 00019c a30c                 lda     12,s
    \ 00019e a20000               ldx     ##0
    \ 0001a1 a8                   tay
    \ 0001a2 1001                 bpl     `?L1153`
    \ 0001a4 ca                   dex
    \ 0001a5          `?L1153`:
    \ 0001a5 22......             jsl     long:`?L1322`
    \ 0001a9 d001                 bne     `?L1155`
    \ 0001ab ca                   dex
    \ 0001ac          `?L1155`:
    \ 0001ac 22......             jsl     long:`?L1301`
    \ 0001b0 5003                 bvc     `?L1157`
    \ 0001b2 490080               eor     ##-32768
    \ 0001b5 1012     `?L1157`:   bpl     `?L416`
    \ 0001b7 3b                   tsc
    \ 0001b8 18                   clc
    \ 0001b9 690e04               adc     ##1038
    \ 0001bc 22......             jsl     long:`?L1290`
    \ 0001c0 f007                 beq     `?L416`
1083                  	  {
1084                  		spanBelow = 0;
    \ 0001c2 a90000               lda     ##0
    \ 0001c5 8305                 sta     5,s
    \ 0001c7 8305                 sta     5,s
    \ 0001c9          `?L416`:
1085                  	  }
1086                  	  x1++;
    \ 0001c9 a307                 lda     7,s
    \ 0001cb 1a                   inc     a
    \ 0001cc 8307                 sta     7,s
    \ 0001ce 4c....               jmp     .kbank `?L406`
    \ 0001d1          `?L407`:
1087                  	}
1088                  	// Fill horizontal Line (optimization)
1089                  	if (BufferCurrent[x1]!=oldColor)
    \ 0001d1 3b                   tsc
    \ 0001d2 18                   clc
    \ 0001d3 690e08               adc     ##2062
    \ 0001d6 22......             jsl     long:`?L1290`
    \ 0001da f005                 beq     `?L421`
1090                  		x1--;
    \ 0001dc a307                 lda     7,s
    \ 0001de 3a                   dec     a
    \ 0001df 8002                 bra     `?L1261`
    \ 0001e1 a307     `?L421`:    lda     7,s
    \ 0001e3 a8       `?L1261`:   tay
1091                  	plot_line(xInit,y,x1,y,newColor);
    \ 0001e4 3b                   tsc
    \ 0001e5 18                   clc
    \ 0001e6 69120c               adc     ##3090
    \ 0001e9 aa                   tax
    \ 0001ea bd0000               lda     0,x
    \ 0001ed 48                   pha
    \ 0001ee a30e                 lda     14,s
    \ 0001f0 48                   pha
    \ 0001f1 84..                 sty     dp:.tiny (_Dp+2)
    \ 0001f3 a310                 lda     16,s
    \ 0001f5 85..                 sta     dp:.tiny _Dp
    \ 0001f7 a305                 lda     5,s
    \ 0001f9 22......             jsl     long:plot_line
    \ 0001fd 68                   pla
    \ 0001fe 68                   pla
    \ 0001ff 4c....               jmp     .kbank `?L391`
    \ 000202          `?L386`:
1092                    }
1093                  }
    \ 000202 3b                   tsc
    \ 000203 18                   clc
    \ 000204 690e0c               adc     ##3086
    \ 000207 1b                   tcs
    \ 000208 6b                   rtl
1094                  
1095                  
1096                  // ----------------------------------------------------------------------------------
1097                  // Arc rendering algorithm
1098                  // credits to Harsh Jain
1099                  // https://codingee.com/computer-graphics-program-to-implement-circular-arc-algorithm/
1100                  // ----------------------------------------------------------------------------------
1101                  
1102                  
1103                  
1104                  void plot_arc( int x_cen, int y_cen, int rad, int start_ang, int end_ang, uint8_t col)
1105                  {
    \ 000000                      .section farcode,text
    \ 000000                      .public plot_arc
    \ 000000          plot_arc:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 d4..                 pei     dp:.tiny (_Dp+10)
    \ 000004 a8                   tay
    \ 000005 3b                   tsc
    \ 000006 38                   sec
    \ 000007 e91c00               sbc     ##28
    \ 00000a 1b                   tcs
    \ 00000b 98                   tya
    \ 00000c 830b                 sta     11,s
    \ 00000e a5..                 lda     dp:.tiny _Dp
    \ 000010 830d                 sta     13,s
    \ 000012 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000014 831b                 sta     27,s
1106                         float ang=(((start_ang<=end_ang)?start_ang:end_ang)*(PI/180));
    \ 000016 a326                 lda     38,s
    \ 000018 38                   sec
    \ 000019 e324                 sbc     36,s
    \ 00001b 5003                 bvc     `?L1160`
    \ 00001d 490080               eor     ##-32768
    \ 000020 1006     `?L1160`:   bpl     `?L498`
    \ 000022 a326                 lda     38,s
    \ 000024 8301                 sta     1,s
    \ 000026 8004                 bra     `?L1264`
    \ 000028 a324     `?L498`:    lda     36,s
    \ 00002a 8301                 sta     1,s
    \ 00002c 8301     `?L1264`:   sta     1,s
    \ 00002e a301                 lda     1,s
    \ 000030 a20000               ldx     ##0
    \ 000033 a8                   tay
    \ 000034 1001                 bpl     `?L1162`
    \ 000036 ca                   dex
    \ 000037          `?L1162`:
    \ 000037 22......             jsl     long:_SInt32ToFloat32
    \ 00003b a033fa               ldy     ##64051
    \ 00003e 84..                 sty     dp:.tiny _Dp
    \ 000040 a08e3c               ldy     ##15502
    \ 000043 22......             jsl     long:`?L1279`
    \ 000047 86..                 stx     dp:.tiny (_Dp+10)
    \ 000049 85..                 sta     dp:.tiny (_Dp+8)
1107                         float range=(((end_ang>start_ang)?end_ang:start_ang)*(PI/180));
    \ 00004b a324                 lda     36,s
    \ 00004d 38                   sec
    \ 00004e e326                 sbc     38,s
    \ 000050 5003                 bvc     `?L1166`
    \ 000052 490080               eor     ##-32768
    \ 000055 3006     `?L1166`:   bmi     `?L501`
    \ 000057 a324                 lda     36,s
    \ 000059 8301                 sta     1,s
    \ 00005b 8004                 bra     `?L1263`
    \ 00005d a326     `?L501`:    lda     38,s
    \ 00005f 8301                 sta     1,s
    \ 000061 8301     `?L1263`:   sta     1,s
    \ 000063 a301                 lda     1,s
    \ 000065 a20000               ldx     ##0
    \ 000068 a8                   tay
    \ 000069 1001                 bpl     `?L1168`
    \ 00006b ca                   dex
    \ 00006c          `?L1168`:
    \ 00006c 22......             jsl     long:_SInt32ToFloat32
    \ 000070 a033fa               ldy     ##64051
    \ 000073 84..                 sty     dp:.tiny _Dp
    \ 000075 a08e3c               ldy     ##15502
    \ 000078 22......             jsl     long:`?L1279`
    \ 00007c 830f                 sta     15,s
    \ 00007e 8a                   txa
    \ 00007f 8311                 sta     17,s
1108                         float x=(rad*cos(ang));
    \ 000081 22......             jsl     long:`?L1352`
    \ 000085 1001                 bpl     `?L1172`
    \ 000087 ca                   dex
    \ 000088          `?L1172`:
    \ 000088 22......             jsl     long:_SInt32ToFloat32
    \ 00008c da                   phx
    \ 00008d 48                   pha
    \ 00008e a6..                 ldx     dp:.tiny (_Dp+10)
    \ 000090 a5..                 lda     dp:.tiny (_Dp+8)
    \ 000092 22......             jsl     long:cos
    \ 000096 22......             jsl     long:_FillDP4
    \ 00009a ..                   .byte   .tiny _Dp
    \ 00009b 22......             jsl     long:_Float32Mul
    \ 00009f 8303                 sta     3,s
    \ 0000a1 8a                   txa
    \ 0000a2 8305                 sta     5,s
1109                         float y=(rad*sin(ang));
    \ 0000a4 22......             jsl     long:`?L1352`
    \ 0000a8 1001                 bpl     `?L1177`
    \ 0000aa ca                   dex
    \ 0000ab          `?L1177`:
    \ 0000ab 22......             jsl     long:_SInt32ToFloat32
    \ 0000af da                   phx
    \ 0000b0 48                   pha
    \ 0000b1 a6..                 ldx     dp:.tiny (_Dp+10)
    \ 0000b3 a5..                 lda     dp:.tiny (_Dp+8)
    \ 0000b5 22......             jsl     long:sin
    \ 0000b9 22......             jsl     long:_FillDP4
    \ 0000bd ..                   .byte   .tiny _Dp
    \ 0000be 22......             jsl     long:_Float32Mul
    \ 0000c2 8307                 sta     7,s
    \ 0000c4 8a                   txa
    \ 0000c5 8309                 sta     9,s
1110                  	   printf ("ang: %f range: %f\r",ang, range);
    \ 0000c7 a311                 lda     17,s
    \ 0000c9 48                   pha
    \ 0000ca a311                 lda     17,s
    \ 0000cc 48                   pha
    \ 0000cd a5..                 lda     dp:.tiny (_Dp+10)
    \ 0000cf 48                   pha
    \ 0000d0 a5..                 lda     dp:.tiny (_Dp+8)
    \ 0000d2 48                   pha
    \ 0000d3 a9....               lda     ##`_StringLiteral_[97,110,103,58,32,37,102,32,114,97,110,103,101,58,32,37,102,13]`
    \ 0000d6 22......             jsl     long:printf
    \ 0000da 8309                 sta     9,s
1111                         do
    \ 0000dc 68                   pla
    \ 0000dd 68                   pla
    \ 0000de 68                   pla
    \ 0000df 68                   pla
    \ 0000e0 a5..                 lda     dp:.tiny (_Dp+8)
    \ 0000e2 8317                 sta     23,s
    \ 0000e4 a5..                 lda     dp:.tiny (_Dp+10)
    \ 0000e6 8319                 sta     25,s
    \ 0000e8 a303                 lda     3,s
    \ 0000ea 8313                 sta     19,s
    \ 0000ec a305                 lda     5,s
    \ 0000ee 8315                 sta     21,s
    \ 0000f0 a307                 lda     7,s
    \ 0000f2 8303                 sta     3,s
    \ 0000f4 a309                 lda     9,s
    \ 0000f6 8305                 sta     5,s
    \ 0000f8          `?L427`:
1112                         {
1113                  		   printf ("ang: %f x: %d y: %d",ang,(int)(x_cen+x+0.5), (int)(y_cen-y+0.5));
    \ 0000f8 a30d                 lda     13,s
    \ 0000fa a20000               ldx     ##0
    \ 0000fd a8                   tay
    \ 0000fe 1001                 bpl     `?L1183`
    \ 000100 ca                   dex
    \ 000101          `?L1183`:
    \ 000101 22......             jsl     long:_SInt32ToFloat32
    \ 000105 da                   phx
    \ 000106 48                   pha
    \ 000107 a309                 lda     9,s
    \ 000109 85..                 sta     dp:.tiny (_Dp+2)
    \ 00010b a307                 lda     7,s
    \ 00010d 85..                 sta     dp:.tiny _Dp
    \ 00010f 68                   pla
    \ 000110 fa                   plx
    \ 000111 22......             jsl     long:_Float32Sub
    \ 000115 22......             jsl     long:`?L1281`
    \ 000119 22......             jsl     long:_Float32ToSInt32
    \ 00011d 48                   pha
    \ 00011e a30d                 lda     13,s
    \ 000120 a20000               ldx     ##0
    \ 000123 a8                   tay
    \ 000124 1001                 bpl     `?L1189`
    \ 000126 ca                   dex
    \ 000127          `?L1189`:
    \ 000127 22......             jsl     long:_SInt32ToFloat32
    \ 00012b da                   phx
    \ 00012c 48                   pha
    \ 00012d a31b                 lda     27,s
    \ 00012f 85..                 sta     dp:.tiny (_Dp+2)
    \ 000131 a319                 lda     25,s
    \ 000133 85..                 sta     dp:.tiny _Dp
    \ 000135 68                   pla
    \ 000136 fa                   plx
    \ 000137 22......             jsl     long:_Float32Add
    \ 00013b 22......             jsl     long:`?L1281`
    \ 00013f 22......             jsl     long:_Float32ToSInt32
    \ 000143 48                   pha
    \ 000144 a31d                 lda     29,s
    \ 000146 48                   pha
    \ 000147 a31d                 lda     29,s
    \ 000149 48                   pha
    \ 00014a a9....               lda     ##`_StringLiteral_ang: %f x: %d y: %d`
    \ 00014d 22......             jsl     long:printf
    \ 000151 8309                 sta     9,s
1114                              setPixel((int)(x_cen+x+0.5),(int)(y_cen-y+0.5),col);
    \ 000153 a330                 lda     48,s
    \ 000155 48                   pha
    \ 000156 a317                 lda     23,s
    \ 000158 a20000               ldx     ##0
    \ 00015b a8                   tay
    \ 00015c 1001                 bpl     `?L1196`
    \ 00015e ca                   dex
    \ 00015f          `?L1196`:
    \ 00015f 22......             jsl     long:_SInt32ToFloat32
    \ 000163 da                   phx
    \ 000164 48                   pha
    \ 000165 a313                 lda     19,s
    \ 000167 85..                 sta     dp:.tiny (_Dp+2)
    \ 000169 a311                 lda     17,s
    \ 00016b 85..                 sta     dp:.tiny _Dp
    \ 00016d 68                   pla
    \ 00016e fa                   plx
    \ 00016f 22......             jsl     long:_Float32Sub
    \ 000173 22......             jsl     long:`?L1281`
    \ 000177 22......             jsl     long:`?L1311`
    \ 00017b 1001                 bpl     `?L1202`
    \ 00017d ca                   dex
    \ 00017e da       `?L1202`:   phx
    \ 00017f 48                   pha
    \ 000180 a319                 lda     25,s
    \ 000182 a20000               ldx     ##0
    \ 000185 a8                   tay
    \ 000186 1001                 bpl     `?L1204`
    \ 000188 ca                   dex
    \ 000189          `?L1204`:
    \ 000189 22......             jsl     long:_SInt32ToFloat32
    \ 00018d da                   phx
    \ 00018e 48                   pha
    \ 00018f a327                 lda     39,s
    \ 000191 85..                 sta     dp:.tiny (_Dp+2)
    \ 000193 a325                 lda     37,s
    \ 000195 85..                 sta     dp:.tiny _Dp
    \ 000197 68                   pla
    \ 000198 fa                   plx
    \ 000199 22......             jsl     long:_Float32Add
    \ 00019d 22......             jsl     long:`?L1281`
    \ 0001a1 22......             jsl     long:`?L1311`
    \ 0001a5 1001                 bpl     `?L1210`
    \ 0001a7 ca                   dex
    \ 0001a8          `?L1210`:
    \ 0001a8 22......             jsl     long:_FillDP4
    \ 0001ac ..                   .byte   .tiny _Dp
    \ 0001ad 22......             jsl     long:setPixel
1115                              ang+=0.01;
    \ 0001b1 3b                   tsc
    \ 0001b2 18                   clc
    \ 0001b3 690a00               adc     ##10
    \ 0001b6 1b                   tcs
    \ 0001b7 a319                 lda     25,s
    \ 0001b9 85..                 sta     dp:.tiny (_Dp+2)
    \ 0001bb a317                 lda     23,s
    \ 0001bd 85..                 sta     dp:.tiny _Dp
    \ 0001bf a90ad7               lda     ##55050
    \ 0001c2 a2233c               ldx     ##15395
    \ 0001c5 22......             jsl     long:`?L1340`
1116                              x=(rad*cos(ang));
    \ 0001c9 22......             jsl     long:`?L1352`
    \ 0001cd 1001                 bpl     `?L1214`
    \ 0001cf ca                   dex
    \ 0001d0          `?L1214`:
    \ 0001d0 22......             jsl     long:_SInt32ToFloat32
    \ 0001d4 da                   phx
    \ 0001d5 48                   pha
    \ 0001d6 a6..                 ldx     dp:.tiny (_Dp+10)
    \ 0001d8 a5..                 lda     dp:.tiny (_Dp+8)
    \ 0001da 22......             jsl     long:cos
    \ 0001de 22......             jsl     long:_FillDP4
    \ 0001e2 ..                   .byte   .tiny _Dp
    \ 0001e3 22......             jsl     long:_Float32Mul
    \ 0001e7 8303                 sta     3,s
    \ 0001e9 8a                   txa
    \ 0001ea 8305                 sta     5,s
1117                              y=(rad*sin(ang));
    \ 0001ec 22......             jsl     long:`?L1352`
    \ 0001f0 1001                 bpl     `?L1219`
    \ 0001f2 ca                   dex
    \ 0001f3          `?L1219`:
    \ 0001f3 22......             jsl     long:_SInt32ToFloat32
    \ 0001f7 da                   phx
    \ 0001f8 48                   pha
    \ 0001f9 a6..                 ldx     dp:.tiny (_Dp+10)
    \ 0001fb a5..                 lda     dp:.tiny (_Dp+8)
    \ 0001fd 22......             jsl     long:sin
    \ 000201 22......             jsl     long:_FillDP4
    \ 000205 ..                   .byte   .tiny _Dp
    \ 000206 22......             jsl     long:_Float32Mul
    \ 00020a 8307                 sta     7,s
    \ 00020c 8a                   txa
    \ 00020d 8309                 sta     9,s
1118                         }
1119                         while(ang<=range);
    \ 00020f a5..                 lda     dp:.tiny (_Dp+8)
    \ 000211 8317                 sta     23,s
    \ 000213 a5..                 lda     dp:.tiny (_Dp+10)
    \ 000215 8319                 sta     25,s
    \ 000217 a303                 lda     3,s
    \ 000219 8313                 sta     19,s
    \ 00021b a305                 lda     5,s
    \ 00021d 8315                 sta     21,s
    \ 00021f a307                 lda     7,s
    \ 000221 8303                 sta     3,s
    \ 000223 a309                 lda     9,s
    \ 000225 8305                 sta     5,s
    \ 000227 a311                 lda     17,s
    \ 000229 aa                   tax
    \ 00022a a30f                 lda     15,s
    \ 00022c 22......             jsl     long:`?L1314`
    \ 000230 9003                 bcc     `?L1523`
    \ 000232 4c....               jmp     .kbank `?L427`
    \ 000235          `?L1523`:
1120                  }
    \ 000235 3b                   tsc
    \ 000236 18                   clc
    \ 000237 691c00               adc     ##28
    \ 00023a 1b                   tcs
    \ 00023b 7a                   ply
    \ 00023c 84..                 sty     dp:.tiny (_Dp+10)
    \ 00023e 7a                   ply
    \ 00023f 84..                 sty     dp:.tiny (_Dp+8)
    \ 000241 6b                   rtl
1121                  //--------------------------------------------------------------------------------------------
1122                  // SUPPORTING FUNCTIONS
1123                  // -------------------------------------------------------------------------------------------
1124                  
1125                  // ----------------------------------------------------------------------------------
1126                  // Custom Stack Functions (needed for Flood fill Implementation)
1127                  // Original Version: https://www.tutorialspoint.com/data_structures_algorithms/stack_program_in_c.htm
1128                  // Modified by Ernesto Contreras 
1129                  // ----------------------------------------------------------------------------------
1130                  
1131                  
1132                  
1133                  bool isStackEmpty() {
    \ 000000                      .section farcode,text
    \ 000000                      .public isStackEmpty
    \ 000000          isStackEmpty:
1134                     if(stackTop == 0)
    \ 000000 ad....               lda     stackTop
    \ 000003 d004                 bne     `?L433`
1135                        return true;
    \ 000005 a90100               lda     ##1
    \ 000008 6b                   rtl
    \ 000009          `?L433`:
1136                     else
1137                        return false;
    \ 000009 a90000               lda     ##0
    \ 00000c 6b                   rtl
1138                  }
1139                     
1140                  bool isStackFull() {
    \ 000000                      .section farcode,text
    \ 000000                      .public isStackFull
    \ 000000          isStackFull:
1141                     if(stackTop == STACK_MAXSIZE )
    \ 000000 a28000               ldx     ##128
    \ 000003 ec....               cpx     stackTop
    \ 000006 d004                 bne     `?L441`
1142                     {
1143                  	   //printf ("stacklevel: %d MaxSize: %d\n\r",stackTop,STACK_MAXSIZE);
1144                         return true;
    \ 000008 a90100               lda     ##1
    \ 00000b 6b                   rtl
    \ 00000c          `?L441`:
1145                     }
1146                     else
1147                     {
1148                        return false;
    \ 00000c a90000               lda     ##0
    \ 00000f 6b                   rtl
1149                     }
1150                  }
1151                  
1152                  bool stackPeek(int *x, int *y) {
    \ 000000                      .section farcode,text
    \ 000000                      .public stackPeek
    \ 000000 a8       stackPeek:  tay
1153                     *x=stack[stackTop][0];
    \ 000001 ad....               lda     stackTop
    \ 000004 0a                   asl     a
    \ 000005 0a                   asl     a
    \ 000006 aa                   tax
    \ 000007 bd....               lda     stack,x
    \ 00000a bb                   tyx
    \ 00000b 9d0000               sta     0,x
1154                     *y=stack[stackTop][1];
1155                     return true;
    \ 00000e 22......             jsl     long:`?L1320`
    \ 000012 bd0200               lda     2,x
    \ 000015 92..                 sta     (.tiny _Dp)
    \ 000017 a90100               lda     ##1
1156                  }
    \ 00001a 6b                   rtl
1157                  
1158                  bool stackPop(int *x, int *y) {
    \ 000000                      .section farcode,text
    \ 000000                      .public stackPop
    \ 000000          stackPop:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 5a                   phy
    \ 000003 8301                 sta     1,s
    \ 000005 a5..                 lda     dp:.tiny _Dp
    \ 000007 85..                 sta     dp:.tiny (_Dp+8)
1159                     int data;
1160                     if(isStackEmpty()==false) {
    \ 000009 22......             jsl     long:isStackEmpty
    \ 00000d 1a                   inc     a
    \ 00000e 3a                   dec     a
    \ 00000f d01f                 bne     `?L453`
1161                  	  *x = stack[stackTop][0];
    \ 000011 ad....               lda     stackTop
    \ 000014 0a                   asl     a
    \ 000015 0a                   asl     a
    \ 000016 aa                   tax
    \ 000017 bd....               lda     stack,x
    \ 00001a a00000               ldy     ##0
    \ 00001d 9301                 sta     (1,s),y
1162                  	  *y = stack[stackTop][1];
1163                        stackTop--;   
1164                        return true;
    \ 00001f 22......             jsl     long:`?L1320`
    \ 000023 bd0200               lda     2,x
    \ 000026 92..                 sta     (.tiny (_Dp+8))
    \ 000028 ce....               dec     stackTop
    \ 00002b a90100               lda     ##1
    \ 00002e 8003                 bra     `?L452`
    \ 000030          `?L453`:
1165                     } else {
1166                        //printf("Could not insert data, Stack is full. stackSize:%d \n\r",stackTop);
1167                  	  return false;
    \ 000030 a90000               lda     ##0
    \ 000033          `?L452`:
1168                     }
1169                  }
    \ 000033 5c......             jmp     long:`?L460`
1170                  
1171                  bool stackPush(int x, int y) {
    \ 000000                      .section farcode,text
    \ 000000                      .public stackPush
    \ 000000          stackPush:
    \ 000000 d4..                 pei     dp:.tiny (_Dp+8)
    \ 000002 5a                   phy
    \ 000003 8301                 sta     1,s
    \ 000005 a5..                 lda     dp:.tiny _Dp
    \ 000007 85..                 sta     dp:.tiny (_Dp+8)
1172                  
1173                     if(isStackFull()==false) {
    \ 000009 22......             jsl     long:isStackFull
    \ 00000d 1a                   inc     a
    \ 00000e 3a                   dec     a
    \ 00000f d01e                 bne     `?L461`
1174                        stackTop++;   
    \ 000011 ee....               inc     stackTop
1175                  	  stack[stackTop][0] = x;
    \ 000014 ad....               lda     stackTop
    \ 000017 0a                   asl     a
    \ 000018 0a                   asl     a
    \ 000019 aa                   tax
    \ 00001a a301                 lda     1,s
    \ 00001c 9d....               sta     stack,x
1176                  	  stack[stackTop][1] = y;
    \ 00001f a5..                 lda     dp:.tiny (_Dp+8)
    \ 000021 a8                   tay
1177                  	  return true;
    \ 000022 22......             jsl     long:`?L1320`
    \ 000026 98                   tya
    \ 000027 9d0200               sta     2,x
    \ 00002a a90100               lda     ##1
    \ 00002d 8003                 bra     `?L460`
    \ 00002f          `?L461`:
1178                     } else {
1179                        //printf("Could not insert data, Stack is full. stackSize:%d \n\r",stackTop);
1180                  	  return false;
    \ 00002f a90000               lda     ##0
    \ 000032          `?L460`:
1181                     }
1182                  }
    \ 000032 7a                   ply
    \ 000033 7a                   ply
    \ 000034 84..                 sty     dp:.tiny (_Dp+8)
    \ 000036 6b                   rtl
1183                  
    \ 000000                      .section farcode,text
    \ 000000          `?L1269`:
    \ 000000 a4..                 ldy     dp:.tiny (_Dp+8)
    \ 000002 84..                 sty     dp:.tiny _Dp
    \ 000004 a4..                 ldy     dp:.tiny (_Dp+10)
    \ 000006 84..                 sty     dp:.tiny (_Dp+2)
    \ 000008          `?L1270`:
    \ 000008 22......             jsl     long:_Float32Mul
    \ 00000c a4..                 ldy     dp:.tiny (_Dp+8)
    \ 00000e 84..                 sty     dp:.tiny _Dp
    \ 000010 a4..                 ldy     dp:.tiny (_Dp+10)
    \ 000012          `?L1272`:
    \ 000012 84..                 sty     dp:.tiny (_Dp+2)
    \ 000014          `?L1273`:
    \ 000014 22......             jsl     long:_Float32Mul
    \ 000018 86..                 stx     dp:.tiny (_Dp+2)
    \ 00001a 85..                 sta     dp:.tiny _Dp
    \ 00001c 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1275`:
    \ 000000 86..                 stx     dp:.tiny (_Dp+2)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 ad....               lda     vickyResX
    \ 000007 85..                 sta     dp:.tiny (_Dp+4)
    \ 000009 ad....               lda     vickyResX+2
    \ 00000c 85..                 sta     dp:.tiny (_Dp+6)
    \ 00000e 22......             jsl     long:_Mul32
    \ 000012 18                   clc
    \ 000013 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a20040   `?L1277`:   ldx     ##16384
    \ 000003          `?L1278`:
    \ 000003 a4..                 ldy     dp:.tiny (_Dp+12)
    \ 000005 84..                 sty     dp:.tiny _Dp
    \ 000007 a4..                 ldy     dp:.tiny (_Dp+14)
    \ 000009          `?L1279`:
    \ 000009 84..                 sty     dp:.tiny (_Dp+2)
    \ 00000b 5c......             jmp     long:_Float32Mul
    \ 000000                      .section farcode,text
    \ 000000 a90000   `?L1280`:   lda     ##0
    \ 000003 a2803f               ldx     ##16256
    \ 000006 a4..                 ldy     dp:.tiny (_Dp+8)
    \ 000008 84..                 sty     dp:.tiny _Dp
    \ 00000a a4..                 ldy     dp:.tiny (_Dp+10)
    \ 00000c 84..                 sty     dp:.tiny (_Dp+2)
    \ 00000e 5c......             jmp     long:_Float32Sub
    \ 000000                      .section farcode,text
    \ 000000 a00000   `?L1281`:   ldy     ##0
    \ 000003 84..                 sty     dp:.tiny _Dp
    \ 000005 a0003f               ldy     ##16128
    \ 000008          `?L1282`:
    \ 000008 84..                 sty     dp:.tiny (_Dp+2)
    \ 00000a 5c......             jmp     long:_Float32Add
    \ 000000                      .section farcode,text
    \ 000000          `?L1283`:
    \ 000000 86..                 stx     dp:.tiny (_Dp+2)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 a90001               lda     ##256
    \ 000007 85..                 sta     dp:.tiny (_Dp+4)
    \ 000009 a9af00               lda     ##175
    \ 00000c 85..                 sta     dp:.tiny (_Dp+6)
    \ 00000e ad....               lda     vickyBitmapPage
    \ 000011 0a                   asl     a
    \ 000012 0a                   asl     a
    \ 000013 0a                   asl     a
    \ 000014 85..                 sta     dp:.tiny (_Dp+8)
    \ 000016 18                   clc
    \ 000017 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000019 65..                 adc     dp:.tiny (_Dp+8)
    \ 00001b 85..                 sta     dp:.tiny (_Dp+4)
    \ 00001d 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a30b     `?L1284`:   lda     11,s
    \ 000002 29ff00               and     ##255
    \ 000005 0a                   asl     a
    \ 000006 0a                   asl     a
    \ 000007 a20000               ldx     ##0
    \ 00000a a8                   tay
    \ 00000b 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1285`:
    \ 000000 a5..                 lda     dp:.tiny (_Dp+8)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 a5..                 lda     dp:.tiny (_Dp+10)
    \ 000006 85..                 sta     dp:.tiny (_Dp+2)
    \ 000008 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a90001   `?L1286`:   lda     ##256
    \ 000003 85..                 sta     dp:.tiny (_Dp+4)
    \ 000005 a9af00               lda     ##175
    \ 000008 85..                 sta     dp:.tiny (_Dp+6)
    \ 00000a ad....               lda     vickyBitmapPage
    \ 00000d 0a                   asl     a
    \ 00000e 0a                   asl     a
    \ 00000f 0a                   asl     a
    \ 000010 85..                 sta     dp:.tiny _Dp
    \ 000012 18                   clc
    \ 000013 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000015 65..                 adc     dp:.tiny _Dp
    \ 000017 85..                 sta     dp:.tiny (_Dp+4)
    \ 000019 a00300               ldy     ##3
    \ 00001c b7..                 lda     [.tiny (_Dp+4)],y
    \ 00001e 85..                 sta     dp:.tiny (_Dp+2)
    \ 000020 a00100               ldy     ##1
    \ 000023 b7..                 lda     [.tiny (_Dp+4)],y
    \ 000025 85..                 sta     dp:.tiny _Dp
    \ 000027 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 0a       `?L1287`:   asl     a
    \ 000001 0a                   asl     a
    \ 000002 0a                   asl     a
    \ 000003          `?L1288`:
    \ 000003 85..                 sta     dp:.tiny (_Dp+4)
    \ 000005 18                   clc
    \ 000006 a5..                 lda     dp:.tiny _Dp
    \ 000008 65..                 adc     dp:.tiny (_Dp+4)
    \ 00000a 85..                 sta     dp:.tiny _Dp
    \ 00000c 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1289`:
    \ 000000 a5..                 lda     dp:.tiny (_Dp+12)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 a5..                 lda     dp:.tiny (_Dp+14)
    \ 000006 85..                 sta     dp:.tiny (_Dp+2)
    \ 000008 a6..                 ldx     dp:.tiny (_Dp+14)
    \ 00000a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a8       `?L1290`:   tay
    \ 000001 a30e                 lda     14,s
    \ 000003 e220                 sep     #32
    \ 000005 d30a                 cmp     (10,s),y
    \ 000007 c220                 rep     #32
    \ 000009 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1291`:
    \ 000000 ad....               lda     vickyResX
    \ 000003 85..                 sta     dp:.tiny _Dp
    \ 000005 ad....               lda     vickyResX+2
    \ 000008 85..                 sta     dp:.tiny (_Dp+2)
    \ 00000a ad....               lda     vickyResY
    \ 00000d 85..                 sta     dp:.tiny (_Dp+4)
    \ 00000f ad....               lda     vickyResY+2
    \ 000012 85..                 sta     dp:.tiny (_Dp+6)
    \ 000014 5c......             jmp     long:_Mul32
    \ 000000                      .section farcode,text
    \ 000000 a310     `?L1292`:   lda     16,s
    \ 000002 18                   clc
    \ 000003 631e                 adc     30,s
    \ 000005 85..                 sta     dp:.tiny (_Dp+2)
    \ 000007 a312                 lda     18,s
    \ 000009 18                   clc
    \ 00000a 6320                 adc     32,s
    \ 00000c 85..                 sta     dp:.tiny _Dp
    \ 00000e a31c                 lda     28,s
    \ 000010 18                   clc
    \ 000011 631e                 adc     30,s
    \ 000013 5c......             jmp     long:plot_line
    \ 000000                      .section farcode,text
    \ 000000 a318     `?L1293`:   lda     24,s
    \ 000002 18                   clc
    \ 000003 6326                 adc     38,s
    \ 000005 85..                 sta     dp:.tiny (_Dp+2)
    \ 000007 a328                 lda     40,s
    \ 000009 38                   sec
    \ 00000a e31a                 sbc     26,s
    \ 00000c 85..                 sta     dp:.tiny _Dp
    \ 00000e a324                 lda     36,s
    \ 000010 18                   clc
    \ 000011 6326                 adc     38,s
    \ 000013 5c......             jmp     long:plot_line
    \ 000000                      .section farcode,text
    \ 000000 a30c     `?L1294`:   lda     12,s
    \ 000002 18                   clc
    \ 000003 631a                 adc     26,s
    \ 000005 85..                 sta     dp:.tiny (_Dp+2)
    \ 000007 a30e                 lda     14,s
    \ 000009 18                   clc
    \ 00000a 631c                 adc     28,s
    \ 00000c          `?L1295`:
    \ 00000c 85..                 sta     dp:.tiny _Dp
    \ 00000e a31a                 lda     26,s
    \ 000010 38                   sec
    \ 000011 e30c                 sbc     12,s
    \ 000013 5c......             jmp     long:plot_line
    \ 000000                      .section farcode,text
    \ 000000 a31a     `?L1296`:   lda     26,s
    \ 000002 38                   sec
    \ 000003 e30c                 sbc     12,s
    \ 000005 85..                 sta     dp:.tiny (_Dp+2)
    \ 000007 a30e                 lda     14,s
    \ 000009 18                   clc
    \ 00000a 631c                 adc     28,s
    \ 00000c 85..                 sta     dp:.tiny _Dp
    \ 00000e a31a                 lda     26,s
    \ 000010 38                   sec
    \ 000011 e318                 sbc     24,s
    \ 000013 5c......             jmp     long:plot_line
    \ 000000                      .section farcode,text
    \ 000000 a322     `?L1297`:   lda     34,s
    \ 000002 38                   sec
    \ 000003 e314                 sbc     20,s
    \ 000005 85..                 sta     dp:.tiny (_Dp+2)
    \ 000007 a324                 lda     36,s
    \ 000009 38                   sec
    \ 00000a e316                 sbc     22,s
    \ 00000c 85..                 sta     dp:.tiny _Dp
    \ 00000e a322                 lda     34,s
    \ 000010 38                   sec
    \ 000011 e320                 sbc     32,s
    \ 000013 5c......             jmp     long:plot_line
    \ 000000                      .section farcode,text
    \ 000000 e220     `?L1298`:   sep     #32
    \ 000002 a980                 lda     #-128
    \ 000004 0f0004af             ora     long:11469824
    \ 000008 8f0004af             sta     long:11469824
    \ 00000c c220                 rep     #32
    \ 00000e 22......             jsl     long:DMA_wait_delay
    \ 000012 5c......             jmp     long:wait_for_DMA_to_finish
    \ 000000                      .section farcode,text
    \ 000000          `?L1300`:
    \ 000000 86..                 stx     dp:.tiny _Dp
    \ 000002 a6..                 ldx     dp:.tiny (_Dp+10)
    \ 000004 a5..                 lda     dp:.tiny (_Dp+8)
    \ 000006 5c......             jmp     long:fast_pow
    \ 000000                      .section farcode,text
    \ 000000 3a       `?L1301`:   dec     a
    \ 000001 86..                 stx     dp:.tiny (_Dp+6)
    \ 000003 85..                 sta     dp:.tiny (_Dp+4)
    \ 000005 a5..                 lda     dp:.tiny _Dp
    \ 000007 c5..                 cmp     dp:.tiny (_Dp+4)
    \ 000009 a5..                 lda     dp:.tiny (_Dp+2)
    \ 00000b e5..                 sbc     dp:.tiny (_Dp+6)
    \ 00000d 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a90100   `?L1302`:   lda     ##1
    \ 000003 8f0209af             sta     long:11471106
    \ 000007 3a                   dec     a
    \ 000008 8f0209af             sta     long:11471106
    \ 00000c 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1303`:
    \ 000000 86..                 stx     dp:.tiny (_Dp+10)
    \ 000002 85..                 sta     dp:.tiny (_Dp+8)
    \ 000004 ad....               lda     vickyResX
    \ 000007 85..                 sta     dp:.tiny (_Dp+4)
    \ 000009 ad....               lda     vickyResX+2
    \ 00000c 85..                 sta     dp:.tiny (_Dp+6)
    \ 00000e 22......             jsl     long:_Mul32
    \ 000012 18                   clc
    \ 000013 65..                 adc     dp:.tiny (_Dp+8)
    \ 000015 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1305`:
    \ 000000 a4..                 ldy     dp:.tiny (_Dp+12)
    \ 000002 84..                 sty     dp:.tiny _Dp
    \ 000004 a4..                 ldy     dp:.tiny (_Dp+14)
    \ 000006 84..                 sty     dp:.tiny (_Dp+2)
    \ 000008 a6..                 ldx     dp:.tiny (_Dp+14)
    \ 00000a a5..                 lda     dp:.tiny (_Dp+12)
    \ 00000c 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 0f0004af `?L1306`:   ora     long:11469824
    \ 000004 8f0004af             sta     long:11469824
    \ 000008 c220                 rep     #32
    \ 00000a a5..                 lda     dp:.tiny _Dp
    \ 00000c 8f0504af             sta     long:11469829
    \ 000010 e220                 sep     #32
    \ 000012 a5..                 lda     dp:.tiny (_Dp+2)
    \ 000014 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1307`:
    \ 000000 a4..                 ldy     dp:.tiny (_Dp+8)
    \ 000002 84..                 sty     dp:.tiny _Dp
    \ 000004 a4..                 ldy     dp:.tiny (_Dp+10)
    \ 000006 84..                 sty     dp:.tiny (_Dp+2)
    \ 000008 a6..                 ldx     dp:.tiny (_Dp+10)
    \ 00000a a5..                 lda     dp:.tiny (_Dp+8)
    \ 00000c 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1308`:
    \ 000000 8d....               sta     vickyResX
    \ 000003 8d....               sta     vickyResX+2
    \ 000006 8d....               sta     vickyResY
    \ 000009 8d....               sta     vickyResY+2
    \ 00000c 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1309`:
    \ 000000 22......             jsl     long:_Float32Sub
    \ 000004 86..                 stx     dp:.tiny (_Dp+2)
    \ 000006 85..                 sta     dp:.tiny _Dp
    \ 000008 a5..                 lda     dp:.tiny _Dp
    \ 00000a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1311`:
    \ 000000 22......             jsl     long:_Float32ToSInt32
    \ 000004 a20000               ldx     ##0
    \ 000007 a8                   tay
    \ 000008 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1313`:
    \ 000000 cd....               cmp     vickyResX
    \ 000003 8a                   txa
    \ 000004 ed....               sbc     vickyResX+2
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1314`:
    \ 000000 a4..                 ldy     dp:.tiny (_Dp+8)
    \ 000002 84..                 sty     dp:.tiny _Dp
    \ 000004 a4..                 ldy     dp:.tiny (_Dp+10)
    \ 000006          `?L1315`:
    \ 000006 84..                 sty     dp:.tiny (_Dp+2)
    \ 000008 5c......             jmp     long:_Float32GE
    \ 000000                      .section farcode,text
    \ 000000          `?L1316`:
    \ 000000 8d....               sta     vickyResY
    \ 000003 a90000               lda     ##0
    \ 000006 8d....               sta     vickyResY+2
    \ 000009 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1317`:
    \ 000000 22......             jsl     long:_Float32Mul
    \ 000004 a00000               ldy     ##0
    \ 000007 84..                 sty     dp:.tiny _Dp
    \ 000009 a08040               ldy     ##16512
    \ 00000c 84..                 sty     dp:.tiny (_Dp+2)
    \ 00000e 5c......             jmp     long:_Float32Div
    \ 000000                      .section farcode,text
    \ 000000 a90001   `?L1319`:   lda     ##256
    \ 000003 85..                 sta     dp:.tiny _Dp
    \ 000005 a9af00               lda     ##175
    \ 000008 85..                 sta     dp:.tiny (_Dp+2)
    \ 00000a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1320`:
    \ 000000 ad....               lda     stackTop
    \ 000003 0a                   asl     a
    \ 000004 0a                   asl     a
    \ 000005 18                   clc
    \ 000006 69....               adc     ##stack
    \ 000009 aa                   tax
    \ 00000a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1321`:
    \ 000000 ad....               lda     vickyBitmapPage
    \ 000003 0a                   asl     a
    \ 000004 aa                   tax
    \ 000005 bd....               lda     vBitPlane,x
    \ 000008 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1322`:
    \ 000000 86..                 stx     dp:.tiny (_Dp+2)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 ae....               ldx     vickyResY+2
    \ 000007 ad....               lda     vickyResY
    \ 00000a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 18       `?L1323`:   clc
    \ 000001 690e08               adc     ##2062
    \ 000004 85..                 sta     dp:.tiny _Dp
    \ 000006 64..                 stz     dp:.tiny (_Dp+2)
    \ 000008 a30f                 lda     15,s
    \ 00000a 5c......             jmp     long:getScanLine
    \ 000000                      .section farcode,text
    \ 000000 18       `?L1324`:   clc
    \ 000001 6310                 adc     16,s
    \ 000003 a20000               ldx     ##0
    \ 000006 a8                   tay
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 18       `?L1325`:   clc
    \ 000001 6312                 adc     18,s
    \ 000003 a20000               ldx     ##0
    \ 000006 a8                   tay
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1326`:
    \ 000000 cd....               cmp     vickyResY
    \ 000003 8a                   txa
    \ 000004 ed....               sbc     vickyResY+2
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1327`:
    \ 000000 86..                 stx     dp:.tiny (_Dp+2)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 a310                 lda     16,s
    \ 000006 38                   sec
    \ 000007 e306                 sbc     6,s
    \ 000009 a20000               ldx     ##0
    \ 00000c a8                   tay
    \ 00000d 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1328`:
    \ 000000 86..                 stx     dp:.tiny (_Dp+2)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 a310                 lda     16,s
    \ 000006 38                   sec
    \ 000007 e30e                 sbc     14,s
    \ 000009 a20000               ldx     ##0
    \ 00000c a8                   tay
    \ 00000d 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 18       `?L1329`:   clc
    \ 000001 690300               adc     ##3
    \ 000004 aa                   tax
    \ 000005 de0000               dec     0,x
    \ 000008 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 18       `?L1330`:   clc
    \ 000001 631a                 adc     26,s
    \ 000003 85..                 sta     dp:.tiny (_Dp+2)
    \ 000005 a31c                 lda     28,s
    \ 000007 38                   sec
    \ 000008 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a90000   `?L1331`:   lda     ##0
    \ 000003 38                   sec
    \ 000004 ef0209af             sbc     long:11471106
    \ 000008 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1332`:
    \ 000000 a5..                 lda     dp:.tiny (_Dp+4)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 a5..                 lda     dp:.tiny (_Dp+6)
    \ 000006 85..                 sta     dp:.tiny (_Dp+2)
    \ 000008 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1333`:
    \ 000000 85..                 sta     dp:.tiny _Dp
    \ 000002 a31a                 lda     26,s
    \ 000004 38                   sec
    \ 000005 e310                 sbc     16,s
    \ 000007 5c......             jmp     long:plot_line
    \ 000000                      .section farcode,text
    \ 000000          `?L1334`:
    \ 000000 22......             jsl     long:_SInt32ToFloat32
    \ 000004 a03333               ldy     ##13107
    \ 000007 84..                 sty     dp:.tiny _Dp
    \ 000009 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 8a       `?L1336`:   txa
    \ 000001 69b000               adc     ##176
    \ 000004 aa                   tax
    \ 000005 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1337`:
    \ 000000 a5..                 lda     dp:.tiny (_Dp+12)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 a5..                 lda     dp:.tiny (_Dp+14)
    \ 000006 85..                 sta     dp:.tiny (_Dp+2)
    \ 000008 a90000               lda     ##0
    \ 00000b 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1338`:
    \ 000000 85..                 sta     dp:.tiny _Dp
    \ 000002 a30a                 lda     10,s
    \ 000004 22......             jsl     long:stackPush
    \ 000008 a90100               lda     ##1
    \ 00000b 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1340`:
    \ 000000 22......             jsl     long:_Float32Add
    \ 000004 86..                 stx     dp:.tiny (_Dp+10)
    \ 000006 85..                 sta     dp:.tiny (_Dp+8)
    \ 000008 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1342`:
    \ 000000 22......             jsl     long:_Float32Add
    \ 000004 86..                 stx     dp:.tiny (_Dp+2)
    \ 000006 85..                 sta     dp:.tiny _Dp
    \ 000008 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a90000   `?L1344`:   lda     ##0
    \ 000003 85..                 sta     dp:.tiny _Dp
    \ 000005 a94040               lda     ##16448
    \ 000008 85..                 sta     dp:.tiny (_Dp+2)
    \ 00000a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a90000   `?L1345`:   lda     ##0
    \ 000003 8d....               sta     vickyResX+2
    \ 000006 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a310     `?L1346`:   lda     16,s
    \ 000002 a20000               ldx     ##0
    \ 000005 a8                   tay
    \ 000006 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1347`:
    \ 000000 86..                 stx     dp:.tiny (_Dp+14)
    \ 000002 85..                 sta     dp:.tiny (_Dp+12)
    \ 000004 a30c                 lda     12,s
    \ 000006 a20000               ldx     ##0
    \ 000009 a8                   tay
    \ 00000a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1348`:
    \ 000000 86..                 stx     dp:.tiny (_Dp+2)
    \ 000002 85..                 sta     dp:.tiny _Dp
    \ 000004 a310                 lda     16,s
    \ 000006 a20000               ldx     ##0
    \ 000009 a8                   tay
    \ 00000a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000          `?L1349`:
    \ 000000 85..                 sta     dp:.tiny _Dp
    \ 000002 a90000               lda     ##0
    \ 000005 aa                   tax
    \ 000006 5c......             jmp     long:_Float32LT
    \ 000000                      .section farcode,text
    \ 000000 0f2004af `?L1350`:   ora     long:11469856
    \ 000004 8f2004af             sta     long:11469856
    \ 000008 c220                 rep     #32
    \ 00000a 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a00300   `?L1351`:   ldy     ##3
    \ 000003 97..                 sta     [.tiny _Dp],y
    \ 000005 c220                 rep     #32
    \ 000007 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a31e     `?L1352`:   lda     30,s
    \ 000002 a20000               ldx     ##0
    \ 000005 a8                   tay
    \ 000006 6b                   rtl
    \ 000000                      .section farcode,text
    \ 000000 a90000   `?L1353`:   lda     ##0
    \ 000003 a24040               ldx     ##16448
    \ 000006 a4..                 ldy     dp:.tiny (_Dp+8)
    \ 000008 84..                 sty     dp:.tiny _Dp
    \ 00000a 6b                   rtl
    \ 000000                      .section switch,rodata
    \ 000000 ....     `?L470`:    .word   .word0 (`?L53`-1)
    \ 000002 ....                 .word   .word0 (`?L52`-1)
    \ 000004 ....                 .word   .word0 (`?L51`-1)
    \ 000006 ....                 .word   .word0 (`?L50`-1)
    \ 000000                      .section switch,rodata
    \ 000000 ....     `?L475`:    .word   .word0 (`?L101`-1)
    \ 000002 ....                 .word   .word0 (`?L100`-1)
    \ 000004 ....                 .word   .word0 (`?L99`-1)
    \ 000006 ....                 .word   .word0 (`?L98`-1)
    \ 000008 ....                 .word   .word0 (`?L97`-1)
    \ 00000a ....                 .word   .word0 (`?L96`-1)
    \ 00000c ....                 .word   .word0 (`?L95`-1)
    \ 00000e ....                 .word   .word0 (`?L94`-1)
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[27,91,37,100,59,37,100,72]`
    \ 000000          `_StringLiteral_[27,91,37,100,59,37,100,72]`:
    \ 000000 1b5b2564             .byte   27,91,37,100,59,37,100,72,0
    \ 000004 3b256448
    \ 000008 00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[27,91,50,74]`
    \ 000000          `_StringLiteral_[27,91,50,74]`:
    \ 000000 1b5b324a             .byte   27,91,50,74,0
    \ 000004 00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[27,101,91,56,59,37,100,44,37,100,59,49,72]`
    \ 000000          `_StringLiteral_[27,101,91,56,59,37,100,44,37,100,59,49,72]`:
    \ 000000 1b655b38             .byte   27,101,91,56,59,37,100,44,37,100,59,49,72,0
    \ 000004 3b25642c
    \ 000008 25643b31
    \ 00000c 4800
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_Bitmap page must be 0 or 1!`
    \ 000000          `_StringLiteral_Bitmap page must be 0 or 1!`:
    \ 000000 4269746d             .byte   66,105,116,109,97,112,32,112,97,103,101,32,109,117,115,116,32,98,101,32,48,32,111,114,32,49,33,0
    \ 000004 61702070
    \ 000008 61676520
    \ 00000c 6d757374
    \ 000010 20626520
    \ 000014 30206f72
    \ 000018 20312100
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[70,105,110,105,115,104,46,46,13]`
    \ 000000          `_StringLiteral_[70,105,110,105,115,104,46,46,13]`:
    \ 000000 46696e69             .byte   70,105,110,105,115,104,46,46,13,0
    \ 000004 73682e2e
    \ 000008 0d00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[77,101,109,111,114,121,32,100,101,116,101,99,116,101,100,58,32,37,108,120,32,10,13]`
    \ 000000          `_StringLiteral_[77,101,109,111,114,121,32,100,101,116,101,99,116,101,100,58,32,37,108,120,32,10,13]`:
    \ 000000 4d656d6f             .byte   77,101,109,111,114,121,32,100,101,116,101,99,116,101,100,58,32,37,108,120,32,10,13,0
    \ 000004 72792064
    \ 000008 65746563
    \ 00000c 7465643a
    \ 000010 20256c78
    \ 000014 200a0d00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[78,111,116,32,101,110,111,117,103,104,32,109,101,109,111,114,121,32,97,116,32,97,100,100,114,101,115,115,32,37,108,120,32,102,111,114,32,97,32,100,37,32,98,121,32,100,37,32,115,99,114,101,101,110,33,44,32,37,120,108,32,98,121,116,101,115,32,114,101,113,117,105,114,101,100,46,10,13]`
    \ 000000          `_StringLiteral_[78,111,116,32,101,110,111,117,103,104,32,109,101,109,111,114,121,32,97,116,32,97,100,100,114,101,115,115,32,37,108,120,32,102,111,114,32,97,32,100,37,32,98,121,32,100,37,32,115,99,114,101,101,110,33,44,32,37,120,108,32,98,121,116,101,115,32,114,101,113,117,105,114,101,100,46,10,13]`:
    \ 000000 4e6f7420             .byte   78,111,116,32,101,110,111,117,103,104,32,109,101,109,111,114,121,32,97,116,32,97,100,100,114,101,115,115,32,37,108,120,32,102,111,114,32,97,32,100,37,32,98,121,32,100,37,32,115,99,114,101,101,110,33,44,32,37,120,108,32,98,121,116,101,115,32,114,101,113,117,105,114,101,100,46,10,13,0
    \ 000004 656e6f75
    \ 000008 6768206d
    \ 00000c 656d6f72
    \ 000010 79206174
    \ 000014 20616464
    \ 000018 72657373
    \ 00001c 20256c78
    \ 000020 20666f72
    \ 000024 20612064
    \ 000028 25206279
    \ 00002c 20642520
    \ 000030 73637265
    \ 000034 656e212c
    \ 000038 2025786c
    \ 00003c 20627974
    \ 000040 65732072
    \ 000044 65717569
    \ 000048 7265642e
    \ 00004c 0a0d00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[86,82,65,77,32,100,101,116,101,99,116,101,100,58,32,48,120,98,48,48,48,48,48,32,45,32,37,108,120,10,13]`
    \ 000000          `_StringLiteral_[86,82,65,77,32,100,101,116,101,99,116,101,100,58,32,48,120,98,48,48,48,48,48,32,45,32,37,108,120,10,13]`:
    \ 000000 5652414d             .byte   86,82,65,77,32,100,101,116,101,99,116,101,100,58,32,48,120,98,48,48,48,48,48,32,45,32,37,108,120,10,13,0
    \ 000004 20646574
    \ 000008 65637465
    \ 00000c 643a2030
    \ 000010 78623030
    \ 000014 30303020
    \ 000018 2d20256c
    \ 00001c 780a0d00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[88,102,101,114,32,105,110,105,116,105,116,97,116,101,100,13]`
    \ 000000          `_StringLiteral_[88,102,101,114,32,105,110,105,116,105,116,97,116,101,100,13]`:
    \ 000000 58666572             .byte   88,102,101,114,32,105,110,105,116,105,116,97,116,101,100,13,0
    \ 000004 20696e69
    \ 000008 74697461
    \ 00000c 7465640d
    \ 000010 00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[97,110,103,58,32,37,102,32,114,97,110,103,101,58,32,37,102,13]`
    \ 000000          `_StringLiteral_[97,110,103,58,32,37,102,32,114,97,110,103,101,58,32,37,102,13]`:
    \ 000000 616e673a             .byte   97,110,103,58,32,37,102,32,114,97,110,103,101,58,32,37,102,13,0
    \ 000004 20256620
    \ 000008 72616e67
    \ 00000c 653a2025
    \ 000010 660d00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_ang: %f x: %d y: %d`
    \ 000000          `_StringLiteral_ang: %f x: %d y: %d`:
    \ 000000 616e673a             .byte   97,110,103,58,32,37,102,32,120,58,32,37,100,32,121,58,32,37,100,0
    \ 000004 20256620
    \ 000008 783a2025
    \ 00000c 6420793a
    \ 000010 20256400
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[103,114,97,112,104,105,99,115,32,109,111,100,101,32,37,100,32,120,58,37,108,100,32,121,58,37,108,100,10,13]`
    \ 000000          `_StringLiteral_[103,114,97,112,104,105,99,115,32,109,111,100,101,32,37,100,32,120,58,37,108,100,32,121,58,37,108,100,10,13]`:
    \ 000000 67726170             .byte   103,114,97,112,104,105,99,115,32,109,111,100,101,32,37,100,32,120,58,37,108,100,32,121,58,37,108,100,10,13,0
    \ 000004 68696373
    \ 000008 206d6f64
    \ 00000c 65202564
    \ 000010 20783a25
    \ 000014 6c642079
    \ 000018 3a256c64
    \ 00001c 0a0d00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[115,111,117,114,99,101,58,32,37,120,32,100,101,115,116,58,32,37,120,32,108,101,110,58,37,108,100,13]`
    \ 000000          `_StringLiteral_[115,111,117,114,99,101,58,32,37,120,32,100,101,115,116,58,32,37,120,32,108,101,110,58,37,108,100,13]`:
    \ 000000 736f7572             .byte   115,111,117,114,99,101,58,32,37,120,32,100,101,115,116,58,32,37,120,32,108,101,110,58,37,108,100,13,0
    \ 000004 63653a20
    \ 000008 25782064
    \ 00000c 6573743a
    \ 000010 20257820
    \ 000014 6c656e3a
    \ 000018 256c640d
    \ 00001c 00
    \ 000000                      .section cdata,rodata
    \ 000000                      .pubweak `_StringLiteral_[119,97,105,116,105,110,103,46,46,13]`
    \ 000000          `_StringLiteral_[119,97,105,116,105,110,103,46,46,13]`:
    \ 000000 77616974             .byte   119,97,105,116,105,110,103,46,46,13,0
    \ 000004 696e672e
    \ 000008 2e0d00

##########################
#                        #
# Memory sizes (decimal) #
#                        #
##########################

Executable              (Text): 9944 bytes
Zero initialized         (BSS):  532 bytes
Constant                      : 1352 bytes
Constant         __far        :   24 bytes
